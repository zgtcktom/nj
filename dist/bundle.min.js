(()=>{var e={460:()=>{},584:(e,t,n)=>{"use strict";function r(e,t){if(e==t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0}return Oe(e,t,!0)}function l(e){return e instanceof z&&(e=e.valueOf()),e}n.r(t),n.d(t,{Broadcast:()=>he,Dtype:()=>h,Flatiter:()=>Xl,Generator:()=>mr,NDArray:()=>z,NINF:()=>_t,NdenumerateIterator:()=>Gl,NdindexIterator:()=>U,Nditer:()=>je,NdoffsetIterator:()=>Vl,Product:()=>il,Slice:()=>g,_ndim:()=>me,_shape:()=>I,abs:()=>$n,absolute:()=>An,accumulate_:()=>yl,add:()=>De,all:()=>ft,allclose:()=>ri,amax:()=>yn,amin:()=>wn,and:()=>rt,any:()=>ht,arange:()=>K,arccos:()=>Mt,arccosh:()=>Lt,arcsin:()=>vt,arcsinh:()=>Dt,arctan:()=>kt,arctan2:()=>Nt,arctanh:()=>Ut,argmax:()=>pi,argmin:()=>ci,argsort:()=>Qn,argwhere:()=>$e,around:()=>Vt,array:()=>N,array2string:()=>kl,array_equal:()=>Oe,array_equiv:()=>qe,array_repr:()=>Nl,array_split:()=>Pr,array_str:()=>El,asarray:()=>V,ascontiguousarray:()=>re,assert:()=>vl,atleast_1d:()=>ae,atleast_2d:()=>oe,atleast_3d:()=>ue,average:()=>xr,bincount:()=>zr,bitwise_and:()=>Mn,bitwise_not:()=>Nn,bitwise_or:()=>kn,bitwise_xor:()=>En,broadcast:()=>fe,broadcast_arrays:()=>P,broadcast_shapes:()=>J,broadcast_to:()=>T,cbrt:()=>xn,ceil:()=>Gt,choice:()=>ur,clip:()=>Kn,column_stack:()=>Fr,compile:()=>Jl,compress:()=>Ae,concatenate:()=>Te,contiguous:()=>le,convolve:()=>Jn,copy:()=>we,copysign:()=>fn,copyto:()=>D,cos:()=>At,cosh:()=>Tt,count_nonzero:()=>ke,cross:()=>Wn,cumprod:()=>Kl,cumsum:()=>Ql,deg2rad:()=>It,degrees:()=>jt,diag:()=>Gr,diagonal:()=>Cr,diff:()=>Rt,divide:()=>Xe,divmod:()=>tt,dot:()=>Ml,dsplit:()=>Lr,dstack:()=>Ir,dtype:()=>p,dtype_:()=>c,e:()=>yt,ediff1d:()=>Yt,empty:()=>B,empty_like:()=>X,eq:()=>Ln,equal:()=>qn,exp:()=>Zt,exp2:()=>tn,expand_dims:()=>ge,expm1:()=>en,extract:()=>ve,eye:()=>de,fix:()=>Xt,flatnonzero:()=>Me,flip:()=>Wr,fliplr:()=>Hr,flipud:()=>Jr,float_power:()=>Je,floor:()=>Ct,floor_divide:()=>He,fmod:()=>Ke,fromfunction:()=>be,fromiter:()=>xe,full:()=>W,full_like:()=>H,gcd:()=>cn,get:()=>hi,get_size:()=>M,get_strides:()=>v,gradient:()=>Gn,greater:()=>Pn,greater_equal:()=>Dn,gt:()=>Xn,gte:()=>Cn,guessType:()=>S,hsplit:()=>Ur,hstack:()=>qr,hypot:()=>Et,identity:()=>pe,in1d:()=>kr,index_exp:()=>Rr,indices:()=>vr,inf:()=>xt,interp:()=>Yn,invert:()=>jn,isclose:()=>ti,isfinite:()=>dt,isinf:()=>pt,isnan:()=>ct,isneginf:()=>mt,isposinf:()=>gt,isscalar:()=>$,ix_:()=>Mr,lcm:()=>pn,ldexp:()=>hn,left_shift:()=>Sn,less:()=>Fn,less_equal:()=>Tn,linspace:()=>Q,log:()=>nn,log10:()=>rn,log1p:()=>sn,log2:()=>ln,logaddexp:()=>an,logaddexp2:()=>on,logical_and:()=>nt,logical_not:()=>st,logical_or:()=>lt,logical_xor:()=>ot,lt:()=>Vn,lte:()=>Bn,lu:()=>ii,lu_factor:()=>si,lu_factor_:()=>ai,lu_solve:()=>oi,map:()=>sl,map2_:()=>ml,map_:()=>cl,matmul:()=>zl,maximum:()=>mn,mean:()=>_r,minimum:()=>gn,mod:()=>Qe,modf:()=>Re,moveaxis:()=>Pe,multiply:()=>Be,nan:()=>wt,nan_to_num:()=>vn,nancumprod:()=>Yl,nancumsum:()=>ei,nanprod:()=>Kt,nansum:()=>Qt,ndenumerate:()=>Cl,ndim:()=>ce,ndindex:()=>L,nditer:()=>Se,ndoffset:()=>Bl,negative:()=>Ve,neq:()=>Un,nonzero:()=>_e,normalize_axes:()=>$l,normalize_axis:()=>Ee,normalize_axis_index:()=>Al,normalize_axis_tuple:()=>Ne,not:()=>at,not_equal:()=>In,ogrid:()=>wr,ones:()=>Z,ones_like:()=>ee,or:()=>it,packbits:()=>Er,pi:()=>bt,pick:()=>or,positive:()=>Ue,power:()=>Ce,prod:()=>Ht,ptp:()=>br,put:()=>Zr,rad2deg:()=>qt,radians:()=>St,rand:()=>pr,random:()=>gr,random_sample:()=>fr,ranf:()=>hr,ravel:()=>ze,ravel_multi_index:()=>Hl,reciprocal:()=>Le,reduce:()=>al,reduce_:()=>gl,remainder:()=>et,repeat:()=>Br,reshape:()=>G,resize:()=>el,right_shift:()=>On,rint:()=>Bt,roll:()=>ll,row_stack:()=>Tr,s_:()=>Yr,sample:()=>dr,scatter:()=>ui,searchsorted:()=>tl,set:()=>di,shallow_array_equal:()=>Ie,shape:()=>q,shape_:()=>F,sign:()=>zn,signbit:()=>un,sin:()=>$t,sinh:()=>Ft,slice:()=>_,solve:()=>li,sort:()=>Rn,split:()=>Dr,sqrt:()=>bn,square:()=>_n,squeeze:()=>ye,stack:()=>Sr,std:()=>Ar,subtract:()=>Ge,sum:()=>Jt,swapaxes:()=>ie,take:()=>R,tan:()=>zt,tanh:()=>Pt,tester:()=>i,tile:()=>Xr,timeit:()=>o,timeit2:()=>s,toArray:()=>A,transpose:()=>se,trapz:()=>Hn,true_divide:()=>We,trunc:()=>Wt,tupleType:()=>Qr,tuple_:()=>C,unique:()=>mi,unpackbits:()=>Nr,unravel_index:()=>Wl,unwrap:()=>Ot,variance:()=>$r,vsplit:()=>Vr,vstack:()=>Or,where:()=>yr,wrapper_:()=>ul,wrapper_accumulate:()=>pl,wrapper_map:()=>fl,wrapper_map2:()=>hl,wrapper_reduce:()=>dl,xor:()=>ut,zeros:()=>te,zeros_like:()=>ne});let i=new class{compare=r;constructor(){this.tasks={},this._onload=[]}onload(e){this._onload.push(e)}add(e,t,n,r=this.compare){return"function"==typeof e&&(e=e.name),(this.tasks[e]??(this.tasks[e]=[])).push({test:t,expected:n,compare:r}),this}run(e){if(null==e){let e=!0;for(let t of Object.keys(this.tasks))e=this.run(t)&&e;let t=(e?"[32m":"[31m")+"%s[0m";return console.log(t,`Status: ${e}, Total: ${Object.keys(this.tasks).length}`),this._onload.forEach((e=>e())),e}let t=this.tasks[e];if(null==t)throw"no such name";let n=1,r=0,i=[];for(let e of t){let t,s,{test:a,expected:o,compare:u}=e,f=!1,h=!1;try{t=a()}catch(e){t=`[Error]: ${e}`,console.log(e),h=!0}try{s=o()}catch(e){s=`[Error]: ${e}`,console.log(e),h=!0}h||(f=u(t,s)),f&&r++;let d=(f?"[32m":"[31m")+"%s[0m";i.push([d,`#${n}: ${f?"passed":"fail"}`,"\nTest=\n",l(t),"\nExpected=\n",l(s)]),n++}let s=(r==t.length?"[32m":"[31m")+"%s[0m";if(console.log(s,`Testing ${e}: ${r} / ${t.length} cases passed`),r!=t.length)for(let e of i)console.log(...e);return r==t.length}};function s(e,t=1e3){let n,r=performance.now(),l=0;for(;e(),l++,n=performance.now(),!(n-r>=t););let i=l/((n-r)/t);console.log(`ops: ${i} per sec`,e)}function o(e,{name:t="test",setup:n=null,duration:r=1e3,warmup:l=100,cycle:i="auto",cycle_duration:s=100,repeat:a="auto",verbose:o=!1}={}){let u=n?.();if(s>r&&(s=r),"auto"==a&&(a=r/s|0),"auto"==i){let t,n=1;for(;;){let r=Date.now();for(let t=0;t<n;t++)e(u);if(t=Date.now()-r,t>s)break;n*=2}i=Math.max(n/t*(r/a)|0,1)}let f=[];for(let t=0;t<l;t++)e(u);for(let t=0;t<a;t++){let t=Date.now();for(let t=0;t<i;t++)e(u);let n=i/((Date.now()-t)/1e3);f.push(n)}let h=f.length,d=f.reduce(((e,t)=>e+t))/h;if(o){let e=Math.max(...f),n=Math.min(...f),r=Math.max(e-d,d-n);console.log(`#${t} ${0|d} Â± ${(r/d*100).toFixed(2)}% ops/sec (${a} runs)`)}return d}let u=e=>e,f=new WeakMap;class h{#e;constructor(e=u,t=Array,n=`${e}`){this.name=n,this.type=e,this.#e=t,f.set(e,n),f.set(t,n)}new(e,t=null){let n=new this.#e(e);if(null!=t)if(null!=n.set)n.set(t);else for(let e=0;e<t.length;e++)n[e]=t[e];return n}toString(){return`dtype('${this.name}')`}valueOf(){return this.type}}let d={int8:new h(Number,Int8Array,"int8"),uint8:new h(Number,Uint8Array,"uint8"),int16:new h(Number,Int16Array,"int16"),uint16:new h(Number,Uint16Array,"uint16"),int32:new h(Number,Int32Array,"int32"),uint32:new h(Number,Uint32Array,"uint32"),float32:new h(Number,Float32Array,"float32"),float64:new h(Number,Float64Array,"float64"),boolean:new h(Boolean,class extends Array{},"boolean"),number:new h(Number,class extends Array{},"number"),string:new h(String,class extends Array{},"string"),object:new h(u,Array,"object")};function p(e="object",t=undefined,n=undefined){if("string"==typeof e){if(!Object.hasOwn(d,e))throw new Error(`${e} is not supported`);return d[e]}return e instanceof h?e:f.has(e)?d[f.get(e)]:d[n]=new h(e,t,n)}Object.assign(d,{int:d.number,float:d.number});const c=p;var m=n(460);class g{static newaxis=null;static ellipsis=new g;static colon=new g;constructor(e,t,n){this.start=e,this.stop=t,this.step=n}indices(e=null){if(this==g.ellipsis)throw new Error("ellipsis does not support .indices()");let t,{start:n,stop:r,step:l}=this;if(l??=1,null==e){if(n??=0,null==r)throw new Error("stop must be non-null")}else null==n?n=l<0?e-1:0:(n<0&&(n+=e),n<0&&(n=l<0?-1:0),n>=e&&(n=l<0?e-1:e)),null==r?r=l<0?-1:e:(r<0&&(r+=e),r<0&&(r=l<0?-1:0),r>=e&&(r=l<0?e-1:e));return t=0==l||l<0&&r>=n||l>0&&n>=r?0:l<0?(r-n+1)/l+1|0:(r-n-1)/l+1|0,new y(n,r,l,t)}toString(){if(this==g.ellipsis)return"...";if(this==g.colon)return":";let{start:e,stop:t,step:n}=this,r=`${e??""}:${t??""}`;return null!=n&&(r+=`:${n}`),r}}g.prototype[m?.inspect?.custom]=function(){return this.toString()};class y{#t;#n;#r;constructor(e,t,n,r){this.start=e,this.stop=t,this.step=n,this.slicelength=r}[Symbol.iterator](){return this.reset(),this}reset(){let{start:e,slicelength:t}=this;this.#r=0,this.#n=0==t,this.#t=e}next(){if(this.#n)return{done:!0};let{step:e,slicelength:t}=this,n=this.#t;return this.#t+=e,this.#n=++this.#r>=t,{value:n,done:!1}}}let w=Object.assign(Object.create(null),{None:g.newaxis,"...":g.ellipsis,":":g.colon}),b=e=>0==(e=e.trim()).length?null:+e,x=(e,t)=>{if(null!=e&&!Number.isInteger(e=+e))throw new Error(`${t} must be either null or able to convert to integer`);return e};function _(e=null,t=null,n=null){if("string"==typeof e){if(Object.hasOwn(w,e))return w[e];let r=e.split(":");if(0==r.length||r.length>3)throw new Error(`invalid string slice representation ${e}`);e=b(r[0]),t=r.length>1?b(r[1]):null,n=r.length>2?b(r[2]):null}else e&&"object"==typeof e&&(null!=e[Symbol.iterator]?[e=null,t=null,n=null]=e:null!=e.length?({0:e=null,1:t=null,2:n=null}=e):({start:e=null,stop:t=null,step:n=null}=e));return null==e&&null==t&&null==n?g.colon:(e=x(e,"start"),t=x(t,"stop"),n=x(n,"step"),new g(e,t,n))}function $(e){switch(typeof e){case"boolean":case"function":case"number":case"string":return!0}return!1}function A(e){return e instanceof z?e.array():e}_.newaxis=g.newaxis,_.ellipsis=g.ellipsis,_.colon=g.colon;class z{constructor(e,t=null,n=null,r=null,l=null,i=0,s=1){this.ndim=e.length,this.size=M(e),this.shape=e,this.data=t??Array(this.size),this.itemsize=s,this.strides=l??v(e,this.ndim,s),this.offset=i,this.dtype=c(n??t.constructor),this.base=r?.base??r}get length(){let{ndim:e,shape:t}=this;if(0!=e)return t[0]}get flat(){return new Xl(this)}set flat(e){this.flat.set(":",e)}get T(){return se(this)}set T(e){this.T.set(e)}toString(){return El(this)}valueOf(){return 0==this.ndim?this.item():Nl(this)}*[Symbol.iterator](){for(let e=0;e<this.shape[0];e++)yield this.at(e)}as_strided(e=this.shape,t=this.strides,n=this.offset){let{data:r,dtype:l,base:i,itemsize:s}=this;return new z(e,r,l,i??this,t,n,s)}keys(){let{shape:e,strides:t,offset:n}=this;return Bl(e,t,n)}values(){return this.flat}idx(e){let{shape:t,strides:n,ndim:r,size:l,offset:i}=this;if(0==e)return i;if(null==e){if(1!=l)throw new Error("index cannot be empty if size != 1");return i}let s=function(e,t,n,r){if(Number.isInteger(e)){let l=e;if(l<0&&(l+=r),l<0||l>=r)throw new Error(`index ${e} out of bound for size ${r}`);if(0==n)return[0];let i=Array(n);for(let e=n-1;e>=0;e--)i[e]=l%t[e],l=l/t[e]|0;return i}if(e.length!=n)throw new Error("incorrect number of indices for array");return e}(e,t,r,l);for(let e=0;e<s.length;e++){let r=s[e],l=t[e];if(r<0&&(r+=l),r<0||r>=l)throw new Error(`index ${s[e]} out of bound for dimension ${l}`);i+=r*n[e]}return i}at(...e){return this.get(e)}slice(e=null,t=null){return this.at(_(e,t))}get(e,t=0){return k(e)?E(this,e,t):ui(this,e,t).get()}set(e,t){return 1==arguments.length?D(this,e):k(e)?D(E(this,e),t):ui(this,e).set(t),this}item(e){return this.data[this.idx(e)]}itemset(e,t){return this.data[this.idx(e)]=t,this}astype(e,t=!0){if(e=c(e),t||=this.dtype!=e,!t)return this;let{shape:n,size:r}=this,l=e.new(r,[...this.flat]);return new z(n,l,e)}array(){let{ndim:e}=this;if(0==e)return this.data[this.offset];let t,{shape:n,size:r}=this;if(0==r){if(1==e)return[];let r=1,l=0;for(let t;l<e&&(t=n[l]);l++)r*=t;e=l,t=Array.from({length:r},(()=>[]))}else t=[...this.flat];for(let r=e-1;r>0;r--){let e=n[r],l=[];for(let n=0;n<t.length;n+=e)l.push(t.slice(n,n+e));t=l}return t}toarray(){return this.array()}tolist(){return this.array()}reshape(...e){return 1==e.length&&"object"==typeof e[0]&&(e=e[0]),G(this,e)}add(e,t=null){return De(this,e,t)}sub(e,t=null){return Ge(this,e,t)}mul(e,t=null){return Be(this,e,t)}div(e,t=null){return Xe(this,e,t)}mod(e,t=null){return Qe(this,e,t)}all(e=null,t=null,n=!1,r=!0,l=!0){return ft(this,e,t,n,r,l)}any(e=null,t=null,n=!1,r=!1,l=!0){return ht(this,e,t,n,r,l)}argmax(e=null,t=null,n=!1){return pi(this,e,t,n)}argmin(e=null,t=null,n=!1){return ci(this,e,t,n)}argpartition(e,t=-1,n="introselect",r=null){throw"not implemented"}argsort(e=-1,t=null){return Qn(this,e,t)}byteswap(){throw"not implemented"}choose(e,t=null,n="raise"){throw"not implemented"}clip(e,t,n=null){return Kn(this,e,t,n)}compress(e,t=null,n=null){return Ae(e,this,t,n)}conj(){throw"not implemented"}conjugate(){throw"not implemented"}copy(){return N(this)}cumprod(e,t){return Kl(this,e,t)}cumsum(e,t){return Ql(this,e,t)}diagonal(e=0,t=0,n=1){return Cr(this,e,t,n)}dump(){throw"not implemented"}dumps(){throw"not implemented"}fill(e){let{data:t,shape:n,strides:r,offset:l}=this;for(let i of Bl(n,r,l))t[i]=e;return this}flatten(){let{size:e,flat:t,dtype:n}=this;return new z([e],[...t],n)}getfield(){throw"not implemented"}max(e=null,t=null,n=!1,r=null,l=!0){return yn(this,e,t,n,r,l)}mean(e=null,t=null,n=!1){return _r(this,e,t,n)}min(e=null,t=null,n=!1,r=null,l=!0){return wn(this,e,t,n,r,l)}newbyteorder(){throw"not implemented"}nonzero(){return _e(this)}partition(e,t=-1,n="introselect",r=null){throw"not implemented"}prod(e=null,t=null,n=!1,r=0,l=!0){return Ht(this,e,t,n,r,l)}ptp(e=null,t=null,n=!1){return br(this,e,t,n)}put(e,t,n="raise"){return Zr(this,e,t,n),this}ravel(){return ze(this)}repeat(e,t=null){return Br(this,e,t)}resize(e){if(null!=this.base)throw"cannot resize this array: it does not own its data";if(!le(this))throw"resize only works on single-segment arrays";let t=M(e);return t<=this.size?this.data=[...this.data.slice(this.offset,t)]:this.data=[...this.data.slice(this.offset,t),...Array(t-this.size).fill(0)],this.shape=e,this.ndim=e.length,this.strides=v(e,this.ndim,this.itemsize),this.offset=0,this}round(e=0,t=null){return Vt(this,e,t)}searchsorted(e,t="left"){return tl(this,e,t)}setfield(){throw"not implemented"}setflags(){throw"not implemented"}sort(e=-1,t=null){return this.set(Rn(this,e,t)),this}squeeze(e=null){return ye(this,e)}std(e=null,t=null,n=0,r=!1){return Ar(this,e,t,n,r)}sum(e=null,t=null,n=!1,r=0,l=!0){return Jt(this,e,t,n,r,l)}swapaxes(e,t){return ie(this,e,t)}take(e,t=null,n=null,r="raise"){return R(this,e,t,n,r)}tobytes(){throw"not implemented"}tofile(){throw"not implemented"}trace(){throw"not implemented"}transpose(e=null){return se(this,e)}variance(e=null,t=null,n=0,r=!1){return $r(this,e,t,n,r)}}function v(e,t,n){if(0==t)return[];let r=Array(t);r[t-1]=n;for(let n=t-1;n>0;n--)r[n-1]=r[n]*e[n];return r}function M(e){let t=1;for(let n of e)t*=n;return t}function k(e){for(let t of e)if(null!=t&&"object"==typeof t&&null!=t.length)return!1;return!0}function E(e,t,n=0){let{ndim:r,shape:l,strides:i,offset:s}=e,a=0,o=-1;for(let e=0;e<t.length;e++){let n=t[e];if(n==g.ellipsis||"..."==n){if(-1!=o)throw new Error("can only have a single ellipsis '...'");o=e}else null==n&&a++}let u=0;if(-1!=o&&(u=r-n-(t.length-a-1)),n+(t.length-a-(-1!=o))>r)throw new Error("too many indices");let f=[],h=[];for(let e=0;e<n;e++)f.push(l[e]),h.push(i[e]);for(let e of t)if(null==e)f.push(1),h.push(0);else{if("string"==typeof e)e=_(e);else if(!(e instanceof g)){let t=e;if(e<0&&(e+=l[n]),e<0||e>l[n])throw new Error(`index ${t} out of bound for dimension size ${l[n]}`);s+=i[n]*e,n++;continue}if(e==g.ellipsis){for(let e=0;e<u;e++)f.push(l[n+e]),h.push(i[n+e]);n+=u}else if(e==g.colon)f.push(l[n]),h.push(i[n]),n++;else{let{start:t,step:r,slicelength:a}=e.indices(l[n]);s+=i[n]*t,f.push(a),h.push(i[n]*r),n++}}for(let e=n;e<r;e++)f.push(l[e]),h.push(i[e]);return e.as_strided(f,h,s)}function N(e,t=undefined,n=!0,r=0){if(e instanceof z){let{shape:l,ndim:i}=e;return i<r&&(l=Array(r-i).fill(1).concat(l),e=e.reshape(l)),e.astype(t??e.dtype,n)}let l=F(e),i=[];j(i,e,l,0);let s=l.length;return s<r&&(l=Array(r-s).fill(1).concat(l)),t=c(t??S(i)),new z(l,t.new(i.length,i),t)}function j(e,t,n,r=0){if(r<n.length)for(let l=0;l<n[r];l++)j(e,t.at(l),n,r+1);else"function"==typeof t?.toarray&&(t=t.toarray()),e.push(t)}function S(e){let t;if("object"==typeof e&&e?.[Symbol.iterator]){t=typeof e[0];for(let n of e)if(t!=typeof n){t="object";break}}else t=typeof e;return"number"==t||"string"==t||"boolean"==t?t:"object"}function O(e,t,n=0){for(let r=0;r<e.length&&n<t.length;r++){let l=e[r];if(null==l||"object"!=typeof l||l.length!=t[n]){t.length=n;break}if(l instanceof z){for(let e=n,r=0;e<t.length&&r<l.ndim;e++,r++)if(t[e]!=l.shape[r]){t.length=e;break}}else n+1<t.length&&O(l,t,n+1)}}function q(e){if(null==e||"object"!=typeof e)return[];if(null!=e.shape)return e.shape;let t=[],n=e;for(;;){if(n instanceof z)t.push(...n.shape);else if("object"==typeof n&&null!=n?.length){t.push(n.length),n=n[0];continue}break}return t.length>1&&O(e,t,1),t}z.prototype[m?.inspect?.custom]=function(){return this.valueOf()},i.onload((()=>{}));const I=q,F=q;function T(e,t){e=V(e);let{strides:n,ndim:r}=e;if(r>t.length)throw new Error("broadcast shape has less dimensions than input array");let l=[];for(let r=t.length-1,i=e.shape.length-1;r>=0;r--,i--){if(i>=0&&1!=e.shape[i]&&e.shape[i]!=t[r])throw new Error("operands could not be broadcast together");l[r]=i<0||1==e.shape[i]?0:n[i]}return e.as_strided(t,l)}function P(...e){let t=J(...(e=e.map((e=>V(e)))).map((e=>e.shape)));return e.map((e=>T(e,t)))}function D(e,t){if(1==(t=V(t)).size)e.fill(t.item());else{let n=T(t,e.shape).flat[Symbol.iterator](),{data:r,shape:l,strides:i,offset:s}=e;for(let e of Bl(l,i,s))r[e]=n.next().value}}function L(e){return new U(e)}class U{constructor(e){this.ndim=e.length,this.size=M(e),this.shape=e,this.coords=Array(this.ndim),this.index,this.done,this[Symbol.iterator]()}[Symbol.iterator](){return this.coords.fill(0),this.index=0,this.done=0==this.size,this}next(){if(this.done)return{done:!0};let{coords:e,size:t,index:n}=this;if(0!=n){let{shape:t,ndim:n}=this,r=n-1,l=!0;for(;r>=0;){let n=t[r];if(1==n)r--;else if(n==e[r])e[r--]=0,l=!0;else{if(!l)break;e[r]++,l=!1}}}return this.done=++this.index>=t,{value:e,done:!1}}}function V(e,t=undefined){return e instanceof z?null==t?e:e.astype(t,!1):N(e,t)}function B(e,t=undefined){return e=C(e),t=c(t),new z(e,t.new(M(e)),t)}function X(e,t=undefined){return B((e=V(e)).shape,t??e.dtype)}function C(e){return e?("function"==typeof e.toarray&&(e=e.toarray()),"object"==typeof e&&null!=e.length?e:[e]):[e]}function G(e,t){e=V(e),t=C(t);let n=-1,r=1;for(let e=0;e<t.length;e++)if(-1==t[e]){if(-1!=n)throw new Error("can only specify one unknown dimension");n=e}else r*=t[e];if(-1!=n){if(e.size%r!=0)throw new Error(`cannot reshape array of size ${e.size} into shape [${t.join(", ")}]`);t[n]=0==r?0:e.size/r}if(e.size!=M(t))throw new Error(`cannot reshape array of size ${e.size} into shape [${t.join(", ")}]`);if(null==e.base)return e.as_strided(t,v(t,t.length,e.itemsize));{let n=!0,r=0;for(let l=0;l<t.length;l++)if(1!=t[l]){for(;r<e.shape.length&&1==e.shape[r];r++);if(r>=e.shape.length||t[l]!=e.shape[r]){n=!1;break}r++}if(r!=e.shape.length&&(n=!1),n){let n=[];for(let r=0,l=0;r<t.length;r++){if(1!=t[r])for(;l<e.shape.length&&1==e.shape[l];l++);n.push(l<e.shape.length?e.strides[l++]:1)}return e.as_strided(t,n)}}let l=null;return 1==t.length&&function(e,t,n){let r;for(let t=n-1;t>0;t--)if(e[t]>1){r=t;break}for(let n=r-1;n>=0;n--)if(e[n]>1){if(t[n]!=t[r]*e[r])return!1;r=n}return!0}(e.shape,e.strides,e.ndim)?l=[e.strides[0]]:0!=t.length&&(e=N(e)),e.as_strided(t,l)}function W(e,t,n=undefined){let r=B(e,n??S(t));return D(r,t),r}function H(e,t,n=undefined){return W(q(e),t,n)}function J(...e){let t=0;for(let n of e)t=Math.max(t,n.length);if(0==t)return[];let n=Array(t).fill(1);for(let r of e)for(let e=r.length-1,l=t-1;e>=0;e--,l--){let t=r[e];if(1!=t)if(1==n[l])n[l]=t;else if(n[l]!=t)throw new Error("shape mismatch")}return n}function K(e,t=undefined,n=1){null==t&&(t=e,e=0);let r=Math.max(0,(t-e)/n|0),l=B([r],"number"),{data:i}=l;for(let t=0;t<r;t++)i[t]=e+t*n;return l}function Q(e,t,n=50,r=!0,l=!1){let i=(t-e)/(r?n-1:n),s=[];for(let t=0;t<n;t++)s[t]=e+t*i;let a=N(s);return l?[a,i]:a}function R(e,t,n=null,r=null,l="raise"){if(e=V(e),t=N(t),null==n){t.data=Y(t.data,l,e.size);let n=t.shape;if(null==r)r=B(n);else if(!Ie(r.shape,n))throw"output array does not match result of ndarray.take";for(let n=0;n<t.size;n++)r.data[n]=e.item(t.data[n]);return r}{n<0&&(n+=e.ndim),t.data=Y(t.data,l,e.shape[n]);let i=e.shape.slice();if(i.splice(n,1,...t.shape),null==r)r=B(i);else if(!Ie(r.shape,i))throw"output array does not match result of ndarray.take";let s=Array(n).fill(_());for(let n of L(t.shape))r.get(s.concat(n)).set(e.get([...s,t.item(n)]));return r}}function Y(e,t,n){let r=[];if("wrap"==t)for(let t of e)t%=n,t=t<0?t+n:t,r.push(t);else if("clip"==t)for(let t of e)i=n-1,t=(l=t)<0?0:l>i?i:l,r.push(t);else{if("raise"!=t)throw`unexpected mode = ${t}`;for(let t of e){if(t<-n||t>=n)throw`index ${t} is out of bounds for axis 0 with size ${n}`;t=t<0?t+a.size:t,r.push(t)}}var l,i;return r}function Z(e,t=undefined){return W(e,1,t)}function ee(e,t=undefined){return H(e,1,t)}function te(e,t=undefined){return W(e,0,t)}function ne(e,t=undefined){return H(e,0,t)}function re(e,t=undefined){return le(e=V(e,t))?e:N(e)}function le(e){let{strides:t,shape:n,ndim:r,itemsize:l}=e;if(0==r)return!1;for(let e=r-1;e>=0;e--)if(n[e]>1){if(l!=t[e])return!1;l*=n[e]}return!0}function ie(e,t,n){e=V(e);let r=[...Array(e.ndim).keys()];return[r[t],r[n]]=[r[n],r[t]],se(e,r)}function se(e,t=null){e=V(e);let n,r,{ndim:l,shape:i,strides:s}=e;if(null==t)n=i.slice().reverse(),r=s.slice().reverse();else{t=function(e,t){if(e.length!=t)throw new Error("axes don't match array");let n=[],r={};for(let l=0;l<t;l++){let i=e[l];if(i<0&&(i+=t),i<0||t<=i)throw new Error(`axis ${i} is out of bounds for array of dimension ${l+1}`);if(r[i])throw new Error("repeated axis in transpose");r[i]=!0,n[l]=i}return n}(t,l),n=Array(l),r=Array(l);for(let e=0;e<l;e++)n[e]=i[t[e]],r[e]=s[t[e]]}return e.as_strided(n,r)}function ae(...e){if(1!=e.length)return e.map((e=>ae(e)));let t=V(e[0]),{ndim:n}=t;return n>=1?t:t.copy().reshape([1])}function oe(...e){if(1!=e.length)return e.map((e=>oe(e)));let t=V(e[0]),{ndim:n,shape:r}=t;return n>=2?t:1==n?t.reshape([1,r[0]]):t.copy().reshape([1,1])}function ue(...e){if(1!=e.length)return e.map((e=>ue(e)));let t=V(e[0]),{ndim:n,shape:r}=t;return n>=3?t:2==n?t.reshape([r[0],r[1],1]):1==n?t.reshape([1,r[0],1]):t.copy().reshape([1,1,1])}function fe(...e){return new he(e.map((e=>V(e))))}class he{constructor(e){this.shape=J(...e.map((e=>e.shape))),this.arrays=e.map((e=>T(e,this.shape))),this.ndim=this.shape.length,this.size=M(this.shape),this.reset()}[Symbol.iterator](){return 0!=this.index&&this.reset(),this}next(){let e=this.iters.map((e=>e.next().value)),t=this.index>=this.size;return this.index++,{value:e,done:t}}reset(){this.iters=this.arrays.map((e=>e.flat)),this.index=0}}function de(e,t=e,n=0,r="number"){let l=te([e,t],r),{data:i,size:s}=l;for(let e=n+Math.ceil(-n/(t+1))*(t+1);e<s;e+=t+1)i[e]=1;return l}function pe(e,t="number"){return de(e,e,0,t)}function ce(e){return null==e||"object"!=typeof e?0:null!=e.ndim?e.ndim:q(e).length}const me=ce;function ge(e,t){"number"==typeof t&&(t=[t]);let n=(e=V(e)).ndim+t.length;t=Ne(t,n,!1);let r=[];for(let l=0,i=0;l<n;l++)r.push(t.includes(l)?1:e.shape[i++]);return e.reshape(r)}function ye(e,t=null){e=V(e),null!=t&&(t=Ne(t));let{shape:n,ndim:r}=e,l=[];for(let e=0;e<r;e++)(t?t.includes(e):1==n[e])||l.push(n[e]);return e.reshape(l)}function we(e){return N(e)}function be(e,t,n=undefined){let r=[];for(let n of L(t))r.push(e(n));return N(r,n??S(r)).reshape(t)}function xe(e,t=-1,n=undefined){let r;if(-1==t)r=[...e];else{r=[];let n=0;if(n<t)for(let l of e)if(r.push(l),n++,n>=t)break}return N(r,n??S(r))}function _e(e){e=ae(e);let{ndim:t}=e,n=[];for(let e=0;e<t;e++)n.push([]);for(let[r,l]of Cl(e))if(l)for(let e=0;e<t;e++)n[e].push(r[e]);return n.map((e=>V(e)))}function $e(e){return 0==ce(e)?$e(e=ae(e)).at(_(),_(null,0)):se(_e(e))}function Ae(e,t,n=null,r=null){if(1!=(e=V(e)).ndim)throw"condition must be a 1-d array";return R(t,_e(e)[0],n,r)}function ze(e){e=re(e);let{size:t,base:n,offset:r,itemsize:l}=e;return(e=e.as_strided([t],v([t],1,l),r)).base=n,e}function ve(e,t){return Ae(ze(e),ze(t))}function Me(e){return _e(ze(e))[0]}function ke(e,t=null,n=!1){return Jt(In(e,0),t,null,n)}function Ee(e,t,n=!1){if(Array.isArray(e)||(e=[e]),e=e.map((e=>Al(e,t))),!n&&new Set(e).size!=e.length)throw"repeated axis";return e}const Ne=Ee;class je{constructor(e,t=null){this.array=V(e);let{ndim:n,shape:r}=e;if(null!=t&&(t=Ee(t,n)),this.axis=t,null!=t){let e=[],l=[],i=[];for(let s=0;s<n;s++)(i[s]=!t.includes(s))?(l[s]=0,e.push(r[s])):l[s]=_[":"];this.shape=e,this.indices=l,this.mask=i}else this.shape=[e.size],this.indices=[0],this.mask=null}*[Symbol.iterator](){let{array:e,axis:t}=this;if(null==t)return void(yield*e.flat);let{shape:n,mask:r,indices:l}=this;for(let t of L(n)){for(let n=0,i=0;n<e.ndim;n++)r[n]&&(l[n]=t[i++]);yield[t,e.get(l)]}}}function Se(e,t=null){return new je(e,t)}function Oe(e,t,n=!1){return e=V(e),t=V(t),!!Ie(e.shape,t.shape)&&ft(n?Fe(e,t):qn(e,t))}function qe(e,t){return e=V(e),t=V(t),!!function(...e){let t=0;for(let n of e)t=Math.max(t,n.length);for(let n=0;n<t;n++){let t=-1;for(let r of e){let e=r.length-n-1;if(!(e<0))if(-1==t)t=r[e];else if(1!=t&&t!=r[e])return!1}}return!0}(e.shape,t.shape)&&ft(qn(e,t))}function Ie(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}const Fe=hl("nan_equal",((e,t)=>e==t||Number.isNaN(e)&&Number.isNaN(t)));function Te(e,t=0,n=undefined){if(0==e.length)throw new Error("need at least one array to concatenate");e=e.map((e=>V(e))),null==t&&(e=e.map((e=>ze(e))),t=0);let{ndim:r,shape:l}=e[0];if(0==r)throw new Error("zero-dimensional arrays cannot be concatenated");for(let n=1;n<e.length;n++){let i=e[n];if(i.ndim!=r)throw new Error(`all the input arrays must have same number of dimensions, but the array at index 0 has ${r} dimension(s) and the array at index ${n} has ${e[n].ndim} dimension(s)`);for(let s=0;s<r;s++)if(s!=t&&i.shape[s]!=l[s])throw new Error(`all the input array dimensions for the concatenation axis must match exactly, but along dimension ${s}, the array at index 0 has size ${l[s]} and the array at index ${n} has size ${e[n].shape[s]}`)}t=Al(t,r);let i=l.slice();if(i[t]=e.reduce(((e,n)=>e+n.shape[t]),0),null==n)n=B(i);else{if(n.ndim!=r)throw new Error("output array has wrong dimensionality");if(!Ie(n.shape,i))throw new Error("output array is the wrong shape")}let s=Array(r).fill(_(":")),a=0;for(let r of e)s[t]=_(a,a+=r.shape[t]),n.set(s,r);return n}function Pe(e,t,n){e=V(e);let{ndim:r}=e;if(t=Ne(t,r),n=Ne(n,r),t.length!=n.length)throw new Error("'src' and 'dst' arguments must have the same number of elements");let l=[...Array(r).keys()].filter((e=>!t.includes(e)));for(let e=0;e<t.length;e++)l.splice(n[e],0,t[e]);return se(e,l)}const De=hl("add",((e,t)=>e+t)),Le=fl("reciprocal",(e=>1/e)),Ue=fl("positive",(e=>+e)),Ve=fl("negative",(e=>-e)),Be=hl("multiply",((e,t)=>e*t)),Xe=hl("divide",((e,t)=>e/t)),Ce=hl("power",((e,t)=>e**t)),Ge=hl("subtract",((e,t)=>e-t)),We=Xe,He=hl("floor_divide",((e,t)=>e/t|0)),Je=Ce,Ke=hl("fmod",((e,t)=>e-(e/t|0)*t)),Qe=hl("mod",((e,t)=>(e%t+t)%t));function Re(e,t=[null,null]){return[cl(Ye,e,t[0]),cl(Ze,e,t[1])]}const Ye=e=>e%1,Ze=e=>0|e,et=Qe;function tt(e,t,n=[null,null]){return[He(e,t,n[0]),Qe(e,t,n[1])]}const nt=hl("logical_and",((e,t)=>e&&t),{dtype:"boolean"}),rt=nt,lt=hl("logical_or",((e,t)=>e||t),{dtype:"boolean"}),it=lt,st=fl("logical_not",(e=>!e),{dtype:"boolean"}),at=st,ot=hl("logical_xor",((e,t)=>!e!=!t),{dtype:"boolean"}),ut=ot,ft=dl("all",((e,t)=>e&&!!t),!0),ht=dl("any",((e,t)=>e||!!t),!1),dt=fl("isfinite",Number.isFinite),pt=fl("isinf",(e=>e==1/0||e==-1/0)),ct=fl("isnan",Number.isNaN),mt=fl("isneginf",(e=>e==-1/0)),gt=fl("isposinf",(e=>e==1/0)),yt=Math.E,wt=NaN,bt=Math.PI,xt=1/0,_t=-1/0,$t=fl("sin",Math.sin),At=fl("cos",Math.cos),zt=fl("tan",Math.tan),vt=fl("arcsin",Math.asin),Mt=fl("arccos",Math.acos),kt=fl("arctan",Math.atan),Et=fl("hypot",Math.hypot),Nt=fl("arctan2",Math.atan2),jt=fl("degrees",(e=>180*e/bt)),St=fl("radians",(e=>e/180*bt));function Ot(e,t=2*bt,n=t/2){if(1!=(e=V(e)).ndim)throw"unwrap currently only supports 1d arrays";let r=[e.data[e.offset]],l=e.data[e.offset],i=!0;for(let s of Bl(e.shape,e.strides)){if(i){i=!1;continue}let a=e.data[e.offset+s]-l;a>n?a-=t:a<-n&&(a+=t);let o=l+a;r.push(o),l=o}return V(r)}const qt=fl("rad2deg",(e=>180*e/bt)),It=fl("deg2rad",(e=>e/180*bt)),Ft=fl("sinh",Math.sinh),Tt=fl("cosh",Math.cosh),Pt=fl("tanh",Math.tanh),Dt=fl("arcsinh",Math.asinh),Lt=fl("arccosh",Math.acosh),Ut=fl("arctanh",Math.atanh);function Vt(e,t=0,n=null){if(e=V(e),null==n)n=B(e.shape);else if(!Ie(n.shape,e.shape))throw new Error("shape does not match");let r=0;for(let l of e.flat){let e=10**t,i=l*e,s=Math.round(i),a=i%1;.5!=a&&-.5!=a||(s=s%2?s-1:s),n.itemset(r++,s/e)}return n}const Bt=fl("rint",(e=>{let t=e%1,n=Math.round(e);return.5!=t&&-.5!=t||(n=n%2?n-1:n),n})),Xt=fl("fix",(e=>Math.sign(e)*Math.floor(Math.abs(e)))),Ct=fl("floor",Math.floor),Gt=fl("ceil",Math.ceil),Wt=fl("trunc",Math.trunc),Ht=dl("prod",((e,t)=>e*t),1),Jt=dl("sum",((e,t)=>e+t),0),Kt=dl("nanprod",((e,t)=>e*(isNaN(t)?1:t)),1),Qt=dl("nansum",((e,t)=>e+(isNaN(t)?0:t)),0);function Rt(e,t=1,n=-1){e=V(e);let{ndim:r}=e;n=Al(n,r);let l=Array(r).fill(_()),i=Array(r).fill(_());l[n]=_(1,null),i[n]=_(null,-1);for(let n=0;n<t;n++)e=Ge(e.get(l),e.get(i));return e}function Yt(e,t=null,n=null){if(e=Rt(G(e,-1)),null!=n||null!=t){let r=[];null!=n&&r.push(n),r.push(e),null!=t&&r.push(t),e=Te(r,null)}return e}const Zt=fl("exp",Math.exp,1),en=fl("expm1",(e=>Math.exp(e)-1)),tn=fl("exp2",(e=>2**e)),nn=fl("log",Math.log),rn=fl("log10",Math.log10),ln=fl("log2",Math.log2),sn=fl("log1p",Math.log1p),an=hl("logaddexp",((e,t)=>Math.log(Math.exp(e)+Math.exp(t)))),on=hl("logaddexp2",((e,t)=>Math.log2(2**e+2**t))),un=fl("signbit",(e=>e<0)),fn=hl("copysign",((e,t)=>t<0?-Math.abs(e):Math.abs(e))),hn=hl("ldexp",((e,t)=>e*2**t));function dn(e,t){for(;0!=t;){let n=t;t=e%t,e=n}return e}const pn=hl("lcm",(function(e,t){return e*t/dn(e,t)})),cn=hl("gcd",dn),mn=hl("maximum",Math.max),gn=hl("minimum",Math.min),yn=dl("amax",Math.max,-xt),wn=dl("amin",Math.min,xt),bn=fl("sqrt",Math.sqrt),xn=fl("cbrt",Math.cbrt),_n=fl("square",(e=>e**2)),$n=fl("abs",Math.abs),An=$n,zn=fl("sign",Math.sign),vn=fl("nan_to_num",(e=>isNaN(e)?0:e==1/0?Number.MAX_VALUE:e==-1/0?Number.MIN_VALUE:e)),Mn=hl("bitwise_and",((e,t)=>e&t)),kn=hl("bitwise_or",((e,t)=>e|t)),En=hl("bitwise_xor",((e,t)=>e^t)),Nn=fl("bitwise_not",(e=>~e)),jn=Nn,Sn=hl("left_shift",((e,t)=>e<<t)),On=hl("right_shift",((e,t)=>e>>t)),qn=hl("equal",((e,t)=>e==t),{dtype:"boolean"}),In=hl("not_equal",((e,t)=>e!=t),{dtype:"boolean"}),Fn=hl("less",((e,t)=>e<t),{dtype:"boolean"}),Tn=hl("less_equal",((e,t)=>e<=t),{dtype:"boolean"}),Pn=hl("greater",((e,t)=>e>t),{dtype:"boolean"}),Dn=hl("greater_equal",((e,t)=>e>=t),{dtype:"boolean"}),Ln=qn,Un=In,Vn=Fn,Bn=Tn,Xn=Pn,Cn=Dn;function Gn(e,t,n=null,r=1){throw new Error}function Wn(e,t,n=-1,r=n,l=n,i=n){e=V(e),t=V(t),r=Al(r,e.ndim),l=Al(l,t.ndim),e=Pe(e,r,-1),t=Pe(t,l,-1);let s=e.shape.at(-1),a=t.shape.at(-1);if(2!=s&&3!=s||2!=a&&3!=a)throw"incompatible dimensions for cross product (dimension must be 2 or 3)";let o=J(e.shape.slice(0,-1),t.shape.slice(0,-1));3!=e.shape.at(-1)&&3!=t.shape.at(-1)||(o=[...o,3],i=Al(i,o.length));let u,f,h,d,p,c,m,g,y,w=B(o);if(u=e.at("...",0),f=e.at("...",1),3==e.shape.at(-1)&&(h=e.at("...",2)),d=t.at("...",0),p=t.at("...",1),3==t.shape.at(-1)&&(c=t.at("...",2)),0!=w.ndim&&3==w.shape.at(-1)&&(m=w.at("...",0),g=w.at("...",1),y=w.at("...",2)),2==e.shape.at(-1)){if(2==t.shape.at(-1))return Be(u,p,w),Ge(w,Be(f,d),w),w;if(3!=t.shape.at(-1))throw"b.shape.at(-1) != 3";Be(f,c,m),Be(u,c,g),Ve(g,g),Be(u,p,y),Ge(y,Be(f,d),y)}else{if(3!=e.shape.at(-1))throw"a.shape.at(-1) != 3";if(3==t.shape.at(-1)){Be(f,c,m);let e=Be(h,p);Ge(m,e,m),Be(h,d,g),Be(u,c,e),Ge(g,e,g),Be(u,p,y),Be(f,d,e),Ge(y,e,y)}else{if(2!=t.shape.at(-1))throw"b.shape.at(-1) != 2";Be(h,p,m),Ve(m,m),Be(h,d,g),Be(u,p,y),Ge(y,Be(f,d),y)}}return Pe(w,-1,i)}function Hn(e,t=null,n=1,r=-1){e=V(e);let{ndim:l}=e;r=Al(r,l);let i=n;if(null!=t)if(1==(t=V(t)).ndim){i=Rt(t);let e=Array(l).fill(1);e[r]=i.shape[0],i=i.reshape(e)}else i=Rt(t,null,r);let s,a=Array(l).fill(_()),o=Array(l).fill(_());return a[r]=_(1,null),o[r]=_(null,-1),s=De(e.get(a),e.get(o)),Be(i,s,s),Xe(s,2,s),Jt(s,r)}function Jn(e,t,n="full"){if(e=ae(e),t=ae(t),0==e.size)throw"a cannot be empty";if(0==t.size)throw"v cannot be empty";if(e.ndim>1||t.ndim>1)throw"object too deep for desired array";if(t.ndim>e.ndim){let n=e;e=t,t=n}let r=e.size;if("valid"==n)r+=1-t.size;else if("full"==n)r+=t.size-1;else if("same"!=n)throw`mode must be one of 'valid', 'same', or 'full' (got '${n}')`;let l=Array(r),i=0;if("valid"!=n)for(let n=0;n<t.size-1;n++){let r=0;for(let l=n+1,i=0;l--;i++)r+=e.item(i)*t.item(l);l[i++]=r}for(let n=0;n<e.size+1-t.size;n++){let r=0;for(let l=0,i=t.size-1;l<t.size;l++,i--)r+=e.item(n+l)*t.item(i);l[i++]=r}if("valid"!=n)for(let n=0;n<t.size-1;n++){let r=0;for(let l=0;l<t.size-1-n;l++)r+=e.item(e.size-t.size+1+n+l)*t.item(t.size-1-l);l[i++]=r}return"same"==n&&(l=l.slice((t.size-1)/2|0,((t.size-1)/2|0)+r)),N(l)}function Kn(e,t,n,r=null){if(e=V(e),null==r)r=X(e);else if(!Ie(e.shape,r.shape))throw"out shape does not match input shape";if($(t)&&$(n)){let l=Bl(e.shape,e.strides)[Symbol.iterator]();for(let i of Bl(r.shape,r.strides))r.data[i]=Math.min(Math.max(t,e.data[l.next().value]),n);return r}t=T(t,e.shape),n=T(n,e.shape);let l=Bl(e.shape,e.strides)[Symbol.iterator](),i=Bl(t.shape,t.strides)[Symbol.iterator](),s=Bl(n.shape,n.strides)[Symbol.iterator]();for(let a of Bl(r.shape,r.strides))r.data[a]=Math.min(Math.max(t.data[i.next().value],e.data[l.next().value]),n.data[s.next().value]);return r}function Qn(e,t=-1,n=null){e=V(e),null==t?(e=ze(e),t=0):t=Al(t,e.ndim);let r=X(e),l=Array(e.shape[t]),i=Array(e.shape[t]),s=(e,t)=>l[e]-l[t],a=e.shape.slice();a[t]=1;for(let o of L(a)){let{offset:u}=e,{offset:f}=r;for(let t=0;t<a.length;t++)u+=o[t]*e.strides[t],f+=o[t]*r.strides[t];for(let r=0;r<e.shape[t];r++){let s=e.data[u+r*e.strides[t]];l[r]=null!=n?n(s):s,i[r]=r}i.sort(s);for(let n=0;n<e.shape[t];n++)r.data[f+n*r.strides[t]]=i[n]}return r}function Rn(e,t=-1,n=null){e=V(e),null==t?(e=ze(e),t=0):t=Al(t,e.ndim);let r=X(e),l=Array(e.shape[t]),i=(e,t)=>e-t,s=e.shape.slice();s[t]=1;for(let a of L(s)){let{offset:o}=e,{offset:u}=r;for(let t=0;t<s.length;t++)o+=a[t]*e.strides[t],u+=a[t]*r.strides[t];for(let r=0;r<e.shape[t];r++){let i=e.data[o+r*e.strides[t]];l[r]=null!=n?n(i):i}l.sort(i);for(let n=0;n<e.shape[t];n++)r.data[u+n*r.strides[t]]=l[n]}return r}function Yn(e,t,n,r=null,l=null,i=null){if([e,t,n]=[e,t,n].map((e=>V(e))),1!=t.ndim||1!=n.ndim)throw"Data points must be 1-D sequences";if(t.shape[0]!=n.shape[0])throw"fp and xp are not of the same length";if(null!=i){e=Qe(e,i);let r=Qn(t=Qe(t,i));t=t.at(r),n=n.at(r),t=Te([Ge(t.at(_(-1)),i),t,De(t.at(_(0,1)),i)]),n=Te([n.at(_(-1)),n,n.at(_(0,1))])}r??=n.item(0),l??=n.item(-1);let s=Array(e.size),a=0,o=t.item(0),u=t.item(-1);for(let i of e.flat){let e;if(i<o)e=r;else if(i>u)e=l;else{let r=1;for(;r<t.length&&i>t.item(r);r++);let l=t.item(r-1);if(i==l)e=n.item(r-1);else{let s=t.item(r);if(i==s)e=n.item(r);else{let t=n.item(r-1);e=(i-l)*(n.item(r)-t)/(s-l)+t}}}s[a++]=e}return N(s).reshape(e.shape)}function Zn(e){let t=Array(e.length),n=t[0]=e[0];for(let r=1;r<e.length;r++)t[r]=n+=e[r];return t}function er(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function tr(e,t,n){let r=n()*t,l=e.length-1;for(let t=0;t<l;t++)if(r-=e[t],r<0)return t;return l}function nr(e,t,n){let r=n()*t,l=0,i=e.length-1;for(;l<i;){let t=l+i>>1;r>e[t]?l=t+1:i=t}return l}function rr(e){let t=e.length,n=[],r=[],l=t/er(e);e=e.map((e=>e*l));for(let l=0;l<t;l++)e[l]<1?n.push(l):r.push(l);let i=Array(t),s=Array(t);for(;n.length>0&&r.length>0;){let t=n.pop(),l=r.pop();i[t]=e[t],s[t]=l,e[l]=e[l]+e[t]-1,e[l]<1?n.push(l):r.push(l)}for(;r.length>0;)i[r.pop()]=1;for(;n.length>0;)i[n.pop()]=1;return{n:t,prob:i,alias:s}}function lr(e,t,n,r){let l=r()*e|0;return r()<t[l]?l:n[l]}function ir(e){let t=e.length,n=Math.ceil(Math.log2(t)),r=1<<n,l=Array(2*r-1),i=r-1;for(let n=0;n<t;n++)l[i+n]=e[n];for(let e=t;e<r;e++)l[i+e]=0;let s=i;for(;r>1;){let e=s;s-=r>>=1;for(let t=0;t<r;t++)l[s+t]=l[e]+l[e+1],e+=2}return{tree:l,level:n,offset:i}}function sr(e,t,n,r){let l=r-e[n+=t];for(;n>=0;)e[n]+=l,n=n-1>>1}function ar(e,t,n,r){let l=r()*e[0],i=1;for(;--t;)l>e[i]&&(l-=e[i++]),i=2*i+1;return l>e[i]&&i++,i-n}function or(e,t=null,n=!0,r="auto",l=Array(e),i=Math.random){let s=t.length;if(n||=1==e,n)switch("auto"==r&&(r=1==e||e*s<600?"linear":e>(s>100?2*s:50)?"alias":"binary"),r){case"linear":{let n=er(t);for(let r=0;r<e;r++)l[r]=tr(t,n,i);break}case"binary":{let n=Zn(t),r=n.at(-1);for(let t=0;t<e;t++)l[t]=nr(n,r,i);break}case"alias":{let{n,prob:r,alias:s}=rr(t);for(let t=0;t<e;t++)l[t]=lr(n,r,s,i);break}case"sumtree":{let{tree:n,level:r,offset:s}=ir(t);for(let t=0;t<e;t++)l[t]=ar(n,r,s,i);break}default:throw`unexpected method '${r}'`}else{if(e>t)throw"size > p is not allowed when replace = true";switch("auto"==r&&(r=s+e<150?"linear":s+e<200?"binary":"sumtree"),r){case"linear":{let n=er(t);t=t.slice();for(let r=0;r<e;r++){let e=l[r]=tr(t,n,i);n-=t[e],t[e]=0}break}case"binary":{let n=Zn(t),r=n.at(-1);for(let s=0;s<e;s++){let e=l[s]=nr(n,r,i),a=t[s];for(let t=e;t<n.length;t++)n[t]-=a;r-=a}break}case"alias":t=t.slice();for(let n=0;n<e;n++){let{n:e,prob:r,alias:s}=rr(t);t[l[n]=lr(e,r,s,i)]=0}break;case"sumtree":{let{tree:n,level:r,offset:s}=ir(t);for(let t=0;t<e;t++)sr(n,s,l[t]=ar(n,r,s,i),0);break}default:throw`unexpected method '${r}'`}}return l}function ur(e,t=null,n=!0,r=null){if(1!=(e="number"==typeof e?K(e):V(e)).ndim)throw"'p' must be 1-dimensional";if(0==e.size)throw"'a' cannot be empty unless no samples are taken";if(null==r)r=Array(e.size).fill(1/e.size);else{if(1!=(r=V(r)).ndim)throw"'p' must be 1-dimensional";if(r.size!=e.size)throw"'a' and 'p' must have same size";r=r.toarray()}if(e=e.toarray(),null==t)return e[or(1,r)[0]];"number"==typeof t&&(t=[t]);let l=function(e){let t=1;for(let n of e)t*=n;return t}(t);if(ke(r)<l)throw"Fewer non-zero entries in p than size";let i=or(l,r,n).map((t=>e[t]));return N(i).reshape(t)}function fr(e=null){if(null==e)return Math.random();"number"==typeof e&&(e=[e]);let t=function(e){let t=1;for(let n of e)t*=n;return t}(e),n=Array(t);for(let e=0;e<t;e++)n[e]=Math.random();return N(n).reshape(e)}Qn(N([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),0);const hr=fr,dr=fr;function pr(...e){return fr(e)}function cr(e,t=null,n=null,r=!0){if(null!=n){if(!le(n))throw"output array must be contiguous";null==t&&(t=n.shape)}let l;if(null==t){if(r)return e();l=[],t=1}else"number"==typeof t?l=[t]:(l=t,t=M(l));if(null==n)n=B(l);else if(!Ie(l,n.shape))throw"size must match out.shape when used together";let{data:i,offset:s}=n;for(let n=0;n<t;n++)i[s+n]=e();return n}class mr{constructor(e=Math.random){this.rand=e}integers(e,t=null,n=null,r=!1){null==t&&(t=e,e=0);let l=t-e;return r&&(l+=1),cr((()=>this.rand()*l+e|0),n)}random(e=null,t=null){return cr((()=>this.rand()),e,t)}choice(e,t=null,n=!0,r=null,l=0){if("number"==typeof e){if(e<=0)throw"a must be a positive integer unless no samples are taken";e=K(e)}else if(0==(e=V(e)).size)throw"a cannot be empty unless no samples are taken";if(null==r)r=Array(e.shape[l]).fill(1/e.shape[l]);else{if(1!=(r=V(r)).ndim)throw"p must be 1-dimensional";if(r.size!=e.shape[l])throw"a and p must have same size";r=r.toarray()}let i=Array(l).fill(_());if(null==t)return i[l]=or(1,r,void 0,void 0,void 0,this.rand)[0],e._getview(i).copy();let s=t;if("number"==typeof t&&(s=[t]),t=M(s),r.length<t)throw"Cannot take a larger sample than population when replace is false";if(ke(r)<t)throw"Fewer non-zero entries in p than size";let a=[...e.shape];a.splice(l,1,...s);let o=Array(l).fill(_()),u=B(a),f=or(t,r,n,void 0,void 0,this.rand),h=0;for(let t of L(s)){for(let e=0;e<t.length;e++)o[l+e]=t[e];i[l]=f[h++],u.set(o,e._getview(i))}return u}shuffle(e,t=0){t=Al(t,(e=V(e)).ndim);let n=Array(t+1).fill(_(":")),{shape:r}=e,l=r[t],i=B([...r.slice(0,t),...r.slice(t+1)]);for(let r=0;r<l-2;r++){let s=this.rand()*(l-r)+r|0;n[t]=r;let a=e._getview(n);n[t]=s;let o=e._getview(n);i.set(a),a.set(o),o.set(i)}}permuted(e,t=null,n=null){t=Al(t,(e=V(e)).ndim);let r=[...e.shape];r[t]=1,null==n&&(n=X(e));for(let l of L(r)){l[t]=_();let r=e._getview(l).flatten();this.shuffle(r),n.set(l,r)}return n}permutation(e,t=0){return e="number"==typeof e?K(e):N(e),this.shuffle(e,t),e}uniform(e=0,t=1,n=null){return cr((()=>this.rand()*(t-e)+e),n)}normal(e=0,t=1,n=null){return cr((()=>{let n=this.rand(),r=this.rand(),l=Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*r);return e+t*l}),n)}}const gr=new mr;function yr(e,t=null,n=null){if(null==t&&null==n)return _e(e);let r=fe(e,t,n),l=B(r.shape),i=0;for(let[e,t,n]of r)l.data[i++]=e?t:n;return l}function wr(...e){let t=[];for(let n=0;n<e.length;n++){let{start:r,stop:l,step:i,slicelength:s}=e[n].indices(),a=Array(s);for(let e=0;e<s;e++)a[e]=r+e*i;let o=Array(e.length).fill(1);o[n]=s,t.push(N(a).reshape(o))}return t}function br(e,t=null,n=null,r=!1){e=V(e),null==t?(e=ze(e),t=0):t=Al(t,e.ndim);let l=[...e.shape.slice(0,t),...r?[1]:[],...e.shape.slice(t+1)];if(null==n)n=B(l);else if(!Ie(l,n.shape))throw"out must have the same shape as the expected output";return Ge(yn(e,t,null,r),wn(e,t,null,r),n),n}function xr(e,t=null,n=null,r=!1,l=!1){let i;if(e=V(e),null==t?(e=ze(e),t=0):t=Al(t,e.ndim),null!=n&&(n=V(n)),null!=n){if(i=Jt(n),0==i)throw"sum(weights) must not be 0";if(1==n.ndim)n=n.reshape([...Array(t).fill(1),e.shape[t]]);else if(!Ie(n.shape,e.shape))throw"weights.shape and a.shape do not match";e=Be(e,n)}else i=e.shape[t];let s=Xe(Jt(e,t,null,l),i);return r?[s,i]:s}function _r(e,t=null,n=null,r=!1){e=V(e),null==t?(e=ze(e),t=0):t=Al(t,e.ndim);let l=[...e.shape.slice(0,t),...r?[1]:[],...e.shape.slice(t+1)];if(null==n)n=B(l);else if(!Ie(l,n.shape))throw"out must have the same shape as the expected output";return Xe(Jt(e,t,null,r),e.shape[t],n),n}function $r(e,t=null,n=null,r=0,l=!1){e=V(e),null==t?(e=ze(e),t=0):t=Al(t,e.ndim);let i=[...e.shape.slice(0,t),...l?[1]:[],...e.shape.slice(t+1)];if(null==n)n=B(i);else if(!Ie(i,n.shape))throw"out must have the same shape as the expected output";return _r(_n(Ge(e,Xe(Jt(e,t,null,!0),e.shape[t]-r))),t,n,l),n}function Ar(e,t=null,n=null,r=0,l=!1){return n=$r(e,t,n,r,l),bn(n,n),n}function zr(e,t=null,n=0){if(1!=(e=V(e)).ndim)throw"a.dim != 1";if(wn(e)<0)throw"amin(a) < 0";if(n<0)throw"minlength < 0";if(null!=t){if(!Ie((t=V(t)).shape,e.shape))throw"weights.shape != a.shape";t=t.toarray()}let r=Array(Math.max(yn(e)+1,n)).fill(0),l=0;for(let n of e.flat)r[n]+=null!=t?t[l]:1,l++;return N(r)}function vr(e,t=!1){let n,r=e.length,l=Array(r).fill(1);n=t?[]:B([r,...e]);for(let r=0;r<e.length;r++){let i=e[r],s=K(i).reshape([...l.slice(0,r),i,...l.slice(r+1)]);t?n.push(s):n.set([r],s)}return n}function Mr(...e){let t=[],n=e.length;for(let r=0;r<n;r++){let l=e[r];l=V(l),l.ndim,"boolean"==typeof l.item(0)&&([l]=_e(l)),l=l.reshape([...Array(r).fill(1),l.size,...Array(n-r-1).fill(1)]),t.push(l)}return t}function kr(e,t,n=!1,r=!1,l="table"){throw new Error}function Er(e,t=null,n="big"){e=V(e),null==t?(e=ze(e),t=0):t=Al(t,e.ndim);let r=e.shape.slice();r[t]=Math.ceil(r[t]/8);let l=B(r),i=e.shape.slice();i[t]=1;let s=Array(8*r[t]);for(let r of L(i)){let{offset:a}=e,{offset:o}=l;for(let t=0;t<i.length;t++)a+=r[t]*e.strides[t],o+=r[t]*l.strides[t];s.fill(0);for(let n=0;n<e.shape[t];n++){let r=e.data[a+n*e.strides[t]];s[n]=r}let u=0;for(let e=0;e<s.length;e+=8){let r=0;if("big"==n)for(let t=0;t<8;t++)r+=s[e+t]<<7-t;else{if("little"!=n)throw"bitorder can be either big or little";for(let t=0;t<8;t++)r+=s[e+t]<<t}l.data[o+u*l.strides[t]]=r,u++}}return l}function Nr(e,t=null,n=null,r="big"){e=V(e),null==t?(e=ze(e),t=0):t=Al(t,e.ndim);let l=0,i=8;null!=n&&(n<0?l=8-n:i=n);let s=e.shape.slice();s[t]=s[t]*(i-l);let a=B(s),o=Array(8);for(let n of L(e.shape)){let{offset:s}=e,{offset:u}=a;for(let t=0;t<e.shape.length;t++)s+=n[t]*e.strides[t],u+=n[t]*a.strides[t];jr(e.data[s],o,r);for(let e=l,n=0;e<i;e++,n++)a.data[u+n*a.strides[t]]=o[e]}return a}function jr(e,t=[],n="big"){if("big"==n)for(let n=7;n>=0;n--)t[n]=e%2,e=e/2|0;else for(let n=0;n<=7;n++)t[n]=e%2,e=e/2|0;return t}function Sr(e,t=0,n=null){if(0==(e=e.map((e=>V(e)))).length)throw"need at least one array to stack";for(let t=1;t<e.length;t++)if(!Ie(e[0],e[t]))throw"all input arrays must have the same shape";t=Al(t,e[0].ndim+1);let r=[...Array(t).fill(g.colon),g.newaxis];return Te(e.map((e=>e.get(r))),t,n)}function Or(e){return e=oe(...e),Array.isArray(e)||(e=[e]),Te(e,0)}function qr(e){return e=ae(...e),Array.isArray(e)||(e=[e]),e.length>0&&1==e[0].ndim?Te(e,0):Te(e,1)}function Ir(e){return e=ue(...e),Array.isArray(e)||(e=[e]),Te(e,2)}function Fr(e){let t=[];for(let n of e)n=V(n),n.ndim<2&&(n=N(n,null,!1,2).T),t.push(n);return Te(t,1)}function Tr(e){return e=oe(...e),Array.isArray(e)||(e=[e]),Te(e,0)}function Pr(e,t,n=0){let r,l,i;if(null!=e.shape?(n=Al(n,e.ndim),r=e.shape[n]):r=e.length,"number"==typeof t){if(l=0|t,l<=0)throw"number sections must be larger than 0.";let e=r/l|0,n=r%l;i=N([0,...Array(n).fill(e+1),...Array(l-n).fill(e)]).cumsum().array()}else l=t.length+1,i=[0,...t,r];let s=[],a=ie(e,n,0);for(let e=0;e<l;e++){let t=i[e],r=i[e+1];s.push(ie(a.at(_(t,r)),n,0))}return s}function Dr(e,t,n=0){if(n=Al(n,(e=V(e)).ndim),null!=t.shape&&(t=t.array()),null==t.length){let r=t;if(e.shape[n]%r)throw"array split does not result in an equal division"}return Pr(e,t,n)}function Lr(e,t){if(ce(e)<3)throw"dsplit only works on arrays of 3 or more dimensions";return Dr(e,t,2)}function Ur(e,t){if(0==ce(e))throw"hsplit only works on arrays of 1 or more dimensions";return Dr(e,t,ce(e)>1?1:0)}function Vr(e,t){if(ce(e)<2)throw"vsplit only works on arrays of 2 or more dimensions";return Dr(e,t,0)}function Br(e,t,n=null){e=V(e),null==n?(e=ze(e),n=0):n=Al(n,e.ndim);let r=e.shape.slice(),l="number"==typeof t;if(l)r[n]*=t;else if(1==t.length)t=t[0],r[n]*=t,l=!0;else{if(r[n]!=t.length)throw`operands could not be broadcast together with shape (${r[n]},) (${t.length},)`;r[n]=t.reduce(((e,t)=>e+t))}let i=B(r),s=i.strides.slice();s.splice(n,1);let a=e.shape.slice();a.splice(n,1);let o=e.strides.slice();o.splice(n,1);let u=r[n];for(let r of L(a)){let a=0,f=0;for(let e=0;e<r.length;e++)a+=r[e]*o[e],f+=r[e]*s[e];let h=0;for(let r=0;r<u;r++){let s=e.data[a+r*e.strides[n]],o=l?t:t[r];for(let e=0;e<o;e++,h++)i.data[f+h*i.strides[n]]=s}}return i.astype(e.dtype)}function Xr(e,t){"number"==typeof t&&(t=[t]);let n=t.length;if(t.every((e=>1==e))&&e instanceof z)return N(e,e.dtype,!0,n);let r=N(e,e.dtype,!1,n);n<r.ndim&&(t=[...Array(r.ndim-n).fill(1),...t]);let l=r.shape.map(((e,n)=>e*t[n])),i=r.size;if(i>0){let{ndim:e,shape:n}=r;for(let l=0;l<e;l++){let e=n[l],s=t[l];1!=s&&(r=r.reshape(-1,i).repeat(s,0)),i=i/e|0}}return r.reshape(l)}function Cr(e,t=0,n=0,r=1){e=V(e);let{ndim:l}=e;if(l<2)throw"array.ndim must be >= 2";n=Al(n,l),r=Al(r,l);let i=Array(l);i[l-2]=n,i[l-1]=r;for(let e=0,t=0;e<l;e++)e!=n&&e!=r&&(i[t++]=e);let s,a,o=(e=se(e,i)).shape[l-2],u=e.shape[l-1],f=u+1;t<0?(s=-u*t,a=Math.min(u,o+t)*(u+1)-u*t):(s=t,a=Math.min(o,u-t)*(u+1)+t);let h=Math.ceil((a-s)/f);return e.as_strided([...e.shape.slice(0,-2),h],[...e.strides.slice(0,-2),f*e.strides[l-1]],e.offset+s)}function Gr(e,t=0){let n=(e=V(e)).shape;if(1==n.length){let r=n[0]+Math.abs(t),l=te([r,r]),i=t>=0?t:-t*r,s=l.at(_(null,r-t));for(let t=0;t<e.size;t++,i+=r+1)s.itemset(i,e.item(t));return l}if(2!=n.length)throw"Input must be 1- or 2-d.";return Cr(e,t)}function Wr(e,t=null){let n;if(e=V(e),null==t)n=Array(e.ndim).fill(_("::-1"));else{t=Ne(t,e.ndim),n=Array(e.ndim).fill(_(":"));for(let e of t)n[e]=_("::-1")}return e.get(n)}function Hr(e){if((e=V(e)).ndim<2)throw"Input must be >= 2-d.";return e.get(Rr(":","::-1"))}function Jr(e){if((e=V(e)).ndim<1)throw"Input must be >= 1-d.";return e.at(_("::-1"))}let Kr=e=>"number"==typeof e||e instanceof g?e:_(e);const Qr=Symbol("tupleType");function Rr(...e){let t=e.map(Kr);return t[Qr]=!0,t}function Yr(...e){return 1==e.length?Kr(e[0]):Rr(...e)}function Zr(e,t,n,r="raise"){"number"==typeof t&&(t=[t]),"number"==typeof n&&(n=[n]),t=function(e,t,n,r){if("raise"==t)return function(e,t,n){let r=Array(e.length);for(let n=0;n<e.length;n++){let l=e[n];if(l<0&&(l+=t),l<0||l>=t)throw`index ${e[n]} is out of bounds for axis 0 with size ${t}`;r[n]=l}return r}(e,n);if("wrap"==t)return function(e,t){let n=Array(e.length);for(let r=0;r<e.length;r++){let l=e[r]%t;l<0&&(l+=t),n[r]=l}return n}(e,n);if("clip"==t)return function(e,t){let n=Array(e.length);for(let r=0;r<e.length;r++){let l=e[r];n[r]=Math.max(0,Math.min(l,t-1))}return n}(e,n);throw`unexpected mode ${t}`}(t,r,e.size);let l=e.flat,i=n.length;for(let e=0;e<t.length;e++)l.set(t[e],n[e%i])}function el(e,t){"number"==typeof t&&(t=[t]),e=ze(e);let n=1;for(let e of t){if(e<0)throw"all elements of 'new_shape' must be non-negative";n*=e}if(0==e.size||0==n)return te(t);let r=Math.ceil(n/e.size);return G(e=Te(Array(r).fill(e)).at(_(0,n)),t)}function tl(e,t,n="left"){e instanceof z&&(e=e.array());let r=X(t=V(t)),l=0,i="left"==n?nl:rl;for(let n of t.flat)r.data[l++]=i(e,n);return r}function nl(e,t){let n=0,r=e.length-1;for(;n<=r;){let l=n+r>>1;e[l]<t?n=l+1:r=l-1}return n}function rl(e,t){let n=0,r=e.length-1;for(;n<=r;){let l=n+r>>1;e[l]>t?r=l-1:n=l+1}return n}function ll(e,t,n=null){if(e=V(e),null==n)return ll(e.ravel(),t,0).reshape(e.shape);{let r=fe(t,n=Ne(n,e.ndim,!0));if(r.ndim>1)throw new Error("'shift' and 'axis' should be scalars or 1D sequences");let l=Array(e.ndim).fill(0);for(let[e,t]of r)l[t]+=e;let i=Array(e.ndim).fill([[_(null),_(null)]]);for(let[t,n]of l.entries())n%=e.shape[t]||1,n&&(i[t]=[[_(null,-n),_(n,null)],[_(-n,null),_(null,n)]]);let s=X(e);for(let t of new il(i)){let n=t.map((e=>e[0])),r=t.map((e=>e[1]));s.set(r,e.get(n))}return s}}class il{constructor(e){this.length=e.length,this.elements=e.map((e=>Array.from(e))),this.lengths=this.elements.map((e=>e.length)),this.size=this.lengths.reduce(((e,t)=>e*t)),this.coords=Array(this.length),this.done=this.index=void 0,this.reset()}[Symbol.iterator](){return this.reset()}reset(){return this.coords.fill(0),this.index=0,this.done=0==this.size,this}next(){if(this.done)return{done:!0};let{elements:e,coords:t,length:n,lengths:r}=this,l=e.map(((e,n)=>e[t[n]])),i=n-1,s=!0;e:for(;i>=0;)switch(r[i]){case 1:i--;break;case t[i]:t[i--]=0,s=!0;break;default:if(!s)break e;t[i]+=1,s=!1}return this.index++,this.done=this.index>=this.size,{value:l,done:!1}}}function sl(e,t){return cl(t,e)}function al(e,t){return gl(t,e,axis)}function ol(e){let t=Object.create(null);return(...n)=>t[n]??(t[n]=e(...n))}function ul(e,t,...n){return t=t.bind(null,...n),Object.defineProperty(t,"name",{value:e}),t}function fl(e,t,n=null){return Object.defineProperty(cl.bind(n,t),"name",{value:e})}function hl(e,t,n=null){return Object.defineProperty(ml.bind(n,t),"name",{value:e})}function dl(e,t,n=undefined){return Object.defineProperty(gl.bind({defaultinitial:n},t),"name",{value:e})}function pl(e,t,n=null){return Object.defineProperty(yl.bind(n,t),"name",{value:e})}function cl(e,t,n=null,r=this?.dtype){return t=V(t),null==n?n=B(t.shape,r):t=T(t,n.shape),wl(n.ndim)(e,t,n),n}function ml(e,t,n,r=null,l=this?.dtype){let i;return t=V(t),n=V(n),null==r?(i=J(t.shape,n.shape),r=B(i,l)):i=r.shape,t=T(t,i),n=T(n,i),bl(r.ndim)(e,t,n,r),r}function gl(e,t,n=null,r=null,l=!1,i=this?.defaultinitial,s=!0,a=this?.dtype){let o=$l(n,(t=V(t)).ndim),u=[],f=[];for(let e=0;e<o.length;e++)o[e]?f.push(1):(u.push(t.shape[e]),f.push(t.shape[e]));if(null==r)r=B(u,a);else if(!Ie(u,r.shape))throw new Error("unmatch shape");let h=r.reshape(f);return l&&(r=h),xl(t.ndim,o)(e,t,h,i),s&&0==r.ndim?r.item():r}function yl(e,t,n=null,r=null,l=this?.dtype){t=V(t),null==n&&(t=ze(t));let i=$l(n,t.ndim);if(null==r)r=B(t.shape,l);else if(!Ie(t.shape,r.shape))throw new Error("unmatch shape");return _l(t.ndim,i)(e,t,r),r}function wl(e){if(0==e)return new Function("fn","x","out","\nout.data[out.offset] = fn(x.data[x.offset]);\n");let t=(t,n=", ")=>[...Array(e).keys()].map((e=>t.replaceAll("$",e))).join(n);return new Function("fn","x","out",`\nlet { data, strides, offset, shape } = out;\nlet [${t("d_$")}] = shape;\nlet [${t("s_$")}] = strides;\nlet { data: x_data, strides: x_strides, offset: x_offset } = x;\nlet [${t("x_$")}] = x_strides;\n${t("for (let i_$ = 0; i_$ < d_$; i_$++)"," ")} {\n\tdata[offset + ${t("i_$ * s_$"," + ")}] = fn(x_data[x_offset + ${t("i_$ * x_$"," + ")}]);\n}\n`)}function bl(e){if(0==e)return new Function("fn","x1","x2","out","\nout.data[out.offset] = fn(x1.data[x1.offset], x2.data[x2.offset]);\n");let t=(t,n=", ")=>[...Array(e).keys()].map((e=>t.replaceAll("$",e))).join(n);return new Function("fn","x1","x2","out",`\nlet { data, strides, offset, shape } = out;\nlet [${t("d_$")}] = shape;\nlet [${t("s_$")}] = strides;\nlet { data: x1_data, strides: x1_strides, offset: x1_offset } = x1;\nlet { data: x2_data, strides: x2_strides, offset: x2_offset } = x2;\nlet [${t("x1_$")}] = x1_strides;\nlet [${t("x2_$")}] = x2_strides;\n${t("for (let i_$ = 0; i_$ < d_$; i_$++)"," ")} {\n\tdata[offset + ${t("i_$ * s_$"," + ")}] = fn(\n\t\tx1_data[x1_offset + ${t("i_$ * x1_$"," + ")}],\n\t\tx2_data[x2_offset + ${t("i_$ * x2_$"," + ")}]\n\t);\n}\n`)}function xl(e,t){if(0==e)return new Function("fn","x","out","initial","\nout.data[out.offset] = initial != undefined ? fn(initial, x.data[x.offset]) : x.data[x.offset];\n");let n=(t,n=", ",r=[...Array(e).keys()])=>r.map((e=>t.replaceAll("$",e))).join(n),r=[...Array(e).keys()].filter((e=>!t[e])),l=[...Array(e).keys()].filter((e=>t[e]));return new Function("fn","x","out","initial",`\nlet { data, strides, offset } = out;\nlet [${n("s_$")}] = strides;\nlet { data: x_data, strides: x_strides, offset: x_offset, shape } = x;\nlet [${n("d_$")}] = shape;\nlet [${n("x_$")}] = x_strides;\n\nlet use_initial = initial != undefined;\n${n("for (let i_$ = 0; i_$ < d_$; i_$++)"," ",r)} {\n\tlet startOffset = x_offset${r.length?" + ":""}${n("i_$ * x_$"," + ",r)};\n\tlet first = !use_initial;\n\tlet accum = initial;\n\t${n("for (let i_$ = 0; i_$ < d_$; i_$++)"," ",l)} {\n\t\tif (first) {\n\t\t\tfirst = false;\n\t\t\taccum = x_data[startOffset];\n\t\t} else {\n\t\t\taccum = fn(accum, x_data[startOffset + ${n("i_$ * x_$"," + ",l)}]);\n\t\t}\n\t}\n\tdata[offset${r.length?" + ":""}${n("i_$ * s_$"," + ",r)}] = accum;\n}\n`)}function _l(e,t){if(0==e)return new Function("fn","x","out","initial","\nout.data[out.offset] = initial != undefined ? fn(initial, x.data[x.offset]) : x.data[x.offset];\n");let n=(t,n=", ",r=[...Array(e).keys()])=>r.map((e=>t.replaceAll("$",e))).join(n),r=[...Array(e).keys()].filter((e=>!t[e])),l=[...Array(e).keys()].filter((e=>t[e]));return new Function("fn","x","out","initial",`\nlet { data, strides, offset } = out;\nlet [${n("s_$")}] = strides;\nlet { data: x_data, strides: x_strides, offset: x_offset, shape } = x;\nlet [${n("d_$")}] = shape;\nlet [${n("x_$")}] = x_strides;\n\n${n("for (let i_$ = 0; i_$ < d_$; i_$++)"," ",r)} {\n\tlet first = true;\n\tlet accum = x_data[x_offset${r.length?" + ":""}${n("i_$ * x_$"," + ",r)}];\n\t${n("for (let i_$ = 0; i_$ < d_$; i_$++)"," ",l)} {\n\t\tif (first) {\n\t\t\tfirst = false;\n\t\t} else {\n\t\t\taccum = fn(accum, x_data[x_offset + ${n("i_$ * x_$"," + ")}]);\n\t\t}\n\t\tdata[offset + ${n("i_$ * s_$"," + ")}] = accum;\n\t}\n}\n`)}function $l(e,t,n=!1){if(null==e)return Array(t).fill(!0);"object"!=typeof e&&(e=[+e]);let r=Array(t).fill(!1);for(let l of e){if(l=Al(l,t),!n&&r[l])throw new Error("repeated axis");r[l]=!0}return r}function Al(e,t){let n=e;if(e=+e,!Number.isInteger(e))throw new Error(`${n} cannot be cast to integer`);if(e<0&&(e+=t),e<0||t<=e)throw new Error(`axis ${n} is out of bounds for array of dimension ${t}`);return e}function zl(e,t,n=null){e=V(e),t=V(t),vl(e.ndim>0,"x1 does not have enough dimensions"),vl(t.ndim>0,"x2 does not have enough dimensions");let r=1==e.ndim,l=1==t.ndim,i=r||l;if(r&&(e=e.at(null,_(":"))),l&&(t=t.at(_(":"),null)),2==e.ndim&&2==t.ndim){vl(e.shape[1]==t.shape[0],"input shape mismatch");let s=[e.shape[0],t.shape[1]],a=i?s.slice(r?1:0,l?-1:void 0):s;null==n?n=B(a):vl(Ie(a,n.shape),"out shape mismatch");let o=i?n.reshape(s):n,u=t.T;for(let[t,n]of L(s))o.set([t,n],Ml(e.at(t),u.at(n)));return n}let s=J(e.shape.slice(0,-2),t.shape.slice(0,-2));e=T(e,[...s,...e.shape.slice(-2)]),t=T(t,[...s,...t.shape.slice(-2)]),vl(e.shape.at(-1)==t.shape.at(-2),"input shape mismatch");let a=e.shape.at(-2),o=t.shape.at(-1),u=[...s,a,o];null==n?n=B(u):vl(Ie(u,n.shape),"out shape mismatch");for(let r of L(s))zl(e.get(r),t.get(r),n.get(r));return n}function vl(e,t){if(!e)throw new Error(t)}function Ml(e,t,n=null){if(e=V(e),t=V(t),1==e.ndim&&1==t.ndim)return Jt(Be(e,t),0,n);if(2==e.ndim&&2==t.ndim)return zl(e,t,n);if(0==e.ndim||0==t.ndim)return Be(e,t,n);if(1==t.ndim){vl(e.shape.at(-1)==t.shape[0],`shapes ${e.shape} and ${t.shape} not aligned`);let r=e.shape.slice(0,-1);null==n?n=B(r):vl(Ie(r,n.shape),"out shape mismatch");for(let l of L(r))Ml(e.get(l),t,n.at(_("..."),...l));return n}}function kl(e,t=null){t=null!=t?Object.assign(Object.create(jl),t):jl;let{separator:n,prefix:r}=t;return 0==e.size?"[]":function(e,t=jl,n=" ",r=""){let l,i=V(e);0==e.ndim&&(e=i),e.size>t.threshold?(l="...",i=Sl(i,t.edgeitems)):l="";let s=function(e,t){let n=function(e,t){let n={int:()=>new ql(e).__call__,float:()=>new Tl(e,t.precision).__call__,object:()=>Pl},{formatter:r}=t;if(null!=r)for(let e of Object.keys(r))n[e]=Dl(r[e]);return n}(e,t),r=e.flat.copy().data,l=S(r),i=c(l)==c("number")?function(e){for(let t of e)if(!Number.isInteger(t))return!1;return!0}(r)?"int":"float":"object";return n[i](t)}(i,t),a=" "+" ".repeat(r.length),o=function(e,t,n,r,l,i,s,a){function o(n,r,u){let f=n.length,h=e.ndim-f;if(0===h)return t(e.item(n));let d,p=r+" ";d=a<=113?u:u-"]".length;let c,m,g=e.shape[f],y=s&&2*i<g;y?(c=i,m=i):(c=0,m=g);let w="";if(1===h){let e,t=l.trimEnd().length;e=a<=113?u-t:u-Math.max(t,"]".length);let i=r;for(let t=0;t<c;t++){let s=o([...n,t],p,d);[w,i]=Ul(w,i,s,e,r,a),i+=l}y&&([w,i]=Ll(w,i,s,e,r,a),i+=a<=113?", ":l);for(let t=m;t>1;t--){let s=o([...n,-t],p,d);[w,i]=Ul(w,i,s,e,r,a),i+=l}a<=113&&(e=u);let f=o([...n,-1],p,d);[w,i]=Ul(w,i,f,e,r,a),w+=i}else{w="";let e=l.trimEnd()+"\n".repeat(h-1);for(let t=0;t<c;t++)w+=r+o([...n,t],p,d)+e;y&&(w+=r+s,w+=a<=113?", \n":e);let t=m;for(;t>1;t--)w+=r+o([...n,-t],p,d)+e;w+=r+o([...n,-t],p,d)}return w="["+w.slice(r.length)+"]",w}try{return o([],r,n)}finally{o=null}}(e,s,t.linewidth,a,n,t.edgeitems,l,t.legacy);return o}(e,t,n,r)}function El(e,t=null,n=null){return t??=jl.linewidth,n??=jl.precision,0==e.ndim?`${e.item()}`:kl(e,{linewidth:t,precision:n})}function Nl(e,t=null,n=null){if(t??=jl.linewidth,n??=jl.precision,0==e.ndim)return`${e.item()}`;let r,l=e instanceof z?"array":typeof e,i=function(e){return["number","boolean"].includes(e.name)}(e.dtype)&&e.size>0,s=l+"(",a=i?")":",";r=e.size>0||Ie(e.shape,[0])?kl(e,{linewidth:t,precision:n,separator:", ",prefix:s}):`[], shape=[${e.shape.join(", ")}]`;let o=s+r+a;if(i)return o;let u=`dtype=${e.dtype.name})`,f=" ";return o.length-(o.lastIndexOf("\n")+1)+u.length+1>t&&(f="\n"+" ".repeat((l+"(").length)),o+f+u}wl=ol(wl),bl=ol(bl),xl=ol(xl),_l=ol(_l),i.onload((()=>{B(100).reshape(10,10)}));let jl={edgeitems:3,threshold:1e3,linewidth:75,precision:void 0,formatter:null,separator:" ",prefix:""};function Sl(e,t,n=[]){let r=n.length;if(r==e.ndim)return e.get(n);if(e.shape[r]>2*t){let l=n.concat(Rr([,t])),i=n.concat(Rr([-t]));return Te([Sl(e,t,l),Sl(e,t,i)],r)}return Sl(e,t,n.concat(Rr(":")))}class Ol{get __call__(){return this.call.bind(null,this)}}class ql extends Ol{constructor(e){super(),this.padLeft=e.size>0?Math.max(String(e.max()).length,String(e.min()).length):0}call({padLeft:e}=this,t){let n=String(t);return" ".repeat(e-n.length)+n}}function Il(e,t){return e.toExponential(t)}function Fl(e,t){return null!=t?e.toFixed(t):String(e)}class Tl extends Ol{constructor(e,t=undefined){super(),this.precision=t;let n=!1;{let t=e.item(0),r=t,l=!1;for(let n of e.flat)Number.isFinite(n)&&0!=n&&(n=Math.abs(n),t=Math.min(t,n),r=Math.max(r,n),l=!0);l&&(r>=1e8||t<1e-4||r/t>1e3)&&(n=!0)}this.exp_format=n;let r=0;if(this.exp_format)for(let n of e.flat)r=Math.max(r,Il(n,t).length);else for(let n of e.flat)r=Math.max(r,Fl(n,t).length);this.padLeft=r}call({padLeft:e,exp_format:t,precision:n}=this,r){let l=t?Il(r,n):Fl(r,n);return" ".repeat(e-l.length)+l}}function Pl(e){return"string"==typeof e?`'${e}'`:`${e}`}let Dl=e=>()=>e;function Ll(e,t,n,r,l,i){let s=t.length+n.length>r;return i>113&&t.length<=l.length&&(s=!1),s&&(e+=t.trimEnd()+"\n",t=l),[e,t+=n]}function Ul(e,t,n,r,l,i){let s=n.split(/\r?\n/);if(1===s.length||i<=113)return Ll(e,t,n,r,l,i);let a,o=Math.max(...s.map((e=>e.length)));t.length+o>r&&t.length>l.length?(e+=t.trimEnd()+"\n",t=l+s[0],a=l):(a=" ".repeat(t.length),t+=s[0]);for(let n=1;n<s.length;n++)e+=t.trimEnd()+"\n",t=a+s[n];let u=o-s.at(-1).length;return[e,t+=" ".repeat(u)]}class Vl{constructor(e,t,n){this.ndim=e.length,this.size=M(e),this.shape=e,this.strides=t;let r=Array(this.ndim);for(let n=0;n<this.ndim;n++)r[n]=e[n]*t[n];this.dim_strides=r,this.initial=n,this.offset,this.coords=Array(this.ndim),this.index,this.done,this[Symbol.iterator]()}[Symbol.iterator](){return this.index=0,this.done=0==this.size,this.coords.fill(0),this.offset=this.initial,this}next(){if(this.done)return{done:!0};let{offset:e,coords:t,size:n,index:r}=this;if(0!=r){let{shape:n,strides:r,ndim:l,dim_strides:i}=this,s=l-1,a=!0;for(;s>=0;){let l=n[s];if(1==l)s--;else if(l==t[s])e-=i[s],t[s--]=0,a=!0;else{if(!a)break;e+=r[s],t[s]++,a=!1}}this.offset=e}return this.done=++this.index>=n,{value:e,done:!1}}}function Bl(e,t,n=0){return new Vl(e,t,n)}class Xl extends Vl{constructor(e){let{shape:t,strides:n,offset:r}=e;super(t,n,r),this.base=e}next(){return this.done?{done:!0}:{value:this.base.data[super.next().value],done:!1}}at(e){return this.get(e)}get(e){let t,n,{base:r}=this;if("number"==typeof e)return N(r.item(e),r.dtype);"string"==typeof e&&(e=_(e)),e instanceof g?(t=e.indices(r.size),n=B([t.slicelength],r.dtype)):(t=V(e).flat,n=X(e));let l=0;for(let e of t)n.data[l++]=r.item(e);return n}set(e,t){let{base:n}=this;if("number"==typeof e)return n.itemset(e,t),this;"string"==typeof e&&(e=_(e)),t=t instanceof Xl?[...t]:V(t).flatten().data;let r=e instanceof g?e.indices(n.size):V(e).flat,l=0;for(let e of r)n.itemset(e,t[l++%t.length]);return this}copy(){return this.base.flatten()}}function Cl(e){return e=V(e),new Gl(e)}class Gl extends Xl{constructor(e){super(e)}next(){if(this.done)return{done:!0};let e=super.next().value;return{value:[this.coords,e],done:!1}}}function Wl(e,t){e=V(e);let n=t.length,r=M(t),l=B([].concat(e.shape,n)),i=0;for(let s of e.flat){if(s<0||s>=r)throw new Error(`index ${s} is out of bounds for array with size ${r}`);for(let e=n;e--;)l.data[i+e]=s%t[e],s=s/t[e]|0;i+=n}let s=Array(n).fill().map(((e,t)=>t)).map((e=>l.at("...",e)));return s}function Hl(e,t,n="raise"){let r=V(e).T;if(r=oe(r),"raise"==n){if(ht(Fn(r,0))||ht(Pn(r,t)))throw new Error(`index is out of bounds for array with shape ${t}`)}else if("wrap"==n)r=Qe(De(Qe(r,t),t),t);else{if("clip"!=n)throw new Error(`unsupported mode '${n}'`);r=Kn(r,te(t.length),Ge(t,1))}let l=B(F(e).slice(1)),i=Te([Kl(t.slice(1).reverse()).at("::-1"),[1]]),s=0;for(let e of r)l.itemset(s++,Jt(Be(e,i)));return l}function Jl(e,t={}){console.log(e.toString())}const Kl=pl("cumprod",((e,t)=>e*t)),Ql=pl("cumsum",((e,t)=>e+t));let Rl=e=>Number.isNaN(e)?1:e;const Yl=pl("nancumprod",((e,t)=>Rl(e)*Rl(t)));let Zl=e=>Number.isNaN(e)?0:e;const ei=pl("nancumsum",((e,t)=>Zl(e)+Zl(t)));function ti(e,t,n=1e-5,r=1e-8,l=!1){e=V(e),t=V(t);let i=dt(e),s=dt(t);if(ft(i)&&ft(s))return ni(e,t,r,n);[e,t]=P(e,t);let a=nt(i,s),o=at(a),u=ne(a);if(u.set([a],ni(e.at(a),t.at(a),r,n)),u.set([o],qn(e.at(o),t.at(o))),l){let n=nt(ct(e),ct(t));u.set([n],n.at(n))}return u}function ni(e,t,n,r){return Tn($n(Ge(e,t)),De(n,Be(r,$n(t))))}function ri(e,t,n=1e-5,r=1e-8,l=!1){return ft(ti(e,t,n,r,l))}function li(e,t){return oi(si(e),t)}function ii(e){let t=e.length,n=Array(t).fill().map((()=>Array(t).fill(0)));for(let e=0;e<t;e++)n[e][e]=1;for(let r=0;r<t;r++){let l=0,i=-1;for(let n=r;n<t;n++){let t=Math.abs(e[n][r]);t>l&&(i=n,l=t)}if(i!=r){for(let e=0;e<t;e++)[n[e][r],n[e][i]]=[n[e][i],n[e][r]];[e[r],e[i]]=[e[i],e[r]]}for(let n=r+1;n<t;n++){let l=e[n][r]/=e[r][r];for(let i=r+1;i<t;i++)e[n][i]-=l*e[r][i]}}let r=Array(t).fill().map((()=>Array(t).fill(0))),l=Array(t).fill().map((()=>Array(t).fill(0)));for(let n=0;n<t;n++){r[n][n]=1;for(let i=0;i<t;i++)i<n?r[n][i]=e[n][i]:l[n][i]=e[n][i]}return[n,r,l]}function si(e){let[t,n]=[e.length,e[0].length],[r,l]=ai(e.flat(),t,n);return r=G(r,[t,n]).array(),[r,l]}function ai(e,t,n){let r=e.slice(),l=Array(n);for(let e=0;e<n;e++){let i=-1,s=-1;for(let l=e;l<t;l++){let t=Math.abs(r[l*n+e]);t>i&&(s=l,i=t)}if(-1!=s){if(l[e]=s,s!=e)for(let t=0;t<n;t++){let l=e*n+t,i=s*n+t,a=r[l];r[l]=r[i],r[i]=a}for(let l=e+1;l<t;l++){let t=r[l*n+e]/=r[e*n+e];for(let i=e+1;i<n;i++)r[l*n+i]-=t*r[e*n+i]}}else l[e]=e}return[r,l]}function oi(e,t){let[n,r]=e,l=n.length,i=t.slice();for(let e=0;e<l;e++)r[e]!==e&&([i[e],i[r[e]]]=[i[r[e]],i[e]]);for(let e=0;e<l;e++)for(let t=0;t<e;t++)i[e]-=n[e][t]*i[t];for(let e=l-1;e>=0;e--){for(let t=e+1;t<l;t++)i[e]-=n[e][t]*i[t];i[e]/=n[e][e]}return i}function ui(e,t,n=0){e=V(e);let r=[],l=[],i=[];for(let e of t)if(null==e)i.push(null),r.push(!1);else if("string"==typeof e)i.push(_(e)),r.push(!1);else if(e instanceof g)i.push(e),r.push(!1);else if(e=V(e),e.dtype==p("boolean"))for(let t of e.nonzero())l.push(t.shape),i.push(t),r.push(!0);else l.push(e.shape),i.push(e),r.push(!0);let s=r.length,a=J(...l);for(let e=0;e<s;e++)r[e]&&(i[e]=T(i[e],a));let o=!0,u=-1;for(let e=0;e<s;e++)if(r[e]){if(-1===u)u=e;else if(e!==u+1){o=!1;break}u=e}let f=[],h=[];if(o)for(let t=0;t<s;)if(r[t])n+=t,h.push(...a),t=u+1;else{let n=i[t].indices(e.shape[t]).slicelength;f.push(n),h.push(n),t++}else{h.push(...a);for(let t=0;t<s;t++)if(!r[t])if(null==i[t])f.push(1),h.push(1);else{let n=i[t].indices(e.shape[t]).slicelength;f.push(n),h.push(n)}}for(let t=s;t<e.ndim;t++){let n=e.shape[t];h.push(n),f.push(n)}return new fi(e,a,i,n,h)}class fi extends U{constructor(e,t,n,r,l){super(t),this.base=V(e),this.indices=n,this.axis=r,this.outShape=l,this._indices=[...n]}next(){if(this.done)return{done:!0};let{base:e,indices:t,index:n,_indices:r}=this;for(let e=0;e<t.length;e++)t[e]instanceof z&&(r[e]=t[e].item(n));let l=e.get(r);return super.next(),{value:l,done:!1}}get(){let{axis:e,coords:t,outShape:n,base:r}=this,l=B(n,r.dtype);for(let n of this)D(l.get(t,e),n);return l}set(e){let{axis:t,coords:n,outShape:r}=this;e=T(e,r);for(let r of this)D(r,e.get(n,t))}}function hi(e,t){return ui(e,t).get()}function di(e,t,n){return ui(e,t).set(n)}function pi(e,t=null,n=null,r=!1){if(0==(e=V(e)).size)throw new Error("attempt to get argmax of an empty sequence");if(null==t){let t,l=Number.MIN_VALUE,i=0;for(let n of e.flat)n>l&&(t=i,l=n),i++;let s=r?Array(e.ndim).fill(1):[];if(null==n)n=B(s,"number");else if(!Ie(n.shape,s))throw new Error("out shape does not match");return n.itemset(0,t),n}if(t=Al(t,e.ndim),0==e.ndim)return 0;if(1==e.ndim)return pi(e,null,n,r);let l=[...e.shape];if(r?l.splice(t,1,1):l.splice(t,1),null==n)n=B(l,"number");else if(!Ie(n.shape,l))throw new Error("out shape does not match");let i=n,s=[...e.shape];s.splice(t,1),n=n.reshape(s);for(let r of L(s)){let l=[...r];l.splice(t,0,":"),pi(e.get(l),null,n.get(r))}return i}function ci(e,t=null,n=null,r=!1){if(0==(e=V(e)).size)throw new Error("attempt to get argmax of an empty sequence");if(null==t){let t,l=Number.MAX_VALUE,i=0;for(let n of e.flat)n<l&&(t=i,l=n),i++;let s=r?Array(e.ndim).fill(1):[];if(null==n)n=B(s,"number");else if(!Ie(n.shape,s))throw new Error("out shape does not match");return n.itemset(0,t),n}if(t=Al(t,e.ndim),0==e.ndim)return 0;if(1==e.ndim)return ci(e,null,n,r);let l=[...e.shape];if(r?l.splice(t,1,1):l.splice(t,1),null==n)n=B(l,"number");else if(!Ie(n.shape,l))throw new Error("out shape does not match");let i=n,s=[...e.shape];s.splice(t,1),n=n.reshape(s);for(let r of L(s)){let l=[...r];l.splice(t,0,":"),ci(e.get(l),null,n.get(r))}return i}function mi(e){return e=V(e),N([...new Set(e.flat)].sort())}}},t={};function n(r){var l=t[r];if(void 0!==l)return l.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};window.nj=n(584);var l=window;for(var i in r)l[i]=r[i];r.__esModule&&Object.defineProperty(l,"__esModule",{value:!0})})();