var nj;(()=>{var e={460:()=>{}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,r),l.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";function e(t,r){if(t==r)return!0;if(Array.isArray(t)&&Array.isArray(r)){if(t.length!=r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}if("boolean"==typeof t&&"boolean"==typeof r)return t==r;if(Number.isNaN(t)&&Number.isNaN(r))return!0;if("number"==typeof t&&"number"==typeof r)return t==r;if("string"==typeof t&&"string"==typeof r)return t==r;if(null!=t?.toarray)return e(t.toarray(),r);if(null!=r?.toarray)return e(t,r.toarray());if(t?.constructor!=r?.constructor)return!1;let n=Object.getOwnPropertyNames(t),a=Object.getOwnPropertyNames(r);if(n.length!=a.length)return!1;for(let l=0;l<n.length;l++)if(!e(t[n[l]],r[a[l]]))return!1;return!0}function t(e){return e instanceof z&&(e=`NDArray(${JSON.stringify(e.toarray())})`),Array.isArray(e)?JSON.stringify(e):e}r.r(n),r.d(n,{Broadcast:()=>re,Flatiter:()=>L,Generator:()=>zn,NDArray:()=>z,NINF:()=>$t,Nditer:()=>ue,Product:()=>fa,Slice:()=>o,Tester:()=>l,_normalize_indices:()=>ia,_wrap_accum_unary:()=>tt,_wrap_map:()=>We,_wrap_map_binary:()=>et,_wrap_map_unary:()=>Ze,_wrap_reduce:()=>nt,abs:()=>Sr,absolute:()=>qr,add:()=>at,all:()=>pt,amax:()=>Nr,amin:()=>jr,any:()=>ct,arange:()=>J,arccos:()=>jt,arccosh:()=>Gt,arcsin:()=>Nt,arcsinh:()=>Yt,arctan:()=>It,arctan2:()=>Et,arctanh:()=>Jt,argsort:()=>tn,argwhere:()=>we,around:()=>Bt,array:()=>$,array2string:()=>Ia,array_equal:()=>ke,array_equiv:()=>Ne,array_repr:()=>Ea,array_split:()=>Un,array_str:()=>Oa,asarray:()=>S,ascontiguousarray:()=>Q,assert:()=>ga,atleast_1d:()=>Z,atleast_2d:()=>ee,atleast_3d:()=>te,average:()=>kn,axisfunc:()=>ve,bincount:()=>On,bitwise_and:()=>Lr,bitwise_not:()=>Dr,bitwise_or:()=>Vr,bitwise_xor:()=>Yr,broadcast:()=>ne,broadcast_shapes:()=>G,broadcast_to:()=>N,broadcastable:()=>Y,broadcastable_to:()=>k,cbrt:()=>Or,ceil:()=>Kt,choice:()=>mn,clip:()=>en,column_stack:()=>Gn,compress:()=>be,concatenate:()=>je,contiguous:()=>K,convolve:()=>Zr,copy:()=>pe,copysign:()=>yr,copyto:()=>j,cos:()=>Mt,cosh:()=>Lt,count_nonzero:()=>$e,cross:()=>Rr,cumprod:()=>tr,cumsum:()=>rr,deg2rad:()=>Pt,degrees:()=>St,diag:()=>Wn,diagonal:()=>Rn,diff:()=>lr,divide:()=>st,dot:()=>ya,dsplit:()=>Cn,dstack:()=>Yn,e:()=>xt,ediff1d:()=>ir,empty:()=>q,empty_like:()=>F,equal:()=>Ur,even_strides:()=>T,exp:()=>sr,exp2:()=>or,expand_dims:()=>se,expm1:()=>dr,extract:()=>_e,eye:()=>ae,fix:()=>Xt,flatnonzero:()=>ze,flip:()=>Zn,fliplr:()=>ea,flipud:()=>ta,floor:()=>Ht,floor_divide:()=>ot,fmod:()=>Ar,fromfunction:()=>ce,fromiter:()=>me,full:()=>V,gcd:()=>vr,gradient:()=>Qr,greater:()=>Kr,greater_equal:()=>Hr,hsplit:()=>Xn,hstack:()=>Vn,hypot:()=>Ot,identity:()=>le,in1d:()=>qn,index_exp:()=>aa,indices:()=>En,inf:()=>vt,interp:()=>nn,invert:()=>Pr,isfinite:()=>mt,isinf:()=>gt,isna:()=>yt,isneginf:()=>wt,isposinf:()=>bt,isscalar:()=>h,ix_:()=>Sn,lcm:()=>zr,ldexp:()=>wr,left_shift:()=>Gr,less:()=>Xr,less_equal:()=>Cr,linspace:()=>U,log:()=>ur,log10:()=>hr,log1p:()=>pr,log2:()=>fr,logaddexp:()=>cr,logaddexp2:()=>mr,map:()=>ca,matmul:()=>ma,maximum:()=>Mr,mean:()=>Nn,minimum:()=>kr,mod:()=>ut,moveaxis:()=>Ie,multiply:()=>it,nan:()=>_t,nan_to_num:()=>Tr,nancumprod:()=>nr,nancumsum:()=>ar,nanprod:()=>Zt,nansum:()=>er,ndenumerate:()=>ye,ndim:()=>ie,ndindex:()=>I,nditer:()=>he,ndoffset:()=>E,negative:()=>xr,nonzero:()=>ge,normalize_axis:()=>de,normalize_axis_index:()=>Se,normalize_axis_mask:()=>Fe,normalize_axis_tuple:()=>oe,not_equal:()=>Br,ogrid:()=>An,ones:()=>X,packbits:()=>Fn,pi:()=>zt,pick:()=>cn,positive:()=>br,power:()=>ft,prod:()=>Rt,ptp:()=>Mn,put:()=>sa,rad2deg:()=>Tt,radians:()=>qt,rand:()=>bn,random:()=>vn,random_sample:()=>gn,ranf:()=>yn,ravel:()=>xe,reciprocal:()=>$r,remainder:()=>ht,repeat:()=>Kn,reshape:()=>P,resize:()=>da,right_shift:()=>Jr,rint:()=>Ct,roll:()=>pa,row_stack:()=>Jn,s_:()=>la,sample:()=>wn,searchsorted:()=>ha,shallow_array_equal:()=>Ae,shape:()=>M,sign:()=>Fr,signbit:()=>gr,sin:()=>At,sinh:()=>Dt,slice:()=>u,sort:()=>rn,split:()=>Bn,sqrt:()=>Ir,square:()=>Er,squeeze:()=>fe,stack:()=>Dn,std:()=>In,subtract:()=>lt,sum:()=>Wt,swapaxes:()=>R,take:()=>C,tan:()=>kt,tanh:()=>Vt,tester:()=>i,tile:()=>Qn,timeit:()=>d,timeit2:()=>s,transpose:()=>W,trapz:()=>Wr,true_divide:()=>dt,trunc:()=>Qt,tupleType:()=>na,unpackbits:()=>Pn,unwrap:()=>Ft,use_advanced_indexing:()=>x,variance:()=>jn,vsplit:()=>Hn,vstack:()=>Ln,where:()=>$n,zeros:()=>H});class l{compare=e;constructor(){this.tasks={},this._onload=[]}onload(e){this._onload.push(e)}add(e,t,r,n=this.compare){return"function"==typeof e&&(e=e.name),(this.tasks[e]??(this.tasks[e]=[])).push({test:t,expected:r,compare:n}),this}run(e){if(null==e){let e=!0;for(let t of Object.keys(this.tasks))e=this.run(t)&&e;let t=(e?"[32m":"[31m")+"%s[0m";return console.log(t,`Status: ${e}, Total: ${Object.keys(this.tasks).length}`),this._onload.forEach((e=>e())),e}let r=this.tasks[e];if(null==r)throw"no such name";let n=1,a=0,l=[];for(let e of r){let r,i,{test:s,expected:d,compare:o}=e,u=!1,h=!1;try{r=s()}catch(e){r=`[Error]: ${e}`,console.log(e),h=!0}try{i=d()}catch(e){i=`[Error]: ${e}`,console.log(e),h=!0}h||(u=o(r,i)),u&&a++;let f=(u?"[32m":"[31m")+"%s[0m";l.push([f,`#${n}: ${u?"passed":"fail"}`,"\n\tTest=\n",t(r),"\n\tExpected=\n",t(i)]),n++}let i=(a==r.length?"[32m":"[31m")+"%s[0m";if(console.log(i,`Testing ${e}: ${a} / ${r.length} cases passed`),a!=r.length)for(let e of l)console.log(...e);return a==r.length}}let i=new l;function s(e,t=1e3){let r,n=performance.now(),a=0;for(;e(),a++,r=performance.now(),!(r-n>=t););let l=a/((r-n)/t);console.log(`ops: ${l} per sec`,e)}function d(e,{name:t="test",setup:r=null,duration:n=1e3,warmup:a=100,cycle:l="auto",cycle_duration:i=100,repeat:s="auto",verbose:d=!1}={}){let o=r?.();if(i>n&&(i=n),"auto"==s&&(s=n/i|0),"auto"==l){let t,r=1;for(;;){let n=Date.now();for(let t=0;t<r;t++)e(o);if(t=Date.now()-n,t>i)break;r*=2}l=Math.max(r/t*(n/s)|0,1)}let u=[];for(let t=0;t<a;t++)e(o);for(let t=0;t<s;t++){let t=Date.now();for(let t=0;t<l;t++)e(o);let r=l/((Date.now()-t)/1e3);u.push(r)}let h=u.length,f=u.reduce(((e,t)=>e+t))/h;if(d){let e=Math.max(...u),r=Math.min(...u),n=Math.max(e-f,f-r);console.log(`#${t} ${0|f} Â± ${(n/f*100).toFixed(2)}% ops/sec (${s} runs)`)}return f}class o{static newaxis=null;static ellipsis=new o;static colon=new o;static None=o.newaxis;static"..."=o.ellipsis;static":"=o.colon;constructor(e=null,t=null,r=null){this.start=e,this.stop=t,this.step=r}_get(){let e,{start:t,stop:r,step:n}=this;if(t??=0,null==r)throw"stop must not be null";return n??=1,e=0==n||n<0&&r>=t||n>0&&t>=r?0:n<0?(r-t+1)/n+1|0:(r-t-1)/n+1|0,{start:t,stop:r,step:n,slicelength:e}}get(e){let t,{start:r,stop:n,step:a}=this;return null==a&&(a=1),null==r?r=a<0?e-1:0:(r<0&&(r+=e),r<0&&(r=a<0?-1:0),r>=e&&(r=a<0?e-1:e)),null==n?n=a<0?-1:e:(n<0&&(n+=e),n<0&&(n=a<0?-1:0),n>=e&&(n=a<0?e-1:e)),t=0==a||a<0&&n>=r||a>0&&r>=n?0:a<0?(n-r+1)/a+1|0:(n-r-1)/a+1|0,{start:r,stop:n,step:a,slicelength:t}}toString(){if(this==o.ellipsis)return"...";if(this==o.colon)return":";let{start:e,stop:t,step:r}=this;return null==r?null==e&&null==t?":":`${e??""}:${t??""}`:`${e??""}:${t??""}:${r}`}}function u(e,t,r){if(null==e&&null==t&&null==r)return o.colon;if("string"==typeof e){if(Object.hasOwn(o,e))return o[e];let t=e.split(":");if(1==t.length){let[e]=t;if(0==e.length)e=null;else{if(!Number.isInteger(+e))throw new Error(`${e} cannot be cast to integer`);e=+e}return new o(e)}if(2==t.length){let[e,r]=t;if(0==e.length)e=null;else{if(!Number.isInteger(+e))throw new Error(`${e} cannot be cast to integer`);e=+e}if(0==r.length)r=null;else{if(!Number.isInteger(+r))throw new Error(`${r} cannot be cast to integer`);r=+r}return new o(e,r)}if(3==t.length){let[e,r,n]=t;if(0==e.length)e=null;else{if(!Number.isInteger(+e))throw new Error(`${e} cannot be cast to integer`);e=+e}if(0==r.length)r=null;else{if(!Number.isInteger(+r))throw new Error(`${r} cannot be cast to integer`);r=+r}if(0==n.length)n=null;else{if(!Number.isInteger(+n))throw new Error(`${n} cannot be cast to integer`);n=+n}return new o(e,r,n)}throw`invalid string slice representation ${e}`}return null!=e?.length&&({0:e,1:t,2:r}=e),new o(e,t,r)}function h(e){switch(typeof e){case"boolean":case"function":case"number":case"string":return!0}return!1}Object.assign(u,{colon:o.colon},o),u.colon=o.colon,u.is=function(e){return e instanceof o},i.add("isscalar",(()=>h(3.1)),(()=>!0)).add("isscalar",(()=>h($(3.1))),(()=>!1)).add("isscalar",(()=>h([3.1])),(()=>!1)).add("isscalar",(()=>h(!1)),(()=>!0)).add("isscalar",(()=>h("numpy")),(()=>!0)).add("isscalar",(()=>h(Number())),(()=>!0));var f=r(460);function p(e,t){let r=[];if(e.length>0){r[e.length-1]=t;for(let t=e.length-2;t>=0;t--)r[t]=r[t+1]*e[t+1]}return r}function c(e){let t=1;for(let r of e)t*=r;return t}function m(e,t){if(r=t,Number.isInteger(r)){let{ndim:r,shape:n,size:a}=e;if(t<0&&(t+=a),t>=a)throw`index ${t} out of bound for size ${a}`;let l=[...n];for(let e=l.length-2;e>=1;e--)l[e]*=l[e+1];let i=Array(r).fill(0);for(let e=0;e<i.length-1;e++){let r=l[e+1];t>=r&&(i[e]=t/r|0,t%=r)}i[i.length-1]=t,t=i}else{if(!function(e){return null!=e?.length}(t))throw`unexpected type '${function(e){return e?.constructor.name}(t)}'`;if(t.length!=e.ndim)throw"incorrect number of indices for array"}var r;return t}function g(e,t,r){let n=0;for(let a=0;a<e.length;a++)n+=(e[a]<0?e[a]+r[a]:e[a])*t[a];return n}function y(){return this.item()}function w(e){return"string"==e?Oa(this):"default"==e?Ea(this):void 0}function b(e,t){let{shape:r,strides:n,offset:a}=e;t=t.map((e=>"string"==typeof e?u(e):e)),r=r.slice(),n=n.slice();let l=0,i=t.filter((e=>null==e)).length,s=t.filter((e=>e==u("...")));if(s.length>1)throw"an index can only have a single ellipsis ('...')";if(1==s.length){t=t.slice();let e=Array(r.length+i-t.length+1).fill(u(":"));t.splice(t.indexOf(u("...")),1,...e)}if(t.length-i>r.length)throw"too many indices for array";for(let e of t)if(null==e)r.splice(l,0,1),n.splice(l,0,0),l++;else{if(0==r.length)throw"invalid index to scalar variable";if(e==u[":"])l++;else if(u.is(e)){let{start:t,step:i,slicelength:s}=e.get(r[l]);a+=n[l]*t,r.splice(l,1,s),n.splice(l,1,n[l]*i),l++}else e<0&&(e+=r[l]),a+=n[l]*e,r.splice(l,1),n.splice(l,1)}return{strides:n,shape:r,offset:a,immutable:0==r.length&&0==s.length}}function x(e){for(let t of e)if("object"==typeof t&&(Array.isArray(t)||t instanceof z))return!0;return!1}function _(e){let t,r,n,a=!0,l=0,i=e.length-1,s=e.map((e=>e instanceof o));for(;l<i&&s[l];l++);for(;i>l&&s[i];i--);for(let e=l+1;e<i;e++)if(s[e]){a=!1;break}let d=this.shape.map(((t,r)=>s[r]?e[r].get(t).slicelength:e[r]));if(a)t=d.slice(0,l),r=d.slice(i+1),n=e.slice(l,i+1);else{t=[],r=d.filter(((e,t)=>s[t])),n=[];for(let t=l;t<=i;t++)s[t]||n.push(e[t])}let u=ne(...n),h=[...t,...u.shape,...r];e=e.slice();let f=[];for(let t of u){for(let r=0,n=0;r<e.length;r++)s[r]||(e[r]=t[n++]);f.push(this.get(...e,null))}return new z(h,je(f,t.length).data)}class z{constructor(e,t=null,r=null,n=null,a=0,l=1){this.ndim=e.length,this.size=c(e),this.shape=e,this.data=t??Array(this.size),this.itemsize=l,this.strides=n??p(e,l),this.offset=a,this.base=r?.base??r,this.ndim>0?(this.length=this.shape[0],this[Symbol.toPrimitive]=w):this[Symbol.toPrimitive]=y}valueOf(){return 0==this.ndim?this.item():Ea(this)}*[Symbol.iterator](){for(let e=0;e<this.shape[0];e++)yield this.get(e)}_getview(e){let{strides:t,shape:r,offset:n}=b(this,e),{data:a,itemsize:l,base:i}=this;return new z(r,a,i??this,t,n,l)}get(...e){if(1==e.length&&e[0]?.[na]&&(e=e[0]),x(e))return _.call(this,e);let{strides:t,shape:r,offset:n,immutable:a}=b(this,e),{data:l,itemsize:i,base:s}=this;return a?new z(r,[l[n]],null,t,0,i):new z(r,l,s??this,t,n,i)}set(e,t=null){if(null==t)return j(this,t=e),this;if(x(e))throw"cannot use advanced indexing in .set()";let{strides:r,shape:n,offset:a}=b(this,e),{data:l,itemsize:i,base:s}=this;return new z(n,l,s??this,r,a,i).set(t),this}item(e){if(0==e)return this.data[this.offset];let{data:t,strides:r,shape:n,offset:a,ndim:l,size:i}=this;if(null==e){if(1!=i)throw"index cannot be empty if size != 1";return t[a]}if(0==l){if(null!=e.length)if(0==e.length)e=0;else{if(1!=e.length)throw"incorrect number of indices for array";e=e[0]}if(0!=e&&-1!=e)throw`index ${e} out of bound for size ${i}`;return t[a]}if(1==l){if(null!=e.length){if(1!=e.length)throw"incorrect number of indices for array";e=e[0]}if(e<-i||i<=e)throw`index ${e} out of bound for size ${i}`;return e<0&&(e+=i),t[a+e*r[0]]}return 1==e.length&&(e=e[0]),t[a+g(e=m(this,e),r,n)]}itemset(e,t){let{ndim:r,size:n,offset:a,data:l,shape:i,strides:s}=this;if(null==t&&1==n)return l[a]=e,this;if(null==e){if(1!=n)throw"index cannot be empty if size != 1";return l[a]=t,this}if(0==r){if(null!=e.length)if(0==e.length)e=0;else{if(1!=e.length)throw"incorrect number of indices for array";e=e[0]}if(0!=e&&-1!=e)throw`index ${e} out of bound for size ${n}`;return l[a]=t,this}if(1==r){if(null!=e.length){if(1!=e.length)throw"incorrect number of indices for array";e=e[0]}if(e<-n||n<=e)throw`index ${e} out of bound for size ${n}`;return e<0&&(e+=n),l[a+e*s[0]]=t,this}return 1==e.length&&(e=e[0]),l[a+g(e=m(this,e),s,i)]=t,this}toarray(){let{ndim:e,strides:t,itemsize:r,offset:n,data:a,shape:l}=this;if(0==e)return a[n];let i=l[0];if(1==e&&t[0]==r)return a.slice(n,n+i);let s=[];for(let e=0;e<i;e++)s.push(this.get(e).toarray());return s}tolist(){return this.toarray()}get flat(){return new L(this)}set flat(e){this.flat.set([...Array(this.size).keys()],e)}get T(){return W(this)}set T(e){this.T.set(e)}reshape(...e){return 1==e.length&&"number"!=typeof e[0]&&(e=e[0]),P(this,e)}all(e=null,t=null,r=!1){return pt(this,e,t,r)}any(e=null,t=null,r=!1){return any(this,e,t,r)}argmax(e=null,t=null,r=!1){throw"not implemented"}argmin(e=null,t=null,r=!1){throw"not implemented"}argpartition(e,t=-1,r="introselect",n=null){throw"not implemented"}argsort(e=-1,t=null){return tn(this,e,t)}astype(){throw"not implemented"}byteswap(){throw"not implemented"}choose(e,t=null,r="raise"){throw"not implemented"}clip(e,t,r=null){return en(this,e,t,r)}compress(e,t=null,r=null){return be(e,this,t,r)}conj(){throw"not implemented"}conjugate(){throw"not implemented"}copy(){return $(this)}cumprod(e=null,t=null){return tr(this,e,t)}cumsum(e=null,t=null){return rr(this,e,t)}diagonal(e=0,t=0,r=1){return Rn(this,e,t,r)}dump(){throw"not implemented"}dumps(){throw"not implemented"}fill(e){return this.flat=e,this}flatten(){return new z([this.size],[...this.flat])}getfield(){throw"not implemented"}max(e=null,t=null,r=!1,n=null,a=!0){return Nr(this,e,t,r,n,a)}mean(e=null,t=null,r=!1){return Nn(this,e,t,r)}min(e=null,t=null,r=!1,n=null,a=!0){return jr(this,e,t,r,n,a)}newbyteorder(){throw"not implemented"}nonzero(){return ge(this)}partition(e,t=-1,r="introselect",n=null){throw"not implemented"}prod(e=null,t=null,r=!1,n=0,a=!0){return Rt(this,e,t,r,n,a)}ptp(e=null,t=null,r=!1){return Mn(this,e,t,r)}put(e,t,r="raise"){return sa(this,e,t,r),this}ravel(){return xe(this)}repeat(e,t=null){return Kn(this,e,t)}resize(e){if(null!=this.base)throw"cannot resize this array: it does not own its data";if(!K(this))throw"resize only works on single-segment arrays";let t=c(e);t<=this.size?this.data=[...this.data.slice(this.offset,t)]:this.data=[...this.data.slice(this.offset,t),...Array(t-this.size).fill(0)],this.shape=e,this.ndim=e.length,this.strides=p(e,this.itemsize),this.offset=0}round(e=0,t=null){return Bt(this,e,t)}searchsorted(e,t="left"){return ha(this,e,t)}setfield(){throw"not implemented"}setflags(){throw"not implemented"}sort(e=-1,t=null){this.set(rn(this,e,t))}squeeze(e=null){return fe(this,e)}std(e=null,t=null,r=0,n=!1){return In(this,e,t,r,n)}sum(e=null,t=null,r=!1,n=0,a=!0){return Wt(this,e,t,r,n,a)}swapaxes(e,t){return R(this,e,t)}take(e,t=null,r=null,n="raise"){return C(this,e,t,r,n)}tobytes(){throw"not implemented"}tofile(){throw"not implemented"}trace(){throw"not implemented"}transpose(e=null){return W(this,e)}variance(e=null,t=null,r=0,n=!1){return jn(this,e,t,r,n)}}function v(e,t,r,n=0){if(n!=r.length)for(let a=0;a<r[n];a++)v(e,t instanceof z?t.get(a):t[a],r,n+1);else e.push(t instanceof z?t.item():t)}function $(e,t=!0,r=0){let n,a;if(e instanceof z){if(!t){a=e.shape,a.length<r&&(a=[...Array(r-a.length).fill(1),...a]);let{data:t,base:n,strides:l,offset:i,itemsize:s}=e;return new z(a,t,n,l,i,s)}if(null==e.base)n=e.data.slice();else{n=[];for(let t of E(e.shape,e.strides))n.push(e.data[e.offset+t])}a=e.shape}else n=[],a=M(e),v(n,e,a);return a.length<r&&(a=[...Array(r-a.length).fill(1),...a]),new z(a,n)}function A(e,t,r){for(let n=0;n<e.length;n++){let a=e[n];if(a instanceof z){for(let e=r,n=0;e<t.length;e++)if(t[e]!=a.shape[n++])return t.length=e,!1;return!0}if(a?.length!=t[r])return t.length=r,!1;if(null!=a?.length&&t.length>r+1&&!A(a,t,r+1))return!1}return!0}function M(e){if(null!=e.shape)return e.shape;let t=[],r=e;for(;;){if(r instanceof z){t.push(...r.shape);break}if(null==r?.length)break;t.push(r.length),r=r[0]}return null!=e.length&&t.length>1&&A(e,t,1),t}function k(e,t){if(e.length>t.length)return!1;for(let r=t.length-1,n=e.length-1;n>=0;r--,n--)if(1!=e[n]&&e[n]!=t[r])return!1;return!0}function N(e,t){if((e=S(e)).shape.length>t.length)throw"broadcast shape has less dimensions than input array";let{data:r,strides:n,offset:a,itemsize:l}=e,i=[];for(let r=t.length-1,a=e.shape.length-1;r>=0;r--,a--){if(a>=0&&1!=e.shape[a]&&e.shape[a]!=t[r])throw"operands could not be broadcast together";i[r]=a<0||1==e.shape[a]?0:n[a]}return new z(t,r,null,i,a,l)}function j(e,t,r=!0){if(1!=r)throw"haven't implement";if(t instanceof z||Array.isArray(t)){let r=E((t=N(S(t),e.shape)).shape,t.strides);for(let n of E(e.shape,e.strides))e.data[e.offset+n]=t.data[t.offset+r.next().value]}else for(let r of E(e.shape,e.strides))e.data[e.offset+r]=t}function*I(e,t=!0){let r=Array(e.length).fill(0),n=function(e){let t=1;for(let r of e)t*=r;return t}(e);if(0!=n){yield t?r:r.slice();for(let a=1;a<n;a++){for(let t=r.length-1;t>=0&&(r[t]+=1,!(r[t]<e[t]));t--)r[t]-=e[t];yield t?r:r.slice()}}}z.prototype[f?.inspect?.custom]=function(){return 0==this.ndim?this.item():Ea(this)},i.onload((()=>{console.log($([10.22,12.9,66.3])),console.log($(99))})),i.add("ndarray.get",(()=>J(120).reshape(4,6,5,1).get($([0,2,1]),u(),[0,2,4],u())),(()=>$([[[0],[5],[10],[15],[20],[25]],[[62],[67],[72],[77],[82],[87]],[[34],[39],[44],[49],[54],[59]]]))).add("ndarray.get",(()=>J(120).reshape(4,6,5,1).get($([0,2,1]),$([0,2,1]),u(),u())),(()=>$([[[0],[1],[2],[3],[4]],[[70],[71],[72],[73],[74]],[[35],[36],[37],[38],[39]]]))).add("ndarray.get",(()=>J(120).reshape(4,6,5,1).get(u(),$([0,2,1]),$([0,2,4]),u())),(()=>$([[[0],[12],[9]],[[30],[42],[39]],[[60],[72],[69]],[[90],[102],[99]]]))).add("ndarray.get",(()=>J(120).reshape(4,6,5,1).get(u(),$([0,2,1]),u(),[0,0,0])),(()=>$([[[0,1,2,3,4],[30,31,32,33,34],[60,61,62,63,64],[90,91,92,93,94]],[[10,11,12,13,14],[40,41,42,43,44],[70,71,72,73,74],[100,101,102,103,104]],[[5,6,7,8,9],[35,36,37,38,39],[65,66,67,68,69],[95,96,97,98,99]]]))).add("ndarray.get",(()=>J(120).reshape(4,6,5,1).get(u(),u(),$([0,2,1]),$([0,0,0]))),(()=>$([[[0,2,1],[5,7,6],[10,12,11],[15,17,16],[20,22,21],[25,27,26]],[[30,32,31],[35,37,36],[40,42,41],[45,47,46],[50,52,51],[55,57,56]],[[60,62,61],[65,67,66],[70,72,71],[75,77,76],[80,82,81],[85,87,86]],[[90,92,91],[95,97,96],[100,102,101],[105,107,106],[110,112,111],[115,117,116]]]))).add("ndarray.get",(()=>J(120).reshape(4,6,5,1).get($([0,2,1]),u(),u(),$([0,0,0]))),(()=>$([[[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19],[20,21,22,23,24],[25,26,27,28,29]],[[60,61,62,63,64],[65,66,67,68,69],[70,71,72,73,74],[75,76,77,78,79],[80,81,82,83,84],[85,86,87,88,89]],[[30,31,32,33,34],[35,36,37,38,39],[40,41,42,43,44],[45,46,47,48,49],[50,51,52,53,54],[55,56,57,58,59]]]))).add("ndarray.get",(()=>J(120).reshape(4,6,5,1).get($([0,2,1]),$([0,2,1]),u(),0)),(()=>$([[0,1,2,3,4],[70,71,72,73,74],[35,36,37,38,39]]))).add("ndarray.get",(()=>J(120).reshape(4,6,5,1).get($([0,2,1]),u(),u(),0)),(()=>$([[[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19],[20,21,22,23,24],[25,26,27,28,29]],[[60,61,62,63,64],[65,66,67,68,69],[70,71,72,73,74],[75,76,77,78,79],[80,81,82,83,84],[85,86,87,88,89]],[[30,31,32,33,34],[35,36,37,38,39],[40,41,42,43,44],[45,46,47,48,49],[50,51,52,53,54],[55,56,57,58,59]]]))).add("ndarray.get",(()=>new z([2,5],[...Array(10).keys()]).get(u(),u([,,-1]))),(()=>[[4,3,2,1,0],[9,8,7,6,5]])).add("ndarray.get",(()=>new z([2,5],[...Array(10).keys()]).get(u(-1),3)),(()=>[8])).add("ndarray.get",(()=>new z([2,5],[...Array(10).keys()]).get(u([,,-1]),u([,,-1]))),(()=>[[9,8,7,6,5],[4,3,2,1,0]])).add("ndarray.get",(()=>{let e;return e=$([[3,0,0],[0,4,0],[5,6,0]]).get(u(),u(),null),e}),(()=>$([[[3],[0],[0]],[[0],[4],[0]],[[5],[6],[0]]]))).add("ndarray.get",(()=>{let e;return e=$([[3,0,0],[0,4,0],[5,6,0]]).get(u("..."),null),e}),(()=>$([[[3],[0],[0]],[[0],[4],[0]],[[5],[6],[0]]]))),i.add("ndarray.item",(()=>new z([2,5],[...Array(10).keys()]).get(u([,,-1]),u([,,-1])).item(5)),(()=>4)),i.add("ndarray.itemset",(()=>{let e=new z([3,3],[[2,2,6],[1,3,6],[1,0,1]].flat());return e.itemset(4,0),e.itemset([2,2],9),e}),(()=>[[2,2,6],[1,0,6],[1,0,9]])),i.add("ndarray.set",(()=>{let e=new z([2,5],[...Array(10).keys()]);return e.get(u(),u(1,-1)).set(10),e}),(()=>[[0,10,10,10,4],[5,10,10,10,9]])),i.add("ndarray.flatten",(()=>$([[1,2],[3,4]]).flatten()),(()=>$([1,2,3,4]))),i.add("ndarray.flat.set",(()=>{let e=$([[1,2,3],[4,5,6]]);return e.flat=3,e}),(()=>$([[3,3,3],[3,3,3]]))).add("ndarray.flat.set",(()=>{let e=$([[1,2,3],[4,5,6]]);return e.flat=[7,8,9,10],e}),(()=>$([[7,8,9],[10,7,8]]))),i.add("ndarray.copy",(()=>{let e=$([[1,2,3]]);return e.copy()==e}),(()=>!1)).add("ndarray.copy",(()=>{let e=$([[1,2,3]]),t=e.copy();return t.itemset(0,-1),[e,t]}),(()=>[$([[1,2,3]]),$([[-1,2,3]])])),i.add("ndarray.resize",(()=>{let e=$([[0,1],[2,3]]);return e.resize([2,1]),e}),(()=>$([[0],[1]]))).add("ndarray.resize",(()=>{let e=$([[0,1],[2,3]]);return e.resize([2,3]),e}),(()=>$([[0,1,2],[3,0,0]]))).add("ndarray.resize",(()=>{let e=$([[0,1],[2,3]]),t=e;return e.resize([1,1]),[e,t]}),(()=>[$([[0]]),$([[0]])])),i.add("array",(()=>$([3.1,9])),(()=>[3.1,9])).add("array",(()=>$([[9,6],3.1,9]).shape),(()=>[3])).add("array",(()=>$(5)),(()=>5)),i.add("shape",(()=>M([[[3,9]],[[3,9,3]],[[3,9]]])),(()=>[3,1])).add("shape",(()=>M([1,2,3,[1,3]])),(()=>[4])).add("shape",(()=>M([0])),(()=>[1])).add("shape",(()=>M(0)),(()=>[])),i.add("broadcast_to",(()=>N(new z([3],[1,2,3]),[3,3]).toarray()),(()=>[[1,2,3],[1,2,3],[1,2,3]])),i.add("broadcast_to",(()=>N(new z([1,3,1],[1,2,3]),[2,3,4]).toarray()),(()=>[[[1,1,1,1],[2,2,2,2],[3,3,3,3]],[[1,1,1,1],[2,2,2,2],[3,3,3,3]]])),i.add("copyto",(()=>{let e=S([4,5,6]);return j(e,[1,2,3]),e}),(()=>[1,2,3])).add("copyto",(()=>{let e=S([[1,2,3],[4,5,6]]);return j(e,[[4,5,6],[7,8,9]]),e}),(()=>[[4,5,6],[7,8,9]])).add("copyto",(()=>{let e=S([[0,1,2],[3,4,5]]);return j(e.get(u(),1),[-1,-2]),e}),(()=>[[0,-1,2],[3,-2,5]]));class O{constructor(e,t,r){let n=e.length;this.ndim=n,this.shape=e,this.strides=t;let a=Array(n);for(let r=0;r<n;r++)a[r]=e[r]*t[r];this.dim_strides=a,this.initial=r;let l=1;for(let t of e)l*=t;this.size=l,this.coords=Array(n),this.reset()}[Symbol.iterator](){return this.reset(),this}reset(){this.coords.fill(0),this.index=0,this.offset=this.initial,this.done=0==this.size}next(){if(this.done)return{done:!0};let{offset:e,coords:t,shape:r,strides:n,ndim:a,dim_strides:l}=this,i=e,s=a-1,d=!0;for(;s>=0;){let a=r[s];if(1==a)s--;else if(a==t[s])e-=l[s],t[s--]=0,d=!0;else{if(!d)break;e+=n[s],t[s]+=1,d=!1}}return this.offset=e,this.done=++this.index>=this.size,{value:i,done:!1}}}function E(e,t,r=0){return new O(e,t,r)}function S(e){return e instanceof z?e:$(e)}function q(e){var t;return t=e,Number.isInteger(t)&&(e=[e]),new z(e,Array(function(e){let t=1;for(let r of e)t*=r;return t}(e)))}function F(e){return q(M(e))}function T(e,t,r=e.length){let n;for(let e=r-1;e>0;e--)if(t[e]>1){n=e;break}for(let r=n-1;r>=0;r--)if(t[r]>1){if(e[r]!=e[n]*t[n])return!1;n=r}return!0}function P(e,t){e=S(e),"number"==typeof t&&(t=[t]);let r=-1,n=1;for(let e=0;e<t.length;e++)if(-1==t[e]){if(-1!=r)throw"can only specify one unknown dimension";r=e}else n*=t[e];if(-1!=r){let{size:a}=e;if(a%n!=0)throw`cannot reshape array of size ${a} into shape ${t}`;t[r]=0==n?0:a/n}if(e.size!=function(e){let t=1;for(let r of e)t*=r;return t}(t))throw`cannot reshape array of size ${e.size} into shape [${t.join(", ")}]`;if(null==e.base)return new z(t,e.data,e);{let r=!0,n=0;for(let a=0;a<t.length;a++)if(1!=t[a]){for(;n<e.shape.length&&1==e.shape[n];n++);if(n>=e.shape.length||t[a]!=e.shape[n]){r=!1;break}n++}if(n!=e.shape.length&&(r=!1),r){let r=[];for(let n=0,a=0;n<t.length;n++){if(1!=t[n])for(;a<e.shape.length&&1==e.shape[a];a++);r.push(e.strides[a])}return new z(t,e.data,e,r,e.offset,e.itemsize)}}let a=null;return 1==t.length&&T(e.strides,e.shape,e.ndim)?a=[e.strides[0]]:0!=t.length&&(e=$(e)),new z(t,e.data,e,a,e.offset,e.itemsize)}function D(e){return null!=e?.length}i.add(E,(()=>{let e=J(100);e=e.get(u(20,-20)).reshape([2,1,-1,2]).get(u("..."),u("::-1"));let t=[];for(let r of E(e.shape,e.strides))t.push(e.data[e.offset+r]);return t}),(()=>[21,20,23,22,25,24,27,26,29,28,31,30,33,32,35,34,37,36,39,38,41,40,43,42,45,44,47,46,49,48,51,50,53,52,55,54,57,56,59,58,61,60,63,62,65,64,67,66,69,68,71,70,73,72,75,74,77,76,79,78])),i.add("asarray",(()=>{let e=$([[1,2],[3,4]]);return S(e)===e}),(()=>!0)).add("asarray",(()=>S([[1,2],[3,4]])),(()=>[[1,2],[3,4]])),i.add("empty",(()=>q([2,2])),(()=>[[,,],[,,]])).add("empty",(()=>q(0)),(()=>[])).add("empty",(()=>q([])),(()=>{})),i.add("empty_like",(()=>F([[1,2,3],[4,5,6]])),(()=>[[,,,],[,,,]])).add("empty_like",(()=>F([1,2,3,[1,3]])),(()=>[,,,,])),i.add(P,(()=>P($([1,2,3,4,5]).get(u("::-2")),-1)),(()=>$([5,3,1]))).add(P,(()=>P($([1]),[])),(()=>$(1))).add(P,(()=>P($(1),1)),(()=>$([1]))).add(P,(()=>P($(1),-1)),(()=>$([1]))).add("reshape",(()=>P(S([[0,1],[2,3],[4,5]]),[2,3])),(()=>[[0,1,2],[3,4,5]])).add("reshape",(()=>P(S([[[[0,1]]]]),[2,-1])),(()=>[[0],[1]])).add("reshape",(()=>{let e=S([[[[0,1]]]]);return P(e,[2,-1]).base===e}),(()=>!0)).add("reshape",(()=>{let e=S([[[[0,1]]]]).get(0);return P(e,[2,-1]).base===e}),(()=>!1)).add("reshape",(()=>P($([[1,2,3],[4,5,6]]),[-1])),(()=>$([1,2,3,4,5,6]))).add("reshape",(()=>{let e=J(30),t=e.reshape([10,3]).get(u("::2")),r=t.reshape(t.shape);return[t.toarray(),P(t,[1,1,5,-1,3]).base===e,t.base===e,t.reshape(-1).base===e,r===t,r.base===e]}),(()=>[$([[0,1,2],[6,7,8],[12,13,14],[18,19,20],[24,25,26]]).toarray(),!0,!0,!1,!1,!0]));class L{constructor(e){this.base=e,this.index=0,this.coords=Array(e.ndim).fill(0)}[Symbol.iterator](){return this}next(){let e,{coords:t,base:r}=this,{shape:n,size:a}=r,l=this.index>=a;l||(e=r.item(t));for(let e=t.length-1;e>=0&&(t[e]+=1,!(t[e]<n[e]));e--)e>0&&(t[e]-=n[e]);return this.index++,{value:e,done:l}}get(e){if(D(e)){let t=[];for(let r=0;r<e.length;r++)t[r]=this.base.item(e[r]);return new z([e.length],t)}return this.base.item(e)}set(e,t){if(D(e))if(D(t)){t=S(t).flatten().data;for(let r=0;r<e.length;r++)this.base.itemset(e[r],t[r%t.length])}else for(let r=0;r<e.length;r++)this.base.itemset(e[r],t);else{if(D(t))throw"Error setting single item of array";this.base.itemset(e,t)}}copy(){return this.base.flatten()}}function V(e,t){let r=q(e);return j(r,t),r}function Y(...e){let t=0;for(let r of e)t=Math.max(t,r.length);if(0==t)return[];let r=Array(t).fill(1);for(let n of e)for(let e=n.length-1,a=t-1;e>=0;e--,a--){let t=n[e];if(1!=t)if(1==r[a])r[a]=t;else if(r[a]!=t)return!1}return!0}function G(...e){let t=0;for(let r of e)t=Math.max(t,r.length);if(0==t)return[];let r=Array(t).fill(1);for(let n of e)for(let e=n.length-1,a=t-1;e>=0;e--,a--){let t=n[e];if(1!=t)if(1==r[a])r[a]=t;else if(r[a]!=t)throw"shape mismatch"}return r}function J(e,t=undefined,r=1){null==t&&(t=e,e=0);let n=(t-e)/r,a=[];for(let t=0;t<n;t++)a[t]=e+t*r;return new z([n],a)}function U(e,t,r=50,n=!0,a=!1){let l=(t-e)/(n?r-1:r),i=[];for(let t=0;t<r;t++)i[t]=e+t*l;let s=new z([r],i);return a?[s,l]:s}function B(e,t,r){let n=[];if("wrap"==t)for(let t of e)t%=r,t=t<0?t+r:t,n.push(t);else if("clip"==t)for(let t of e)i=r-1,t=(l=t)<0?0:l>i?i:l,n.push(t);else{if("raise"!=t)throw`unexpected mode = ${t}`;for(let t of e){if(t<-r||t>=r)throw`index ${t} is out of bounds for axis 0 with size ${r}`;t=t<0?t+a.size:t,n.push(t)}}var l,i;return n}function C(e,t,r=null,n=null,a="raise"){if(e=S(e),t=$(t),null==r){t.data=B(t.data,a,e.size);let r=t.shape;if(null==n)n=q(r);else if(!Ae(n.shape,r))throw"output array does not match result of ndarray.take";for(let r=0;r<t.size;r++)n.data[r]=e.item(t.data[r]);return n}{r<0&&(r+=e.ndim),t.data=B(t.data,a,e.shape[r]);let l=e.shape.slice();if(l.splice(r,1,...t.shape),null==n)n=q(l);else if(!Ae(n.shape,l))throw"output array does not match result of ndarray.take";let i=Array(r).fill(u());for(let r of I(t.shape))n.get(...i,...r).set(e.get(...i,t.item(r)));return n}}function X(e){return V(e,1)}function H(e){return V(e,0)}function K(e){let{strides:t,shape:r,ndim:n,itemsize:a}=e;if(0==n)return!1;for(let e=n-1;e>=0;e--)if(r[e]>1){if(a!=t[e])return!1;a*=r[e]}return!0}function Q(e){let t=S(e);return K(t)?t:$(t)}function R(e,t,r){let{strides:n,shape:a,data:l,offset:i,base:s,itemsize:d}=e;n=n.slice(),a=a.slice();let o=n[t],u=a[t];return n[t]=n[r],a[t]=a[r],n[r]=o,a[r]=u,new z(a,l,s,n,i,d)}function W(e,t=null){let r,n,{ndim:a,shape:l,strides:i,data:s,base:d,offset:o,itemsize:u}=e;if(null==t)r=l.slice().reverse(),n=i.slice().reverse();else{t=function(e,t){if(e.length!=t)throw"axes don't match array";let r=[],n={};for(let a=0;a<t;a++){let l=e[a];if(l<-t||t<=l)throw`axis ${l} is out of bounds for array of dimension ${a+1}`;if(l<0&&(l+=t),n[l])throw"repeated axis in transpose";n[l]=!0,r[a]=l}return r}(t,a),r=Array(a),n=Array(a);for(let e=0;e<a;e++)r[e]=l[t[e]],n[e]=i[t[e]]}return new z(r,s,d??e,n,o,u)}function Z(...e){if(1!=e.length){let t=[];for(let r of e)t.push(Z(r));return t}let t=S(e[0]);if(t.ndim>=1)return t;t=t.copy();let{data:r,itemsize:n}=t;return new z([1],r,t,[n],0,n)}function ee(...e){if(1!=e.length){let t=[];for(let r of e)t.push(ee(r));return t}let t=S(e[0]);if(t.ndim>=2)return t;let{shape:r,data:n,strides:a,offset:l,itemsize:i,ndim:s}=t;return 1==s?new z([1,r[0]],n,t,[0,a[0]],l,i):(t=t.copy(),new z([1,1],t.data,t,[i,i],0,i))}function te(...e){if(1!=e.length){let t=[];for(let r of e)t.push(te(r));return t}let t=S(e[0]);if(t.ndim>=3)return t;let{shape:r,data:n,strides:a,offset:l,itemsize:i,ndim:s}=t;return 2==s?new z([r[0],r[1],1],n,t,[a[0],a[1],0],l,i):1==s?new z([1,r[0],1],n,t,[0,a[0],0],l,i):(t=t.copy(),new z([1,1,1],t.data,t,[i,i,i],0,i))}i.add("Flatiter",(()=>{let e=new z([2,3],[0,1,2,3,4,5]),t=new L(e),r=[];for(let e of t){for(let e of t)r.push(e);r.push(e)}return r}),(()=>[1,2,3,4,5,0])).add("Flatiter",(()=>{let e=new z([3,1],[0,1,2]),t=new L(e),r=[];for(let e of t)r.push(e,t.index,[...t.coords]);return r}),(()=>[0,1,[1,0],1,2,[2,0],2,3,[3,0]])).add("Flatiter",(()=>{let e=new z([1,2],[0,1]),t=new L(e),r=[];for(let n of t){for(let n of new L(e))r.push(n,t.index,[...t.coords]);r.push(n,t.index,[...t.coords])}return r}),(()=>[0,1,[0,1],1,1,[0,1],0,1,[0,1],0,2,[1,0],1,2,[1,0],1,2,[1,0]])),i.add("Flatiter.get",(()=>new L($([[1,2,3],[4,5,6]])).get(3)),(()=>4)).add("Flatiter.get",(()=>new L($([[1,2,3],[4,5,6]])).get([3,4,-1])),(()=>[4,5,6])),i.add("Flatiter.set",(()=>{let e=$([[3,3,3],[3,3,3]]);return new L(e).set([1,-1],[[1],[2]]),e}),(()=>[[3,1,3],[3,3,2]])),i.add("Flatiter.copy",(()=>new L(new z([2,3],[0,1,2,3,4,5]).get(u([,,-1]))).copy()),(()=>[3,4,5,0,1,2])),i.add("full",(()=>V([2,2],1/0)),(()=>[[1/0,1/0],[1/0,1/0]])).add("full",(()=>V([2,2],10)),(()=>[[10,10],[10,10]])).add("full",(()=>V([2,2],[1,2])),(()=>[[1,2],[1,2]])).add("full",(()=>V(2,-1)),(()=>[-1,-1])),i.add("broadcast_shapes",(()=>G([1,2],[3,1],[3,2])),(()=>[3,2])),i.add("broadcast_shapes",(()=>G([6,7],[5,6,1],[7],[5,1,7])),(()=>[5,6,7])),i.add("arange",(()=>J(3)),(()=>$([0,1,2]))).add("arange",(()=>J(-10,10)),(()=>$([-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9]))).add("arange",(()=>J(-10,10,-1)),(()=>$([]))).add("arange",(()=>J(3,7,2)),(()=>$([3,5]))).add("arange",(()=>J(0,-10,-1)),(()=>$([0,-1,-2,-3,-4,-5,-6,-7,-8,-9]))),i.add("linspace",(()=>U(2,3,5)),(()=>$([2,2.25,2.5,2.75,3]))).add("linspace",(()=>U(2,3,5,!1)),(()=>$([2,2.2,2.4,2.6,2.8]))).add("linspace",(()=>U(2,3,5,!0,!0)),(()=>[$([2,2.25,2.5,2.75,3]),.25])).add("linspace",(()=>U(2,3,5,!1,!0)),(()=>[$([2,2.2,2.4,2.6,2.8]),.2])).add("linspace",(()=>U(1,10,10,!1)),(()=>$([1,1.9,2.8,3.7,4.6,5.5,6.4,7.3,8.2,9.1]))),i.add("take",(()=>C([4,3,5,7,6,8],[0,1,4])),(()=>$([4,3,6]))).add("take",(()=>C([4,3,5,7,6,8],[[0,1],[2,3]])),(()=>$([[4,3],[5,7]]))).add("take",(()=>C($([[1,2],[3,4],[5,6],[7,8]]),[[0,1],[2,3]],0)),(()=>$([[[1,2],[3,4]],[[5,6],[7,8]]]))).add("take",(()=>C($([[1,2],[3,4],[5,6],[7,8]]),$([[[[0,1],[0,1]]]]),1)),(()=>$([[[[[1,2],[1,2]]]],[[[[3,4],[3,4]]]],[[[[5,6],[5,6]]]],[[[[7,8],[7,8]]]]]))).add("take",(()=>C([[5,6,2,7,1],[4,9,2,9,3]],[0,4],1)),(()=>[[5,1],[4,3]])),i.add(Q,(()=>{let e=X([3,1,5]).get(u(),u([,,3]),u());return Q(e)===e}),(()=>!0)),i.add(Q,(()=>{let e=X([3,4,5]).get(u(),u([,,1]),u());return Q(e)===e}),(()=>!0)),i.add(Q,(()=>{let e=X([3,4,5]).get(u(),u(),u(1));return Q(e)===e}),(()=>!1)),i.add(Q,(()=>{let e=X([3]).get(u([,,-3]));return Q(e)===e}),(()=>!0)),i.add(Q,(()=>{let e=X([2]).get(u([,,2]));return Q(e)===e}),(()=>!0)),i.add(Q,(()=>{let e=X([3]).get(u([,,2]));return Q(e)===e}),(()=>!1)),i.add(Q,(()=>{let e=X([3]).get(u([1,2]));return Q(e)===e}),(()=>!0)).add(Q,(()=>{let e,t;return e=$([]),t=Q(e),e===t}),(()=>!0)).add(Q,(()=>{let e,t;return e=$(5),t=Q(e),e===t}),(()=>!1)),i.add(R,(()=>R($([[1,2,3]]),0,1)),(()=>$([[1],[2],[3]]))),i.add(R,(()=>R($([[[0,1],[2,3]],[[4,5],[6,7]]]),0,2)),(()=>$([[[0,4],[2,6]],[[1,5],[3,7]]]))),i.add(W,(()=>W(J(4).reshape([2,2]))),(()=>$([[0,2],[1,3]]))).add(W,(()=>W(X([1,2,3]),[1,0,2])),(()=>$([[[1,1,1]],[[1,1,1]]]))).add(W,(()=>W(X([2,3,4,5])).shape),(()=>[5,4,3,2])),i.add(Z,(()=>Z(1)),(()=>$([1]))).add(Z,(()=>Z(1,[3,4])),(()=>[$([1]),$([3,4])])).add(Z,(()=>Z(J(9).reshape([3,3]))),(()=>$([[0,1,2],[3,4,5],[6,7,8]]))).add(Z,(()=>{let e=$([1]),t=e.get(0),r=Z(t);return r.set([0],-96),[e.toarray(),t.toarray(),r.toarray(),null===e.base,null===t.base,r.base!=t,r.base]}),(()=>[$([1]),1,$([-96]),!0,!0,!0,$(-96)])),i.add(ee,(()=>ee(3)),(()=>$([[3]]))).add(ee,(()=>{let e=J(3);return[ee(e),ee(e).base===e]}),(()=>[$([[0,1,2]]),!0])).add(ee,(()=>ee(1,[1,2],[[1,2]])),(()=>[$([[1]]),$([[1,2]]),$([[1,2]])])),i.add(te,(()=>te(3)),(()=>$([[[3]]]))).add(te,(()=>te(J(3)).shape),(()=>[1,3,1])).add(te,(()=>{let e=J(12).reshape(4,3);return[te(e).shape,te(e).base===e.base]}),(()=>[[4,3,1],!0])).add(te,(()=>te([1,2],[[1,2]],[[[1,2]]])),(()=>[[[[1],[2]]],[[[1],[2]]],[[[1,2]]]]));class re{constructor(e){e=e.map(S),this.numiter=e.length,this.shape=G(...e.map((e=>e.shape))),this.arrays=e.map((e=>N(e,this.shape))),this.ndim=this.shape.length,this.size=function(e){let t=1;for(let r of e)t*=r;return t}(this.shape),this.index=0,this.reset()}[Symbol.iterator](){return 0!=this.index&&this.reset(),this}next(){let e=this.iters.map((e=>e.next().value)),t=this.index>=this.size;return this.index++,{value:e,done:t}}reset(){this.iters=this.arrays.map((e=>e.flat)),this.index=0}}function ne(...e){return new re(e)}function ae(e,t=e,r=0){let n=e*t,a=Array(n).fill(0);for(let e=r+Math.ceil(-r/(t+1))*(t+1);e<n;e+=t+1)a[e]=1;return new z([e,t],a)}function le(e){let t=e*e,r=Array(t).fill(0);for(let n=0;n<t;n+=e+1)r[n]=1;return new z([e,e],r)}function ie(e){return null==e||h(e)?0:S(e).ndim}function se(e,t){e=S(e),"number"==typeof t&&(t=[t]);let r=t.length;if((t=new Set(t)).size!=r)throw"repeated axis";let n=e.ndim+r,a=[];for(let r=0,l=0;r<n;r++)a.push(t.has(r)?1:e.shape[l++]);return e.reshape(a)}function de(e,t,r=!1){if(Array.isArray(e)||(e=[e]),e=e.map((e=>Se(e,t))),!r&&new Set(e).size!=e.length)throw"repeated axis";return e}i.add(ne,(()=>{let e=ne($([[1],[2],[3]]),$([4,5,6])),t=q(e.shape),r=[];for(let[t,n]of e)r.push(t+n);return t.flat=r,t}),(()=>$([[5,6,7],[6,7,8],[7,8,9]]))).add(ne,(()=>{let e=[],t=ne($([1,2,3]),$([[4],[5],[6]]));return e.push(t.index),e.push(t.next().value,t.next().value,t.next().value),e.push(t.index),t.reset(),e.push(t.index),e}),(()=>[0,[1,4],[2,4],[3,4],3,0])),i.add("eye",(()=>ae(2)),(()=>[[1,0],[0,1]])).add("eye",(()=>ae(3,3,1)),(()=>[[0,1,0],[0,0,1],[0,0,0]])).add("eye",(()=>ae(4,5,-1)),(()=>[[0,0,0,0,0],[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0]])),i.add("identity",(()=>le(3)),(()=>[[1,0,0],[0,1,0],[0,0,1]])).add("identity",(()=>le(0)),(()=>[])),i.add("ndim",(()=>ie([[1,2,3],[4,5,6]])),(()=>2)).add("ndim",(()=>ie(S([[1,2,3],[4,5,6]]))),(()=>2)).add("ndim",(()=>ie(1)),(()=>0)).add("ndim",(()=>ie(null)),(()=>0)),i.add(se,(()=>se($([1,2]),0)),(()=>$([[1,2]]))).add(se,(()=>se($([1,2]),1)),(()=>$([[1],[2]]))).add(se,(()=>se($([1,2]),[0,1])),(()=>$([[[1,2]]]))).add(se,(()=>se($([1,2]),[2,0])),(()=>$([[[1],[2]]]))).add(se,(()=>{let e=$([1,2]);return se(e,[2,0]).base===e}),(()=>!0));const oe=de;class ue{constructor(e,t=null){this.array=S(e);let{ndim:r,shape:n}=e;if(null!=t&&(t=de(t,r)),this.axis=t,null!=t){let e=[],a=[],l=[];for(let i=0;i<r;i++)(l[i]=!t.includes(i))?(a[i]=0,e.push(n[i])):a[i]=u[":"];this.shape=e,this.indices=a,this.mask=l}else this.shape=[e.size],this.indices=[0],this.mask=null}*[Symbol.iterator](){let{array:e,axis:t}=this;if(null==t)return void(yield*e.flat);let{shape:r,mask:n,indices:a}=this;for(let t of I(r)){for(let r=0,l=0;r<e.ndim;r++)n[r]&&(a[r]=t[l++]);yield[t,e.get(...a)]}}}function he(e,t=null){return new ue(e,t)}function fe(e,t=null){e=S(e),null!=t&&(t=de(t));let{shape:r,strides:n,data:a,ndim:l,offset:i,itemsize:s}=e,d=[],o=[];for(let e=0;e<l;e++)(t?t.includes(e):1==r[e])||(d.push(r[e]),o.push(n[e]));return new z(d,a,e,o,i,s)}function pe(e){return $(e)}function ce(e,t){let r=[];for(let n of I(t))r.push(e(n));return new z(t,r)}function me(e,t=-1){let r;if(-1==t)r=[...e];else{r=[];let n=0;if(n<t)for(let a of e)if(r.push(a),n++,n>=t)break}return $(r)}function ge(e){e=Z(e);let{ndim:t}=e,r=[];for(let e=0;e<t;e++)r.push([]);for(let[n,a]of ye(e))if(a)for(let e=0;e<t;e++)r[e].push(n[e]);for(let e=0;e<t;e++)r[e]=$(r[e]);return r}function*ye(e){e=S(e);for(let t of I(e.shape)){let r=[t,e.item(t)];yield r}}function we(e){e=S(e);let t=0,r=[];for(let[n,a]of ye(e))a&&(r.push(...n),t++);return new z([t,e.ndim],r)}function be(e,t,r=null,n=null){if(1!=(e=S(e)).ndim)throw"condition must be a 1-d array";return C(t,ge(e)[0],r,n)}function xe(e){e=Q(e);let{size:t,data:r,offset:n,itemsize:a}=e;return new z([t],r,e.base,void 0,n,a)}function _e(e,t){return be(xe(e),xe(t))}function ze(e){return ge(xe(e))[0]}function ve(e,t,r,n,a){let{strides:l,ndim:i,shape:s}=t;r=de(r,i);let d=Array(i).fill().map(((e,t)=>r.includes(t))),o=[],h=[];for(let e=0,t=0;e<i;e++)d[e]?(h[e]=u[":"],n&&(o[t++]=1)):o[t++]=s[e];null==a&&(a=q(o));for(let r of I(o)){for(let e=0,t=0;e<i;e++)d[e]||(h[e]=r[t++]);a.itemset(r,e(t.get(...h)))}return a}function $e(e,t=null,r=!1){if(e=S(e),null!=t)return ve($e,e,t,r);let n=0;for(let t of e.flat)t&&n++;return n}function Ae(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}i.add(fe,(()=>fe($([[[0],[1],[2]]])).shape),(()=>[3])).add(fe,(()=>fe($([[[0],[1],[2]]]),0).shape),(()=>[3,1])).add(fe,(()=>fe($([[[0],[1],[2]]]),2).shape),(()=>[1,3])).add(fe,(()=>fe($([[1234]]))),(()=>$(1234))).add(fe,(()=>{let e,t,r,n,a;return e=J(20),t=e.reshape([5,-1]),r=t.get(u([,,-1])),n=Q(r),a=n.reshape([5,1,1,-1]),[a.reshape([5,-1]).base===n,a.reshape(-1).base===n,fe(a).base===n,e,t,r,fe(a)]}),(()=>[!0,!0,!0,$([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]),$([[0,1,2,3],[4,5,6,7],[8,9,10,11],[12,13,14,15],[16,17,18,19]]),$([[16,17,18,19],[12,13,14,15],[8,9,10,11],[4,5,6,7],[0,1,2,3]]),$([[16,17,18,19],[12,13,14,15],[8,9,10,11],[4,5,6,7],[0,1,2,3]])])),i.add(pe,(()=>{let e,t,r;return e=$([1,2,3]),t=e,r=pe(e),e.set([0],10),[e.item(0)==t.item(0),e.item(0)==r.item(0)]}),(()=>[!0,!1])),i.add(ce,(()=>ce((([e,t])=>e),[2,2])),(()=>$([[0,0],[1,1]]))).add(ce,(()=>ce((([e,t])=>t),[2,2])),(()=>$([[0,1],[0,1]]))).add(ce,(()=>ce((([e,t])=>e==t),[3,3])),(()=>$([[!0,!1,!1],[!1,!0,!1],[!1,!1,!0]]))).add(ce,(()=>ce((([e,t])=>e+t),[3,3])),(()=>$([[0,1,2],[1,2,3],[2,3,4]]))),i.add(me,(()=>me({*[Symbol.iterator](){for(let e=0;e<5;e++)yield e*e}})),(()=>$([0,1,4,9,16]))).add(me,(()=>me({*[Symbol.iterator](){for(let e=0;e<5;e++)yield[e+1,e+2]}})),(()=>$([[1,2],[2,3],[3,4],[4,5],[5,6]]))),i.add(ge,(()=>{let e;return e=$([[3,0,0],[0,4,0],[5,6,0]]).get(u("..."),null),ge(e)}),(()=>[$([0,1,2,2]),$([0,1,0,1]),$([0,0,0,0])])).add(ge,(()=>ge($([[!1,!1,!1],[!0,!0,!0],[!0,!0,!0]]))),(()=>[$([1,1,1,2,2,2]),$([0,1,2,0,1,2])])).add(ge,(()=>ge(55)),(()=>$([0]))),i.add(ye,(()=>{{let e;e=$([[1,2],[3,4]]);let t=[];for(let[r,n]of ye(e))t.push(r.slice(),n);return t}}),(()=>[[0,0],1,[0,1],2,[1,0],3,[1,1],4])),i.add(we,(()=>we(55).shape),(()=>[1,0])).add(we,(()=>we(Kr(J(6).reshape(2,3),1))),(()=>$([[0,2],[1,0],[1,1],[1,2]]))),i.add(be,(()=>be([0,1],$([[1,2],[3,4],[5,6]]),0)),(()=>$([[3,4]]))).add(be,(()=>be([!1,!0,!0],$([[1,2],[3,4],[5,6]]),0)),(()=>$([[3,4],[5,6]]))).add(be,(()=>be([!1,!0],$([[1,2],[3,4],[5,6]]),1)),(()=>$([[2],[4],[6]]))).add(be,(()=>be([!1,!0],$([[1,2],[3,4],[5,6]]))),(()=>$([2]))),i.add(xe,(()=>xe($([[1,2,3],[4,5,6]]))),(()=>$([1,2,3,4,5,6]))).add(xe,(()=>xe($([[1,2,3],[4,5,6]]).T)),(()=>$([1,4,2,5,3,6]))).add(xe,(()=>xe(J(12).reshape(2,3,2).swapaxes(1,2))),(()=>$([0,2,4,1,3,5,6,8,10,7,9,11]))).add(xe,(()=>{let e,t;return e=J(40).reshape([5,-1]).copy(),t=e.get(null,u(":"),null,null,u("::2"),null),[t.reshape(-1).base==e,xe(t).base]}),(()=>[!0,null])).add(xe,(()=>{let e,t;return e=J(40).reshape([5,-1]).copy(),t=e.get(null,u(":"),null,null,u("::3"),null),[t.reshape(-1).base==e,xe(t).base]}),(()=>[!1,null])),i.add(_e,(()=>{let e,t;return e=J(12).reshape([3,4]),t=$([[!0,!1,!1,!0],[!1,!1,!0,!1],[!1,!0,!1,!1]]),_e(t,e)}),(()=>$([0,3,6,9]))),i.add(ze,(()=>{let e;return e=J(-2,3),ze(e)}),(()=>$([0,1,3,4]))),i.add($e,(()=>{let e;return e=X([2,3,4,5]),$e(e)}),(()=>120)).add($e,(()=>{let e;return e=X([2,3,4,5]),$e(e,0)}),(()=>$([[[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2]],[[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2]],[[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2]]]))).add($e,(()=>{let e;return e=X([2,3,4,5]),$e(e,1)}),(()=>$([[[3,3,3,3,3],[3,3,3,3,3],[3,3,3,3,3],[3,3,3,3,3]],[[3,3,3,3,3],[3,3,3,3,3],[3,3,3,3,3],[3,3,3,3,3]]]))).add($e,(()=>{let e;return e=X([2,3,4,5]),$e(e,-1)}),(()=>$([[[5,5,5,5],[5,5,5,5],[5,5,5,5]],[[5,5,5,5],[5,5,5,5],[5,5,5,5]]]))).add($e,(()=>{let e;return e=X([2,3,4,5]),$e(e,[0,-1])}),(()=>$([[10,10,10,10],[10,10,10,10],[10,10,10,10]]))).add($e,(()=>{let e;return e=X([2,3,4,5]),$e(e,[0,-1],!0)}),(()=>$([[[[10],[10],[10],[10]],[[10],[10],[10],[10]],[[10],[10],[10],[10]]]])));const Me=et("nan_equal",((e,t)=>e==t||Number.isNaN(e)&&Number.isNaN(t)));function ke(e,t,r=!1){return e=S(e),t=S(t),!!Ae(e.shape,t.shape)&&pt(r?Me(e,t):Ur(e,t))}function Ne(e,t){return e=S(e),t=S(t),!!Y(e.shape,t.shape)&&pt(Ur(e,t))}function je(e,t=0,r=null){if(e.length<=0)throw"need at least one array to concatenate";e=e.map(S),null==t&&(e=e.map(xe),t=0);let{ndim:n,shape:a}=e[0];if(0==n)throw"zero-dimensional arrays cannot be concatenated";for(let r=1;r<e.length;r++){let l=e[r];if(l.ndim!=n)throw`all the input arrays must have same number of dimensions, but the array at index 0 has ${n} dimension(s) and the array at index ${r} has ${e[r].ndim} dimension(s)`;for(let i=0;i<n;i++)if(i!=t&&l.shape[i]!=a[i])throw`all the input array dimensions for the concatenation axis must match exactly, but along dimension ${i}, the array at index 0 has size ${a[i]} and the array at index ${r} has size ${e[r].shape[i]}`}t=Se(t,n);let l=a.slice();if(l[t]=e.reduce(((e,r)=>e+r.shape[t]),0),null==r)r=q(l);else{if(r.ndim!=n)throw"Output array has wrong dimensionality";if(!Ae(r.shape,l))throw"Output array is the wrong shape"}let i=Array(n).fill(u(":")),s=0;for(let n of e)i[t]=u(s,s+=n.shape[t]),r.set(i,n);return r}function Ie(e,t,r){if(t=oe(t,e.ndim),r=oe(r,e.ndim),t.length!=r.length)throw"'source' and 'destination' arguments must have the same number of elements";let n=[...Array(e.ndim).keys()].filter((e=>!t.includes(e)));for(let e=0;e<t.length;e++)n.splice(r[e],0,t[e]);return W(e,n)}i.add(ke,(()=>ke([1,2],[1,2])),(()=>!0)).add(ke,(()=>ke($([1,2]),$([1,2]))),(()=>!0)).add(ke,(()=>ke([1,2],[1,2,3])),(()=>!1)).add(ke,(()=>ke([1,2],[1,4])),(()=>!1)).add(ke,(()=>{let e=$([1,NaN]);return ke(e,e)}),(()=>!1)).add(ke,(()=>{let e=$([1,NaN]);return ke(e,e,!0)}),(()=>!0)),i.add(Ne,(()=>Ne([1,2],[1,2])),(()=>!0)).add(Ne,(()=>Ne([1,2],[1,3])),(()=>!1)).add(Ne,(()=>Ne([1,2],[[1,2],[1,2]])),(()=>!0)).add(Ne,(()=>Ne([1,2],[[1,2,1,2],[1,2,1,2]])),(()=>!1)).add(Ne,(()=>Ne([1,2],[[1,2],[1,3]])),(()=>!1)),i.add(je,(()=>{let e=$([[1,2],[3,4]]),t=$([[5,6]]);return[je([e,t],0),je([e,t.T],1),je([e,t],null)]}),(()=>[$([[1,2],[3,4],[5,6]]),$([[1,2,5],[3,4,6]]),$([1,2,3,4,5,6])])),i.add(Ie,(()=>Ie(H([3,4,5]),0,-1).shape),(()=>[4,5,3])).add(Ie,(()=>Ie(H([3,4,5]),-1,0).shape),(()=>[5,3,4]));let Oe=e=>[...Array(e).keys()];function Ee(e){let t=Object.create(null);return(...r)=>((e,t,r)=>e[t]??(e[t]=r(...t)))(t,r,e)}function Se(e,t){let r=e;if(e=+e,!Number.isInteger(e))throw new Error(`${r} cannot be cast to integer`);if(e<0&&(e+=t),e<0||t<=e)throw`axis ${r} is out of bounds for array of dimension ${t}`;return e}let qe={};function Fe(e,t,r=!1){if(null==e)return qe[t]??(qe[t]=Array(t).fill(1));let n=Array(t).fill(0);if(Array.isArray(e)){for(let r=0;r<e.length;r++)n[Se(e[r],t)]=1;if(!r){let r=0;for(let e=0;e<t;e++)r+=n[e];if(r!=e.length)throw"repeated axis"}}else n[Se(e,t)]=1;return n}let Te=(e=null,t,r,n=t)=>{let a=[];for(let e=0;e<t.length;e++)a.push(n[e]==t[e]?`${n[e]}`:`${n[e]}: ${t[e]}`);return null!=e?`${e} {${a.join(", ")}} = ${r}`:`({${a.join(", ")}} = ${r})`},Pe=(e=null,t,r)=>{Array.isArray(t)||(t=[t],r=[r]);let n=[];for(let e=0;e<t.length;e++)n.push(`${t[e]} = ${r[e]}`);return null!=e?`${e} ${n.join(", ")}`:`${n.join(", ")}`},De=(e,t,r)=>`for(let ${e} = 0; ${e} < ${t}; ${e}++) {${r}}`,Le=(...e)=>`${e.join("; ")}`,Ve=(e,...t)=>`${e}(${t.join(", ")})`,Ye=(e,t)=>`${e}[${t}]`,Ge=(e,t)=>`${e}.${t}`,Je=e=>`(${e})`,Ue=(...e)=>`${e.map(Je).join(" * ")}`,Be=(...e)=>`${e.map(Je).join(" + ")}`,Ce=e=>`return ${e}`;function Xe(e,t,r=t){let n="out",a=Oe(e).map((e=>`x${e+1}`)),l=`${n}_offset`,i=a.map((e=>`${e}_offset`)),s=`${n}_data`,d=a.map((e=>`${e}_data`)),o=Oe(r).map((e=>`${n}_strides_${e}`)),u=a.map((e=>Oe(t).map((t=>`${e}_strides_${t}`)))),h=Oe(t).map((e=>`i_${e}`)),f=Oe(t).map((e=>`shape_${e}`));return{fn:"fn",out:n,x:a,out_offset:l,x_offset:i,out_data:s,x_data:d,out_strides:o,x_strides:u,index:h,shape:f}}function He(e,t,r,n){let a=[];return a.push(Pe("let",t,Ge(e,"data"))),a.push(Pe("let",r,Ge(e,"offset"))),n.length>0&&a.push(Te("let",n,Ge(e,"strides"),Oe(n.length))),a}let Ke=Ee(((e,t)=>new Function(...function(e,t){let{fn:r,out:n,x:a,out_offset:l,x_offset:i,out_data:s,x_data:d,out_strides:o,x_strides:u,index:h,shape:f}=Xe(e,t),p=[];return p.push(...He(n,s,l,o)),a.forEach(((e,t)=>{p.push(...He(e,d[t],i[t],u[t]))})),p.push(Te("let",f,Ge(a[0],"shape"),Oe(f.length))),p.push(Oe(t).reverse().reduce(((e,t)=>De(h[t],f[t],e)),Le(Pe(null,[Ye(s,Be(l,...h.map(((e,t)=>Ue(e,o[t])))))],[Ve(r,...d.map(((e,t)=>Ye(e,Be(i[t],...h.map(((e,r)=>Ue(e,u[t][r]))))))))]))),Ce(n)),[r,...a,n,Le(...p)]}(e,t)))),Qe=(Ee(((e,t)=>new Function)),Ee(((e,t,r)=>new Function(...function(e,t,r){let n=t;for(let e=0;e<t;e++)n-=r[e];let{fn:a,out:l,x:i,out_offset:s,x_offset:d,out_data:o,x_data:u,out_strides:h,x_strides:f,index:p,shape:c}=Xe(e,t,n),m="initial",g="accum",y=i.map((e=>`${e}_start`)),w=[];return w.push(...He(l,o,s,h)),i.forEach(((e,t)=>{w.push(...He(e,u[t],d[t],f[t]))})),w.push(Te("let",c,Ge(i[0],"shape"),Oe(c.length))),w.push(Oe(t).filter((e=>!r[e])).reverse().reduce(((e,t)=>De(p[t],c[t],e)),Le(Pe("let",g,m),...y.map(((e,n)=>Pe("let",e,Be(d[n],...Oe(t).filter((e=>!r[e])).map((e=>Ue(p[e],f[n][e]))))))),Oe(t).filter((e=>r[e])).reverse().reduce(((e,t)=>De(p[t],c[t],e)),Le([Pe(null,g,Ve(a,g,...u.map(((e,n)=>Ye(e,Be(y[n],...Oe(t).filter((e=>r[e])).map((e=>Ue(p[e],f[n][e])))))))))])),Pe(null,Ye(o,Be(s,...Oe(t).filter((e=>!r[e])).map(((e,t)=>Ue(p[e],h[t]))))),g))),Ce(l)),[a,...i,l,m,Le(...w)]}(e,t,r))))),Re=Ee(((e,t,r)=>new Function(...function(e,t,r){let n=t,{fn:a,out:l,x:i,out_offset:s,x_offset:d,out_data:o,x_data:u,out_strides:h,x_strides:f,index:p,shape:c}=Xe(e,t,n),m="initial",g="accum",y=i.map((e=>`${e}_start`)),w="offset_start",b=[];return b.push(...He(l,o,s,h)),i.forEach(((e,t)=>{b.push(...He(e,u[t],d[t],f[t]))})),b.push(Te("let",c,Ge(i[0],"shape"),Oe(c.length))),b.push(Oe(t).filter((e=>!r[e])).reverse().reduce(((e,t)=>De(p[t],c[t],e)),Le(Pe("let",g,m),...y.map(((e,n)=>Pe("let",e,Be(d[n],...Oe(t).filter((e=>!r[e])).map((e=>Ue(p[e],f[n][e]))))))),Pe("let",w,Be(s,...Oe(t).filter((e=>!r[e])).map((e=>Ue(p[e],h[e]))))),Oe(t).filter((e=>r[e])).reverse().reduce(((e,t)=>De(p[t],c[t],e)),Le([Pe(null,g,Ve(a,g,...u.map(((e,n)=>Ye(e,Be(y[n],...Oe(t).filter((e=>r[e])).map((e=>Ue(p[e],f[n][e]))))))))),Pe(null,Ye(o,Be(w,...Oe(t).filter((e=>r[e])).map(((e,t)=>Ue(p[e],h[e]))))),g)])))),Ce(l)),[a,...i,l,m,Le(...b)]}(e,t,r))));function We(e,t,r=t.length,n=!1){let a;if(1==r)a=n?(e,r=null,n=null)=>(e=S(e),null==r?r=q(e.shape):e=N(e,r.shape),Ke(1,r.ndim)(t.bind(null,n),e,r)):(e,r=null)=>(e=S(e),null==r?r=q(e.shape):e=N(e,r.shape),Ke(1,r.ndim)(t,e,r));else{if(2!=r)throw"not support on narg > 2 yet";a=(e,r,n=null)=>{let a;return e=S(e),r=S(r),null==n?(a=G(e.shape,r.shape),n=q(a)):a=n.shape,e=N(e,a),r=N(r,a),Ke(2,n.ndim)(t,e,r,n)}}return Object.defineProperty(a,"name",{value:e})}function Ze(e,t,r=!1){if(r){function n(e,r=null,n=null){return e=S(e),null==r?r=q(e.shape):e=N(e,r.shape),Ke(1,r.ndim)(t.bind(null,n),e,r)}return Object.defineProperty(n,"name",{value:e})}return Object.defineProperty((function(e,r=null){return e=S(e),null==r?r=q(e.shape):e=N(e,r.shape),Ke(1,r.ndim)(t,e,r)}),"name",{value:e})}function et(e,t){return Object.defineProperty((function(e,r,n=null){let a;return e=S(e),r=S(r),null==n?(a=G(e.shape,r.shape),n=q(a)):a=n.shape,e=N(e,a),r=N(r,a),Ke(2,n.ndim)(t,e,r,n)}),"name",{value:e})}function tt(e,t,r){return Object.defineProperty((function(e,n=null,a=null,l=r){e=S(e),null==n&&(e=xe(e));let{ndim:i,shape:s}=e;if(n=Fe(n,i),null==a)a=q(s);else if(!Ae(s,a.shape))throw"unmatch shape";return Re(1,i,n)(t,e,a,l),a}),"name",{value:e})}const rt=[];function nt(e,t,r=t.length-1,n){if(1!=r)throw"not support on narg > 1 yet";return Object.defineProperty((function(e,r=null,a=null,l=!1,i=n,s=!0){null!=a&&(s=!1),e=S(e);let d,{ndim:o,shape:u}=e;if(null==r)r=Fe(r,o),d=rt;else{r=Fe(r,o),d=[];for(let e=0;e<o;e++)r[e]||d.push(u[e])}if(l){let n=u.slice();for(let e=0;e<o;e++)r[e]&&(n[e]=1);if(null==a)a=q(n);else if(!Ae(n,a.shape))throw"unmatch shape";return Qe(1,o,r)(t,e,a.reshape(d),i),s&&0==a.ndim?a.item():a}if(null==a)a=q(d);else if(!Ae(d,a.shape))throw"unmatch shape";return a=Qe(1,o,r)(t,e,a,i),s&&0==a.ndim?a.item():a}),"name",{value:e})}const at=et("add",((e,t)=>e+t)),lt=et("subtract",((e,t)=>e-t)),it=et("multiply",((e,t)=>e*t)),st=et("divide",((e,t)=>e/t)),dt=st,ot=et("floor_divide",((e,t)=>e/t|0)),ut=et("mod",((e,t)=>(e%t+t)%t)),ht=ut,ft=et("power",((e,t)=>e**t));i.add(at,(()=>at(J(9).reshape([3,3]),J(3))),(()=>$([[0,2,4],[3,5,7],[6,8,10]]))),i.add(lt,(()=>lt(1,4)),(()=>-3)).add(lt,(()=>lt(J(9).reshape([3,3]),J(3))),(()=>$([[0,0,0],[3,3,3],[6,6,6]]))),i.add(it,(()=>it(2,4)),(()=>8)).add(lt,(()=>it(J(9).reshape([3,3]),J(3))),(()=>$([[0,1,4],[0,4,10],[0,7,16]]))),i.add(st,(()=>st(2,4)),(()=>.5)).add(st,(()=>st(J(9).reshape([3,3]),J(3))),(()=>$([[NaN,1,1],[1/0,4,2.5],[1/0,7,4]]))),i.add(ut,(()=>ut([4,7],[2,3])),(()=>$([0,1]))).add(ut,(()=>ut(J(7),5)),(()=>$([0,1,2,3,4,0,1]))),i.add(ft,(()=>ft(J(6),3)),(()=>$([0,1,8,27,64,125]))).add(ft,(()=>ft(J(6),[1,2,3,3,2,1])),(()=>$([0,1,8,27,16,5]))).add(ft,(()=>ft(J(6),$([[1,2,3,3,2,1],[1,2,3,3,2,1]]))),(()=>$([[0,1,8,27,16,5],[0,1,8,27,16,5]]))).add(ft,(()=>ft(J(6),$([1,2,3,3,2,1]))),(()=>$([0,1,8,27,16,5])));const pt=nt("all",((e,t)=>e&&!!t),1,!0),ct=nt("any",((e,t)=>e||!!t),1,!1),mt=Ze("isfinite",Number.isFinite),gt=Ze("isinf",(e=>e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)),yt=Ze("isinf",Number.isNaN),wt=Ze("isinf",(e=>e==Number.NEGATIVE_INFINITY)),bt=Ze("isinf",(e=>e==Number.POSITIVE_INFINITY));i.add(pt,(()=>0==pt([[!0,!1],[!0,!0]])),(()=>!0)).add(pt,(()=>pt([[!0,!1],[!0,!0]],0)),(()=>$([!0,!1]))).add(pt,(()=>pt([-1,4,5])),(()=>!0)).add(pt,(()=>{let e=$(!1);return[pt([-1,4,5],null,e)===e,e]}),(()=>[!0,$(!0)])),i.add(ct,(()=>ct([[!0,!1],[!0,!0]])),(()=>!0)).add(ct,(()=>ct([[!0,!1],[!1,!1]],0)),(()=>$([!0,!1]))).add(ct,(()=>ct([-1,0,5])),(()=>!0)).add(ct,(()=>ct(NaN)),(()=>!1));const xt=Math.E,_t=NaN,zt=Math.PI,vt=1/0,$t=-1/0,At=Ze("sin",Math.sin),Mt=Ze("cos",Math.cos),kt=Ze("tan",Math.tan),Nt=Ze("arcsin",Math.asin),jt=Ze("arccos",Math.acos),It=Ze("arctan",Math.atan),Ot=Ze("hypot",Math.hypot),Et=Ze("arctan2",Math.atan2),St=Ze("degrees",(e=>180*e/zt)),qt=Ze("radians",(e=>e/180*zt));function Ft(e,t=2*zt,r=t/2){if(1!=(e=S(e)).ndim)throw"unwrap currently only supports 1d arrays";let n=[e.data[e.offset]],a=e.data[e.offset],l=!0;for(let i of E(e.shape,e.strides)){if(l){l=!1;continue}let s=e.data[e.offset+i]-a;s>r?s-=t:s<-r&&(s+=t);let d=a+s;n.push(d),a=d}return S(n)}const Tt=Ze("rad2deg",(e=>180*e/zt)),Pt=Ze("deg2rad",(e=>e/180*zt)),Dt=Ze("sinh",Math.sinh),Lt=Ze("cosh",Math.cosh),Vt=Ze("tanh",Math.tanh),Yt=Ze("arcsinh",Math.asinh),Gt=Ze("arccosh",Math.acosh),Jt=Ze("arctanh",Math.atanh),Ut=Ze("_around",(({decimals:e},t)=>{let r=10**e,n=t*r,a=Math.round(n),l=n%1;return.5!=l&&-.5!=l||(a=a%2?a-1:a),a/r}),!0),Bt=function(e,t=0,r){return Ut(e,r,{decimals:t})},Ct=Ze("rint",(e=>{let t=e%1,r=Math.round(e);return.5!=t&&-.5!=t||(r=r%2?r-1:r),r})),Xt=Ze("fix",(e=>Math.sign(e)*Math.floor(Math.abs(e)))),Ht=Ze("floor",Math.floor),Kt=Ze("ceil",Math.ceil),Qt=Ze("trunc",Math.trunc),Rt=nt("prod",((e,t)=>e*t),1,1),Wt=nt("sum",((e,t)=>e+t),1,0),Zt=nt("nanprod",((e,t)=>e*(isNaN(t)?1:t)),1,1),er=nt("nansum",((e,t)=>e+(isNaN(t)?0:t)),1,0),tr=tt("cumprod",((e,t)=>e*t),1),rr=tt("cumsum",((e,t)=>e+t),0),nr=null,ar=null;function lr(e,t=1,r=-1){e=S(e);let{ndim:n}=e;r=Se(r,n);let a=Array(n).fill(u()),l=Array(n).fill(u());a[r]=u(1,null),l[r]=u(null,-1);for(let r=0;r<t;r++)e=lt(e.get(...a),e.get(...l));return e}function ir(e,t=null,r=null){if(e=lr(P(e,-1)),null!=r||null!=t){let n=[];null!=r&&n.push(r),n.push(e),null!=t&&n.push(t),e=je(n,null)}return e}const sr=Ze("exp",Math.exp,1),dr=Ze("expm1",(e=>Math.exp(e)-1)),or=Ze("exp2",(e=>2**e)),ur=Ze("log",Math.log),hr=Ze("log10",Math.log10),fr=Ze("log2",Math.log2),pr=Ze("log1p",Math.log1p),cr=et("logaddexp",((e,t)=>Math.log(Math.exp(e)+Math.exp(t)))),mr=et("logaddexp2",((e,t)=>Math.log2(2**e+2**t))),gr=Ze("signbit",(e=>e<0)),yr=et("copysign",((e,t)=>t<0?-Math.abs(e):Math.abs(e))),wr=et("ldexp",((e,t)=>e*2**t)),br=Ze("positive",(e=>+e)),xr=Ze("negative",(e=>-e));function _r(e,t){for(;0!=t;){let r=t;t=e%t,e=r}return e}const zr=et("lcm",(function(e,t){return e*t/_r(e,t)})),vr=et("gcd",_r),$r=Ze("reciprocal",(e=>1/e)),Ar=et("fmod",((e,t)=>e-(e/t|0)*t)),Mr=et("maximum",Math.max),kr=et("minimum",Math.min),Nr=nt("amax",Math.max,1,-vt),jr=nt("amin",Math.min,1,vt),Ir=Ze("sqrt",Math.sqrt),Or=Ze("cbrt",Math.cbrt),Er=Ze("square",(e=>e**2)),Sr=Ze("abs",Math.abs),qr=Sr,Fr=Ze("sign",Math.sign),Tr=Ze("nan_to_num",(e=>isNaN(e)?0:e==1/0?Number.MAX_VALUE:e==-1/0?Number.MIN_VALUE:e));i.add(Nr,(()=>Nr(J(4).reshape(2,2))),(()=>3)).add(Nr,(()=>Nr(J(4).reshape(2,2),0)),(()=>$([2,3]))).add(Nr,(()=>Nr(J(4).reshape(2,2),1)),(()=>$([1,3]))),i.add(Mr,(()=>Mr([2,3,4],[1,5,2])),(()=>$([2,5,4]))).add(Mr,(()=>Mr(ae(2),[.5,2])),(()=>$([[1,2],[.5,2]]))),i.add(Ar,(()=>Ar([-3,-2,-1,1,2,3],2)),(()=>$([-1,0,-1,1,0,1]))).add(Ar,(()=>ht([-3,-2,-1,1,2,3],2)),(()=>$([1,0,1,1,0,1]))),i.add(vr,(()=>vr(12,20)),(()=>4)).add(vr,(()=>vr(J(6),20)),(()=>$([20,1,2,1,4,5]))),i.add(zr,(()=>zr(12,20)),(()=>60)).add(zr,(()=>zr(J(6),20)),(()=>$([0,20,20,60,20,20]))),i.add(yr,(()=>yr(1.3,-1)),(()=>-1.3)).add(yr,(()=>1/yr(0,1)),(()=>1/0)).add(yr,(()=>1/yr(0,-1)),(()=>-1/0)),i.add(gr,(()=>gr(-1.2)),(()=>!0)).add(gr,(()=>gr($([1,-2.3,2.1]))),(()=>$([!1,!0,!1]))),i.add(cr,(()=>{let e=ur(1e-50),t=ur(2.5e-50);return cr(e,t)}),(()=>-113.87649168120691)),i.add(Ft,(()=>Ft([0,1,2,-1,0],4)),(()=>$([0,1,2,3,4]))).add(Ft,(()=>Ft([1,2,3,4,5,6,1,2,3],6)),(()=>$([1,2,3,4,5,6,7,8,9]))).add(Ft,(()=>Ft([2,3,4,5,2,3,4,5],4)),(()=>$([2,3,4,5,6,7,8,9]))),i.add(Bt,(()=>Bt([.37,1.64])),(()=>$([0,2]))).add(Bt,(()=>Bt([.37,1.64],1)),(()=>$([.4,1.6]))).add(Bt,(()=>Bt([.5,1.5,2.5,3.5,4.5])),(()=>$([0,2,2,4,4]))).add(Bt,(()=>Bt([5,15,25,35,45],-1)),(()=>$([0,20,20,40,40]))).add(Bt,(()=>Bt([-5,-15,-25,-35,-45],-1)),(()=>$([0,-20,-20,-40,-40]))).add(Bt,(()=>Bt([1,2,3,11],1)),(()=>$([1,2,3,11]))).add(Bt,(()=>Bt([1,2,3,11],-1)),(()=>$([0,0,0,10]))),i.add(Ct,(()=>Ct($([-1.7,-1.5,-.2,.2,1.5,1.7,2]))),(()=>$([-2,-2,-0,0,2,2,2]))),i.add(Xt,(()=>Xt(3.14)),(()=>3)).add(Xt,(()=>Xt(3)),(()=>3)).add(Xt,(()=>Xt([2.1,2.9,-2.1,-2.9])),(()=>$([2,2,-2,-2]))),i.add(Rt,(()=>Rt([])),(()=>1)).add(Rt,(()=>Rt([1,2])),(()=>2)).add(Rt,(()=>Rt($([[1,2],[3,4]]))),(()=>24)).add(Rt,(()=>Rt($([[1,2],[3,4]]),1)),(()=>$([2,12]))).add(Rt,(()=>Rt($([[1,2],[3,4]]),0)),(()=>$([3,8]))).add(Rt,(()=>Rt([1,2],null,null,null,5)),(()=>10)),i.add(Wt,(()=>Wt([.5,1.5])),(()=>2)).add(Wt,(()=>Wt([[0,1],[0,5]])),(()=>6)).add(Wt,(()=>Wt([[0,1],[0,5]],0)),(()=>$([0,6]))).add(Wt,(()=>Wt([[0,1],[0,5]],1)),(()=>$([1,5]))).add(Wt,(()=>Wt([10],null,null,null,5)),(()=>15)).add(Wt,(()=>Wt(J(100).reshape(5,-1,1).get(u("::-2"),u("2:7")),[0,-1])),(()=>$([126,129,132,135,138]))).add(Wt,(()=>{let e=J(100);return e=e.get(u(20,-20)).reshape([2,1,-1,2]).get(u("..."),u("::-1")),Wt(e,[1,-2],null,!0,-99)}),(()=>$([[[[426,411]]],[[[876,861]]]]))),i.add(Zt,(()=>Zt(1)),(()=>1)).add(Zt,(()=>Zt([1])),(()=>1)).add(Zt,(()=>Zt([1,_t])),(()=>1)).add(Zt,(()=>Zt($([[1,2],[3,_t]]))),(()=>6)).add(Zt,(()=>Zt($([[1,2],[3,_t]]),0)),(()=>$([3,2]))),i.add(er,(()=>er(1)),(()=>1)).add(er,(()=>er([1])),(()=>1)).add(er,(()=>er([1,_t])),(()=>1)).add(er,(()=>er($([[1,1],[1,_t]]))),(()=>3)).add(er,(()=>er($([[1,1],[1,_t]]),0)),(()=>$([2,1]))).add(er,(()=>er([1,_t,vt])),(()=>vt)).add(er,(()=>er([1,_t,$t])),(()=>-vt)),i.add(tr,(()=>tr($([1,2,3]))),(()=>$([1,2,6]))).add(tr,(()=>tr($([[1,2,3],[4,5,6]]))),(()=>$([1,2,6,24,120,720]))).add(tr,(()=>tr($([[1,2,3],[4,5,6]]),0)),(()=>$([[1,2,3],[4,10,18]]))).add(tr,(()=>tr($([[1,2,3],[4,5,6]]),1)),(()=>$([[1,2,6],[4,20,120]]))),i.add(rr,(()=>rr($([[1,2,3],[4,5,6]]))),(()=>$([1,3,6,10,15,21]))).add(rr,(()=>rr($([[1,2,3],[4,5,6]]),0)),(()=>$([[1,2,3],[5,7,9]]))).add(rr,(()=>rr($([[1,2,3],[4,5,6]]),1)),(()=>$([[1,3,6],[4,9,15]]))),i.add(lr,(()=>lr($([1,2,4,7,0]))),(()=>$([1,2,3,-7]))).add(lr,(()=>lr($([1,2,4,7,0]),2)),(()=>$([1,1,-10]))).add(lr,(()=>lr($([[1,3,6,10],[0,5,6,8]]))),(()=>$([[2,3,4],[5,1,2]]))).add(lr,(()=>lr($([[1,3,6,10],[0,5,6,8]]),1,0)),(()=>$([[-1,2,0,-2]]))),i.add(ir,(()=>ir($([1,2,4,7,0]))),(()=>$([1,2,3,-7]))).add(ir,(()=>ir($([1,2,4,7,0]),$([88,99]),-99)),(()=>$([-99,1,2,3,-7,88,99]))).add(ir,(()=>ir([[1,2,4],[1,6,24]])),(()=>$([1,2,-3,5,18]))),i.add(Sr,(()=>Sr($([-1.2,1.2]))),(()=>$([1.2,1.2]))),i.add(At,(()=>At(J(30).reshape(2,5,1,-1,1)).shape),(()=>$([[[[[0],[.8414709848078965],[.9092974268256817]]],[[[.1411200080598672],[-.7568024953079282],[-.9589242746631385]]],[[[-.27941549819892586],[.6569865987187891],[.9893582466233818]]],[[[.4121184852417566],[-.5440211108893698],[-.9999902065507035]]],[[[-.5365729180004349],[.4201670368266409],[.9906073556948704]]]],[[[[.6502878401571168],[-.2879033166650653],[-.9613974918795568]]],[[[-.7509872467716762],[.14987720966295234],[.9129452507276277]]],[[[.8366556385360561],[-.008851309290403876],[-.8462204041751706]]],[[[-.9055783620066238],[-.13235175009777303],[.7625584504796028]]],[[[.956375928404503],[.27090578830786904],[-.6636338842129675]]]]]).shape));const Pr=Ze("invert",(e=>~e)),Dr=Pr,Lr=et("bitwise_and",((e,t)=>e&t)),Vr=et("bitwise_or",((e,t)=>e|t)),Yr=et("bitwise_xor",((e,t)=>e^t)),Gr=et("left_shift",((e,t)=>e<<t)),Jr=et("right_shift",((e,t)=>e>>t));i.add(Pr,(()=>Pr([13])),(()=>$([-14]))),i.add(Lr,(()=>Lr(13,17)),(()=>1)).add(Lr,(()=>Lr([11,7],[4,25])),(()=>$([0,1]))).add(Lr,(()=>Lr($([2,5,255]),$([3,14,16]))),(()=>$([2,4,16]))).add(Lr,(()=>Lr([!0,!0],[!1,!0])),(()=>$([!1,!0]))),i.add(Vr,(()=>Vr([33,4],1)),(()=>$([33,5]))),i.add(Yr,(()=>{let e=[1,2,3],t=[4,5,6];return e=Yr(e,t),t=Yr(e,t),e=Yr(e,t),[e,t]}),(()=>[[4,5,6],[1,2,3]])),i.add(Gr,(()=>Gr(5,[1,2,3])),(()=>$([10,20,40]))),i.add(Jr,(()=>Jr(10,[1,2,3])),(()=>$([5,2,1])));const Ur=et("equal",((e,t)=>e==t)),Br=et("not_equal",((e,t)=>e!=t)),Cr=et("less_equal",((e,t)=>e<=t)),Xr=et("less_equal",((e,t)=>e<t)),Hr=et("less_equal",((e,t)=>e>=t)),Kr=et("less_equal",((e,t)=>e>t));function Qr(e,t,r=null,n=1){}function Rr(e,t,r=-1,n=r,a=r,l=r){e=S(e),t=S(t),n=Se(n,e.ndim),a=Se(a,t.ndim),e=Ie(e,n,-1),t=Ie(t,a,-1);let i=e.shape.at(-1),s=t.shape.at(-1);if(2!=i&&3!=i||2!=s&&3!=s)throw"incompatible dimensions for cross product (dimension must be 2 or 3)";let d=G(e.shape.slice(0,-1),t.shape.slice(0,-1));3!=e.shape.at(-1)&&3!=t.shape.at(-1)||(d=[...d,3],l=Se(l,d.length));let o,u,h,f,p,c,m,g,y,w=q(d);if(o=e.get("...",0),u=e.get("...",1),3==e.shape.at(-1)&&(h=e.get("...",2)),f=t.get("...",0),p=t.get("...",1),3==t.shape.at(-1)&&(c=t.get("...",2)),0!=w.ndim&&3==w.shape.at(-1)&&(m=w.get("...",0),g=w.get("...",1),y=w.get("...",2)),2==e.shape.at(-1)){if(2==t.shape.at(-1))return it(o,p,w),lt(w,it(u,f),w),w;if(3!=t.shape.at(-1))throw"b.shape.at(-1) != 3";it(u,c,m),it(o,c,g),xr(g,g),it(o,p,y),lt(y,it(u,f),y)}else{if(3!=e.shape.at(-1))throw"a.shape.at(-1) != 3";if(3==t.shape.at(-1)){it(u,c,m);let e=it(h,p);lt(m,e,m),it(h,f,g),it(o,c,e),lt(g,e,g),it(o,p,y),it(u,f,e),lt(y,e,y)}else{if(2!=t.shape.at(-1))throw"b.shape.at(-1) != 2";it(h,p,m),xr(m,m),it(h,f,g),it(o,p,y),lt(y,it(u,f),y)}}return Ie(w,-1,l)}function Wr(e,t=null,r=1,n=-1){e=S(e);let{ndim:a}=e;n=Se(n,a);let l=r;if(null!=t)if(1==(t=S(t)).ndim){l=lr(t);let e=Array(a).fill(1);e[n]=l.shape[0],l=l.reshape(e)}else l=lr(t,null,n);let i,s=Array(a).fill(u()),d=Array(a).fill(u());return s[n]=u(1,null),d[n]=u(null,-1),i=at(e.get(...s),e.get(...d)),it(l,i,i),st(i,2,i),Wt(i,n)}function Zr(e,t,r="full"){if(e=Z(e),t=Z(t),0==e.size)throw"a cannot be empty";if(0==t.size)throw"v cannot be empty";if(e.ndim>1||t.ndim>1)throw"object too deep for desired array";if(t.ndim>e.ndim){let r=e;e=t,t=r}let n=e.size;if("valid"==r)n+=1-t.size;else if("full"==r)n+=t.size-1;else if("same"!=r)throw`mode must be one of 'valid', 'same', or 'full' (got '${r}')`;let a=Array(n),l=0;if("valid"!=r)for(let r=0;r<t.size-1;r++){let n=0;for(let a=r+1,l=0;a--;l++)n+=e.item(l)*t.item(a);a[l++]=n}for(let r=0;r<e.size+1-t.size;r++){let n=0;for(let a=0,l=t.size-1;a<t.size;a++,l--)n+=e.item(r+a)*t.item(l);a[l++]=n}if("valid"!=r)for(let r=0;r<t.size-1;r++){let n=0;for(let a=0;a<t.size-1-r;a++)n+=e.item(e.size-t.size+1+r+a)*t.item(t.size-1-a);a[l++]=n}return"same"==r&&(a=a.slice((t.size-1)/2|0,((t.size-1)/2|0)+n)),new z([n],a)}function en(e,t,r,n=null){if(e=S(e),null==n)n=F(e);else if(!Ae(e.shape,n.shape))throw"out shape does not match input shape";if(h(t)&&h(r)){let a=E(e.shape,e.strides);for(let l of E(n.shape,n.strides))n.data[l]=Math.min(Math.max(t,e.data[a.next().value]),r);return n}t=N(t,e.shape),r=N(r,e.shape);let a=E(e.shape,e.strides),l=E(t.shape,t.strides),i=E(r.shape,r.strides);for(let s of E(n.shape,n.strides))n.data[s]=Math.min(Math.max(t.data[l.next().value],e.data[a.next().value]),r.data[i.next().value]);return n}function tn(e,t=-1,r=null){e=S(e),null==t?(e=xe(e),t=0):t=Se(t,e.ndim);let n=F(e),a=Array(e.shape[t]),l=Array(e.shape[t]),i=(e,t)=>a[e]-a[t],s=e.shape.slice();s[t]=1;for(let d of I(s)){let{offset:o}=e,{offset:u}=n;for(let t=0;t<s.length;t++)o+=d[t]*e.strides[t],u+=d[t]*n.strides[t];for(let n=0;n<e.shape[t];n++){let i=e.data[o+n*e.strides[t]];a[n]=null!=r?r(i):i,l[n]=n}l.sort(i);for(let r=0;r<e.shape[t];r++)n.data[u+r*n.strides[t]]=l[r]}return n}function rn(e,t=-1,r=null){e=S(e),null==t?(e=xe(e),t=0):t=Se(t,e.ndim);let n=F(e),a=Array(e.shape[t]),l=(e,t)=>e-t,i=e.shape.slice();i[t]=1;for(let s of I(i)){let{offset:d}=e,{offset:o}=n;for(let t=0;t<i.length;t++)d+=s[t]*e.strides[t],o+=s[t]*n.strides[t];for(let n=0;n<e.shape[t];n++){let l=e.data[d+n*e.strides[t]];a[n]=null!=r?r(l):l}a.sort(l);for(let r=0;r<e.shape[t];r++)n.data[o+r*n.strides[t]]=a[r]}return n}function nn(e,t,r,n=null,a=null,l=null){if([e,t,r]=[e,t,r].map(S),1!=t.ndim||1!=r.ndim)throw"Data points must be 1-D sequences";if(t.shape[0]!=r.shape[0])throw"fp and xp are not of the same length";if(null!=l){e=ut(e,l);let n=tn(t=ut(t,l));t=t.get(n),r=r.get(n),t=je([lt(t.get(u(-1)),l),t,at(t.get(u(0,1)),l)]),r=je([r.get(u(-1)),r,r.get(u(0,1))])}n??=r.item(0),a??=r.item(-1);let i=Array(e.size),s=0,d=t.item(0),o=t.item(-1);for(let l of e.flat){let e;if(l<d)e=n;else if(l>o)e=a;else{let n=1;for(;n<t.length&&l>t.item(n);n++);let a=t.item(n-1);if(l==a)e=r.item(n-1);else{let i=t.item(n);if(l==i)e=r.item(n);else{let t=r.item(n-1);e=(l-a)*(r.item(n)-t)/(i-a)+t}}}i[s++]=e}return new z(e.shape,i)}function an(e){let t=Array(e.length),r=t[0]=e[0];for(let n=1;n<e.length;n++)t[n]=r+=e[n];return t}function ln(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}function sn(e,t,r){let n=r()*t,a=e.length-1;for(let t=0;t<a;t++)if(n-=e[t],n<0)return t;return a}function dn(e,t,r){let n=r()*t,a=0,l=e.length-1;for(;a<l;){let t=a+l>>1;n>e[t]?a=t+1:l=t}return a}function on(e){let t=e.length,r=[],n=[],a=t/ln(e);e=e.map((e=>e*a));for(let a=0;a<t;a++)e[a]<1?r.push(a):n.push(a);let l=Array(t),i=Array(t);for(;r.length>0&&n.length>0;){let t=r.pop(),a=n.pop();l[t]=e[t],i[t]=a,e[a]=e[a]+e[t]-1,e[a]<1?r.push(a):n.push(a)}for(;n.length>0;)l[n.pop()]=1;for(;r.length>0;)l[r.pop()]=1;return{n:t,prob:l,alias:i}}function un(e,t,r,n){let a=n()*e|0;return n()<t[a]?a:r[a]}function hn(e){let t=e.length,r=Math.ceil(Math.log2(t)),n=1<<r,a=Array(2*n-1),l=n-1;for(let r=0;r<t;r++)a[l+r]=e[r];for(let e=t;e<n;e++)a[l+e]=0;let i=l;for(;n>1;){let e=i;i-=n>>=1;for(let t=0;t<n;t++)a[i+t]=a[e]+a[e+1],e+=2}return{tree:a,level:r,offset:l}}function fn(e,t,r,n){let a=n-e[r+=t];for(;r>=0;)e[r]+=a,r=r-1>>1}function pn(e,t,r,n){let a=n()*e[0],l=1;for(;--t;)a>e[l]&&(a-=e[l++]),l=2*l+1;return a>e[l]&&l++,l-r}function cn(e,t=null,r=!0,n="auto",a=Array(e),l=Math.random){let i=t.length;if(r||=1==e,r)switch("auto"==n&&(n=1==e||e*i<600?"linear":e>(i>100?2*i:50)?"alias":"binary"),n){case"linear":{let r=ln(t);for(let n=0;n<e;n++)a[n]=sn(t,r,l);break}case"binary":{let r=an(t),n=r.at(-1);for(let t=0;t<e;t++)a[t]=dn(r,n,l);break}case"alias":{let{n:r,prob:n,alias:i}=on(t);for(let t=0;t<e;t++)a[t]=un(r,n,i,l);break}case"sumtree":{let{tree:r,level:n,offset:i}=hn(t);for(let t=0;t<e;t++)a[t]=pn(r,n,i,l);break}default:throw`unexpected method '${n}'`}else{if(e>t)throw"size > p is not allowed when replace = true";switch("auto"==n&&(n=i+e<150?"linear":i+e<200?"binary":"sumtree"),n){case"linear":{let r=ln(t);t=t.slice();for(let n=0;n<e;n++){let e=a[n]=sn(t,r,l);r-=t[e],t[e]=0}break}case"binary":{let r=an(t),n=r.at(-1);for(let i=0;i<e;i++){let e=a[i]=dn(r,n,l),s=t[i];for(let t=e;t<r.length;t++)r[t]-=s;n-=s}break}case"alias":t=t.slice();for(let r=0;r<e;r++){let{n:e,prob:n,alias:i}=on(t);t[a[r]=un(e,n,i,l)]=0}break;case"sumtree":{let{tree:r,level:n,offset:i}=hn(t);for(let t=0;t<e;t++)fn(r,i,a[t]=pn(r,n,i,l),0);break}default:throw`unexpected method '${n}'`}}return a}function mn(e,t=null,r=!0,n=null){if(1!=(e="number"==typeof e?J(e):S(e)).ndim)throw"'p' must be 1-dimensional";if(0==e.size)throw"'a' cannot be empty unless no samples are taken";if(null==n)n=Array(e.size).fill(1/e.size);else{if(1!=(n=S(n)).ndim)throw"'p' must be 1-dimensional";if(n.size!=e.size)throw"'a' and 'p' must have same size";n=n.toarray()}if(e=e.toarray(),null==t)return e[cn(1,n)[0]];"number"==typeof t&&(t=[t]);let a=function(e){let t=1;for(let r of e)t*=r;return t}(t);if($e(n)<a)throw"Fewer non-zero entries in p than size";let l=cn(a,n,r).map((t=>e[t]));return new z(t,l)}function gn(e=null){if(null==e)return Math.random();"number"==typeof e&&(e=[e]);let t=function(e){let t=1;for(let r of e)t*=r;return t}(e),r=Array(t);for(let e=0;e<t;e++)r[e]=Math.random();return new z(e,r)}i.add(Ur,(()=>Ur([0,1,3],J(3))),(()=>$([!0,!0,!1]))).add(Ur,(()=>Ur(1,X(1))),(()=>$([!0]))).add(Ur,(()=>Ur($([2,4,6]),$([2,4,2]))),(()=>$([!0,!0,!1]))),i.add(Br,(()=>Br([1,2],[1,3])),(()=>$([!1,!0]))).add(Br,(()=>Br([1,2],[[1,3],[1,4]])),(()=>$([[!1,!0],[!1,!0]]))),i.add(Cr,(()=>Cr([4,2,1],[2,2,2])),(()=>$([!1,!0,!0]))),i.add(Xr,(()=>Xr([1,2],[2,2])),(()=>$([!0,!1]))),i.add(Hr,(()=>Hr([4,2,1],[2,2,2])),(()=>$([!0,!0,!1]))),i.add(Kr,(()=>Kr([4,2],[2,2])),(()=>$([!0,!1]))),i.add(Rr,(()=>Rr([1,2,3],[4,5,6])),(()=>$([-3,6,-3]))).add(Rr,(()=>Rr([1,2],[4,5,6])),(()=>$([12,-6,-3]))).add(Rr,(()=>Rr([1,2,0],[4,5,6])),(()=>$([12,-6,-3]))).add(Rr,(()=>Rr([1,2],[4,5])),(()=>$(-3))).add(Rr,(()=>Rr($([[1,2,3],[4,5,6]]),$([[4,5,6],[1,2,3]]))),(()=>$([[-3,6,-3],[3,-6,3]]))).add(Rr,(()=>Rr($([[1,2,3],[4,5,6]]),$([[4,5,6],[1,2,3]]),void 0,void 0,void 0,0)),(()=>$([[-3,3],[6,-6],[-3,3]]))).add(Rr,(()=>{let e=$([[1,2,3],[4,5,6],[7,8,9]]),t=$([[7,8,9],[4,5,6],[1,2,3]]);return[Rr(e,t),Rr(e,t,void 0,0,0)]}),(()=>[$([[-6,12,-6],[0,0,0],[6,-12,6]]),$([[-24,48,-24],[-30,60,-30],[-36,72,-36]])])),i.add(Wr,(()=>Wr([1,2,3])),(()=>4)).add(Wr,(()=>Wr([1,2,3],[4,6,8])),(()=>8)).add(Wr,(()=>Wr([1,2,3],null,2)),(()=>8)).add(Wr,(()=>Wr([1,2,3],[8,6,4])),(()=>-8)).add(Wr,(()=>Wr(J(6).reshape(2,3),void 0,void 0,0)),(()=>$([1.5,2.5,3.5]))).add(Wr,(()=>Wr(J(6).reshape(2,3),void 0,void 0,1)),(()=>$([2,8]))),i.add(Zr,(()=>Zr([1,2,3],[0,1,.5])),(()=>$([0,1,2.5,4,1.5]))).add(Zr,(()=>Zr([1,2,3],[1,.5],"full")),(()=>$([1,2.5,4,1.5]))).add(Zr,(()=>Zr([1,2,3],[0,1,.5],"same")),(()=>$([1,2.5,4]))).add(Zr,(()=>Zr([1,2,3],[0,1,.5],"valid")),(()=>$([2.5]))),i.add(en,(()=>en(J(10),1,8)),(()=>$([1,1,2,3,4,5,6,7,8,8]))).add(en,(()=>en(J(10),8,1)),(()=>$([1,1,1,1,1,1,1,1,1,1]))).add(en,(()=>{let e=J(10);return[en(e,3,6,e),e]}),(()=>[$([3,3,3,3,4,5,6,6,6,6]),$([3,3,3,3,4,5,6,6,6,6])])).add(en,(()=>en(J(10),[3,4,1,1,1,4,4,4,4,4],8)),(()=>$([3,4,2,3,4,5,6,7,8,8]))),tn($([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),0),i.add(tn,(()=>tn([3,1,2])),(()=>$([1,2,0]))).add(tn,(()=>tn($([[0,3],[2,2]]),0)),(()=>$([[0,1],[1,0]]))).add(tn,(()=>tn($([[0,3],[2,2]]),1)),(()=>$([[0,1],[0,1]]))).add(tn,(()=>tn($([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),0)),(()=>$([[[0,0],[0,1],[0,1]],[[1,1],[1,0],[1,0]]]))).add(tn,(()=>tn($([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),1)),(()=>$([[[0,1],[1,2],[2,0]],[[1,2],[2,1],[0,0]]]))).add(tn,(()=>tn($([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),2)),(()=>$([[[0,1],[0,1],[0,1]],[[1,0],[1,0],[1,0]]]))),i.add(rn,(()=>rn($([[1,4],[3,1]]))),(()=>$([[1,4],[1,3]]))).add(rn,(()=>rn($([[1,4],[3,1]]),null)),(()=>$([1,1,3,4]))).add(rn,(()=>rn($([[1,4],[3,1]]),0)),(()=>$([[1,1],[3,4]]))),i.add(nn,(()=>nn(2.5,[1,2,3],[3,2,0])),(()=>1)).add(nn,(()=>nn(4.5,[6,4,5],[3,2,0])),(()=>3)).add(nn,(()=>nn([0,1,1.5,2.5,3.14],[1,2,3],[3,2,0])),(()=>$([3,3,2.5,1,0]))).add(nn,(()=>nn([-180,-170,-185,185,-10,-5,0,365],[190,-190,350,-350],[5,10,3,4],null,null,360)),(()=>$([7.5,5,8.75,6.25,3,3.25,3.5,3.75])));const yn=gn,wn=gn;function bn(...e){return gn(e)}function xn(e){let t=1;for(let r of e)t*=r;return t}function _n(e,t=null,r=null,n=!0){if(null!=r){if(!K(r))throw"output array must be contiguous";null==t&&(t=r.shape)}let a;if(null==t){if(n)return e();a=[],t=1}else"number"==typeof t?a=[t]:(a=t,t=xn(a));if(null==r)r=q(a);else if(!Ae(a,r.shape))throw"size must match out.shape when used together";let{data:l,offset:i}=r;for(let r=0;r<t;r++)l[i+r]=e();return r}class zn{constructor(e=Math.random){this.rand=e}integers(e,t=null,r=null,n=!1){null==t&&(t=e,e=0);let a=t-e;return n&&(a+=1),_n((()=>this.rand()*a+e|0),r)}random(e=null,t=null){return _n((()=>this.rand()),e,t)}choice(e,t=null,r=!0,n=null,a=0){if("number"==typeof e){if(e<=0)throw"a must be a positive integer unless no samples are taken";e=J(e)}else if(0==(e=S(e)).size)throw"a cannot be empty unless no samples are taken";if(null==n)n=Array(e.shape[a]).fill(1/e.shape[a]);else{if(1!=(n=S(n)).ndim)throw"p must be 1-dimensional";if(n.size!=e.shape[a])throw"a and p must have same size";n=n.toarray()}let l=Array(a).fill(u());if(null==t)return l[a]=cn(1,n,void 0,void 0,void 0,this.rand)[0],e._getview(l).copy();let i=t;if("number"==typeof t&&(i=[t]),t=xn(i),n.length<t)throw"Cannot take a larger sample than population when replace is false";if($e(n)<t)throw"Fewer non-zero entries in p than size";let s=[...e.shape];s.splice(a,1,...i);let d=Array(a).fill(u()),o=q(s),h=cn(t,n,r,void 0,void 0,this.rand),f=0;for(let t of I(i)){for(let e=0;e<t.length;e++)d[a+e]=t[e];l[a]=h[f++],o.set(d,e._getview(l))}return o}shuffle(e,t=0){t=Se(t,(e=S(e)).ndim);let r=Array(t+1).fill(u(":")),{shape:n}=e,a=n[t],l=q([...n.slice(0,t),...n.slice(t+1)]);for(let n=0;n<a-2;n++){let i=this.rand()*(a-n)+n|0;r[t]=n;let s=e._getview(r);r[t]=i;let d=e._getview(r);l.set(s),s.set(d),d.set(l)}}permuted(e,t=null,r=null){t=Se(t,(e=S(e)).ndim);let n=[...e.shape];n[t]=1,null==r&&(r=F(e));for(let a of I(n)){a[t]=u();let n=e._getview(a).flatten();this.shuffle(n),r.set(a,n)}return r}permutation(e,t=0){return e="number"==typeof e?J(e):$(e),this.shuffle(e,t),e}uniform(e=0,t=1,r=null){return _n((()=>this.rand()*(t-e)+e),r)}normal(e=0,t=1,r=null){return _n((()=>{let r=this.rand(),n=this.rand(),a=Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*n);return e+t*a}),r)}}const vn=new zn;function $n(e,t=null,r=null){if(null==t&&null==r)return ge(e);let n=ne(e,t,r),a=q(n.shape),l=0;for(let[e,t,r]of n)a.data[l++]=e?t:r;return a}function An(...e){let t=[];for(let r=0;r<e.length;r++){let{start:n,stop:a,step:l,slicelength:i}=e[r]._get(),s=Array(i);for(let e=0;e<i;e++)s[e]=n+e*l;let d=Array(e.length).fill(1);d[r]=i,t.push(new z(d,s))}return t}function Mn(e,t=null,r=null,n=!1){e=S(e),null==t?(e=xe(e),t=0):t=Se(t,e.ndim);let a=[...e.shape.slice(0,t),...n?[1]:[],...e.shape.slice(t+1)];if(null==r)r=q(a);else if(!Ae(a,r.shape))throw"out must have the same shape as the expected output";return lt(Nr(e,t,null,n),jr(e,t,null,n),r),r}function kn(e,t=null,r=null,n=!1,a=!1){let l;if(e=S(e),null==t?(e=xe(e),t=0):t=Se(t,e.ndim),null!=r&&(r=S(r)),null!=r){if(l=Wt(r),0==l)throw"sum(weights) must not be 0";if(1==r.ndim)r=r.reshape([...Array(t).fill(1),e.shape[t]]);else if(!Ae(r.shape,e.shape))throw"weights.shape and a.shape do not match";e=it(e,r)}else l=e.shape[t];let i=st(Wt(e,t,null,a),l);return n?[i,l]:i}function Nn(e,t=null,r=null,n=!1){e=S(e),null==t?(e=xe(e),t=0):t=Se(t,e.ndim);let a=[...e.shape.slice(0,t),...n?[1]:[],...e.shape.slice(t+1)];if(null==r)r=q(a);else if(!Ae(a,r.shape))throw"out must have the same shape as the expected output";return st(Wt(e,t,null,n),e.shape[t],r),r}function jn(e,t=null,r=null,n=0,a=!1){e=S(e),null==t?(e=xe(e),t=0):t=Se(t,e.ndim);let l=[...e.shape.slice(0,t),...a?[1]:[],...e.shape.slice(t+1)];if(null==r)r=q(l);else if(!Ae(l,r.shape))throw"out must have the same shape as the expected output";return Nn(Er(lt(e,st(Wt(e,t,null,!0),e.shape[t]-n))),t,r,a),r}function In(e,t=null,r=null,n=0,a=!1){return r=jn(e,t,r,n,a),Ir(r,r),r}function On(e,t=null,r=0){if(1!=(e=S(e)).ndim)throw"a.dim != 1";if(jr(e)<0)throw"amin(a) < 0";if(r<0)throw"minlength < 0";if(null!=t){if(!Ae((t=S(t)).shape,e.shape))throw"weights.shape != a.shape";t=t.toarray()}let n=Array(Math.max(Nr(e)+1,r)).fill(0),a=0;for(let r of e.flat)n[r]+=null!=t?t[a]:1,a++;return new z([n.length],n)}function En(e,t=!1){let r,n=e.length,a=Array(n).fill(1);r=t?[]:q([n,...e]);for(let n=0;n<e.length;n++){let l=e[n],i=J(l).reshape([...a.slice(0,n),l,...a.slice(n+1)]);t?r.push(i):r.set([n],i)}return r}function Sn(...e){let t=[],r=e.length;for(let n=0;n<r;n++){let a=e[n];a=S(a),a.ndim,"boolean"==typeof a.item(0)&&([a]=ge(a)),a=a.reshape([...Array(n).fill(1),a.size,...Array(r-n-1).fill(1)]),t.push(a)}return t}function qn(e,t,r=!1,n=!1,a="table"){}function Fn(e,t=null,r="big"){e=S(e),null==t?(e=xe(e),t=0):t=Se(t,e.ndim);let n=e.shape.slice();n[t]=Math.ceil(n[t]/8);let a=q(n),l=e.shape.slice();l[t]=1;let i=Array(8*n[t]);for(let n of I(l)){let{offset:s}=e,{offset:d}=a;for(let t=0;t<l.length;t++)s+=n[t]*e.strides[t],d+=n[t]*a.strides[t];i.fill(0);for(let r=0;r<e.shape[t];r++){let n=e.data[s+r*e.strides[t]];i[r]=n}let o=0;for(let e=0;e<i.length;e+=8){let n=0;if("big"==r)for(let t=0;t<8;t++)n+=i[e+t]<<7-t;else{if("little"!=r)throw"bitorder can be either big or little";for(let t=0;t<8;t++)n+=i[e+t]<<t}a.data[d+o*a.strides[t]]=n,o++}}return a}function Tn(e,t=[],r="big"){if("big"==r)for(let r=7;r>=0;r--)t[r]=e%2,e=e/2|0;else for(let r=0;r<=7;r++)t[r]=e%2,e=e/2|0;return t}function Pn(e,t=null,r=null,n="big"){e=S(e),null==t?(e=xe(e),t=0):t=Se(t,e.ndim);let a=0,l=8;null!=r&&(r<0?a=8-r:l=r);let i=e.shape.slice();i[t]=i[t]*(l-a);let s=q(i),d=Array(8);for(let r of I(e.shape)){let{offset:i}=e,{offset:o}=s;for(let t=0;t<e.shape.length;t++)i+=r[t]*e.strides[t],o+=r[t]*s.strides[t];Tn(e.data[i],d,n);for(let e=a,r=0;e<l;e++,r++)s.data[o+r*s.strides[t]]=d[e]}return s}function Dn(e,t=0,r=null){if(0==(e=e.map(S)).length)throw"need at least one array to stack";for(let t=1;t<e.length;t++)if(!Ae(e[0],e[t]))throw"all input arrays must have the same shape";t=Se(t,e[0].ndim+1);let n=[...Array(t).fill(o.colon),o.newaxis];return je(e.map((e=>e.get(...n))),t,r)}function Ln(e){return e=ee(...e),Array.isArray(e)||(e=[e]),je(e,0)}function Vn(e){return e=Z(...e),Array.isArray(e)||(e=[e]),e.length>0&&1==e[0].ndim?je(e,0):je(e,1)}function Yn(e){return e=te(...e),Array.isArray(e)||(e=[e]),je(e,2)}function Gn(e){let t=[];for(let r of e)r=S(r),r.ndim<2&&(r=$(r,!1,2).T),t.push(r);return je(t,1)}function Jn(e){return e=ee(...e),Array.isArray(e)||(e=[e]),je(e,0)}function Un(e,t,r=0){let n,a,l;if(null!=e.shape?(r=Se(r,e.ndim),n=e.shape[r]):n=e.length,"number"==typeof t){if(a=0|t,a<=0)throw"number sections must be larger than 0.";let e=n/a|0,r=n%a;l=$([0,...Array(r).fill(e+1),...Array(a-r).fill(e)]).cumsum().toarray()}else a=t.length+1,l=[0,...t,n];let i=[],s=R(e,r,0);for(let e=0;e<a;e++){let t=l[e],n=l[e+1];i.push(R(s.get(u(t,n)),r,0))}return i}function Bn(e,t,r=0){if(r=Se(r,(e=S(e)).ndim),null!=t.shape&&(t=t.toarray()),null==t.length){let n=t;if(e.shape[r]%n)throw"array split does not result in an equal division"}return Un(e,t,r)}function Cn(e,t){if(ie(e)<3)throw"dsplit only works on arrays of 3 or more dimensions";return Bn(e,t,2)}function Xn(e,t){if(0==ie(e))throw"hsplit only works on arrays of 1 or more dimensions";return Bn(e,t,ie(e)>1?1:0)}function Hn(e,t){if(ie(e)<2)throw"vsplit only works on arrays of 2 or more dimensions";return Bn(e,t,0)}function Kn(e,t,r=null){e=S(e),null==r?(e=xe(e),r=0):r=Se(r,e.ndim);let n=e.shape.slice(),a="number"==typeof t;if(a)n[r]*=t;else if(1==t.length)t=t[0],n[r]*=t,a=!0;else{if(n[r]!=t.length)throw`operands could not be broadcast together with shape (${n[r]},) (${t.length},)`;n[r]=t.reduce(((e,t)=>e+t))}let l=q(n),i=l.strides.slice();i.splice(r,1);let s=e.shape.slice();s.splice(r,1);let d=e.strides.slice();d.splice(r,1);let o=n[r];for(let n of I(s)){let s=0,u=0;for(let e=0;e<n.length;e++)s+=n[e]*d[e],u+=n[e]*i[e];let h=0;for(let n=0;n<o;n++){let i=e.data[s+n*e.strides[r]],d=a?t:t[n];for(let e=0;e<d;e++,h++)l.data[u+h*l.strides[r]]=i}}return l}function Qn(e,t){"number"==typeof t&&(t=[t]);let r=t.length;if(t.every((e=>1==e))&&e instanceof z)return $(e,!0,r);let n=$(e,!1,r);r<n.ndim&&(t=[...Array(n.ndim-r).fill(1),...t]);let a=n.shape.map(((e,r)=>e*t[r])),l=n.size;if(l>0){let{ndim:e,shape:r}=n;for(let a=0;a<e;a++){let e=r[a],i=t[a];1!=i&&(n=n.reshape(-1,l).repeat(i,0)),l=l/e|0}}return n.reshape(a)}function Rn(e,t=0,r=0,n=1){e=S(e);let{ndim:a}=e;if(a<2)throw"array.ndim must be >= 2";r=Se(r,a),n=Se(n,a);let l=Array(a);l[a-2]=r,l[a-1]=n;for(let e=0,t=0;e<a;e++)e!=r&&e!=n&&(l[t++]=e);let i,s,d=(e=W(e,l)).shape[a-2],o=e.shape[a-1],u=o+1;t<0?(i=-o*t,s=Math.min(o,d+t)*(o+1)-o*t):(i=t,s=Math.min(d,o-t)*(o+1)+t);let h=Math.ceil((s-i)/u);return new z([...e.shape.slice(0,-2),h],e.data,e.base??e,[...e.strides.slice(0,-2),u*e.strides[a-1]],e.offset+i,e.itemsize)}function Wn(e,t=0){let r=(e=S(e)).shape;if(1==r.length){let n=r[0]+Math.abs(t),a=H([n,n]),l=t>=0?t:-t*n,i=a.get(u(null,n-t));for(let t=0;t<e.size;t++,l+=n+1)i.itemset(l,e.item(t));return a}if(2!=r.length)throw"Input must be 1- or 2-d.";return Rn(e,t)}function Zn(e,t=null){let r;if(e=S(e),null==t)r=Array(e.ndim).fill(u("::-1"));else{t=oe(t,e.ndim),r=Array(e.ndim).fill(u(":"));for(let e of t)r[e]=u("::-1")}return e.get(...r)}function ea(e){if((e=S(e)).ndim<2)throw"Input must be >= 2-d.";return e.get(...aa(":","::-1"))}function ta(e){if((e=S(e)).ndim<1)throw"Input must be >= 1-d.";return e.get(u("::-1"))}i.add($n,(()=>{let e=J(10);return $n(Xr(e,5),e,it(10,e))}),(()=>$([0,1,2,3,4,50,60,70,80,90]))).add($n,(()=>$n([[!0,!1],[!0,!0]],[[1,2],[3,4]],[[9,8],[7,6]])),(()=>$([[1,8],[3,4]]))).add($n,(()=>{let[e,t]=An(u(":3"),u(null,4));return $n(Xr(e,t),e,at(10,t))}),(()=>$([[10,0,0,0],[10,11,1,1],[10,11,12,2]]))).add($n,(()=>{let e=$([[0,1,2],[0,2,4],[0,3,6]]);return $n(Xr(e,4),e,-1)}),(()=>$([[0,1,2],[0,2,-1],[0,3,-1]]))),i.add(An,(()=>An(u("0:5"),u("0:5"))),(()=>[$([[0],[1],[2],[3],[4]]),$([[0,1,2,3,4]])])).add(An,(()=>An(u("3:5"),u("0:-5"),u("0:1"))),(()=>[$([[[3]],[[4]]]),$([]).reshape([1,0,1]),$([[[0]]])])),i.add(Mn,(()=>Mn($([[4,9,2,10],[6,9,7,12]]),1)),(()=>$([8,6]))).add(Mn,(()=>Mn($([[4,9,2,10],[6,9,7,12]]),0)),(()=>$([2,0,5,2]))).add(Mn,(()=>Mn($([[4,9,2,10],[6,9,7,12]]))),(()=>10)).add(Mn,(()=>Mn(ft(J(10,40),2).reshape(5,2,3),0,null,!0)),(()=>$([[[1056,1104,1152],[1200,1248,1296]]]))),i.add(kn,(()=>kn(J(1,5))),(()=>2.5)).add(kn,(()=>kn(J(1,11),void 0,J(10,0,-1))),(()=>4)).add(kn,(()=>kn(J(6).reshape(3,2),1,[1/4,3/4])),(()=>$([.75,2.75,4.75]))).add(kn,(()=>kn(J(6).reshape(3,2),1,void 0,void 0,!0)),(()=>$([[.5],[2.5],[4.5]]))),i.add(Nn,(()=>Nn($([[1,2],[3,4]]))),(()=>2.5)).add(Nn,(()=>Nn($([[1,2],[3,4]]),0)),(()=>$([2,3]))).add(Nn,(()=>Nn($([[1,2],[3,4]]),1)),(()=>$([1.5,3.5]))),i.add(jn,(()=>jn($([[1,2],[3,4]]))),(()=>1.25)).add(jn,(()=>jn($([[1,2],[3,4]]),0)),(()=>$([1,1]))).add(jn,(()=>jn($([[1,2],[3,4]]),1)),(()=>$([.25,.25]))),i.add(In,(()=>In($([[1,2],[3,4]]))),(()=>1.118033988749895)).add(In,(()=>In($([[1,2],[3,4]]),0)),(()=>$([1,1]))).add(In,(()=>In($([[1,2],[3,4]]),1)),(()=>$([.5,.5]))),i.add(On,(()=>On(J(5))),(()=>$([1,1,1,1,1]))).add(On,(()=>On($([0,1,1,3,2,1,7]))),(()=>$([1,3,1,1,0,0,0,1]))).add(On,(()=>On($([0,1,1,2,2,2]),$([.3,.5,.2,.7,1,-.6]))),(()=>$([.3,.7,1.1]))),i.add(En,(()=>En([2,3])),(()=>$([[[0,0,0],[1,1,1]],[[0,1,2],[0,1,2]]]))).add(En,(()=>En([2,3],!0)),(()=>[$([[0],[1]]),$([[0,1,2]])])),i.add(Sn,(()=>Sn([0,1],[2,4])),(()=>[$([[0],[1]]),$([[2,4]])])).add(Sn,(()=>Sn([!0,!0],[2,4])),(()=>[$([[0],[1]]),$([[2,4]])])).add(Sn,(()=>Sn([!0,!0],[!1,!1,!0,!1,!0])),(()=>[$([[0],[1]]),$([[2,4]])])),i.add(Fn,(()=>Fn($([[[1,0,1],[0,1,0]],[[1,1,0],[0,0,1]]]),-1)),(()=>$([[[160],[64]],[[192],[32]]]))).add(Fn,(()=>Fn($([[[1,0,1],[0,1,0]],[[1,1,0],[0,0,1]]]))),(()=>$([171,16]))).add(Fn,(()=>Fn($([[[1,0,1,0,0,0,0,0,0,0,0,0,0]]]),-1)),(()=>$([[[160,0]]]))),i.add(Pn,(()=>Pn($([[2],[7],[23]]),1)),(()=>$([[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,1,1],[0,0,0,1,0,1,1,1]]))).add(Pn,(()=>{let e=$([[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,1,1],[0,0,0,1,0,1,1,1]]),t=Fn(e,0);return[Pn(t,0),ke(e,Pn(t,0,e.shape[0]))]}),(()=>[$([[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,1,1],[0,0,0,1,0,1,1,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]),!0])),i.add(Dn,(()=>Dn(Array(10).fill().map((()=>vn.normal(0,1,[3,4]))),0).shape),(()=>[10,3,4])).add(Dn,(()=>Dn(Array(10).fill().map((()=>vn.normal(0,1,[3,4]))),1).shape),(()=>[3,10,4])).add(Dn,(()=>Dn(Array(10).fill().map((()=>vn.normal(0,1,[3,4]))),2).shape),(()=>[3,4,10])).add(Dn,(()=>Dn([$([1,2,3]),$([4,5,6])])),(()=>$([[1,2,3],[4,5,6]]))).add(Dn,(()=>Dn([$([1,2,3]),$([4,5,6])],-1)),(()=>$([[1,4],[2,5],[3,6]]))),i.add(Ln,(()=>Ln([$([1,2,3]),$([4,5,6])])),(()=>$([[1,2,3],[4,5,6]]))).add(Ln,(()=>Ln([$([[1],[2],[3]]),$([[4],[5],[6]])])),(()=>$([[1],[2],[3],[4],[5],[6]]))),i.add(Vn,(()=>Vn([$([1,2,3]),$([4,5,6])])),(()=>$([1,2,3,4,5,6]))).add(Vn,(()=>Vn([$([[1],[2],[3]]),$([[4],[5],[6]])])),(()=>$([[1,4],[2,5],[3,6]]))),i.add(Yn,(()=>Yn([$([1,2,3]),$([2,3,4])])),(()=>$([[[1,2],[2,3],[3,4]]]))).add(Yn,(()=>Yn([$([[1],[2],[3]]),$([[2],[3],[4]])])),(()=>$([[[1,2]],[[2,3]],[[3,4]]]))),i.add(Gn,(()=>Gn([$([1,2,3]),$([2,3,4])])),(()=>$([[1,2],[2,3],[3,4]]))),i.add(Jn,(()=>Jn([$([1,2,3]),$([4,5,6])])),(()=>$([[1,2,3],[4,5,6]]))).add(Jn,(()=>Jn([$([[1],[2],[3]]),$([[4],[5],[6]])])),(()=>$([[1],[2],[3],[4],[5],[6]]))),i.add(Un,(()=>Un(J(8),3)),(()=>[$([0,1,2]),$([3,4,5]),$([6,7])])).add(Un,(()=>Un(J(9),4)),(()=>[$([0,1,2]),$([3,4]),$([5,6]),$([7,8])])),i.add(Bn,(()=>Bn(J(9),3)),(()=>[$([0,1,2]),$([3,4,5]),$([6,7,8])])).add(Bn,(()=>Bn(J(8),[3,5,6,10])),(()=>[$([0,1,2]),$([3,4]),$([5]),$([6,7]),$([])])),i.add(Cn,(()=>Cn(J(16).reshape(2,2,4),2)),(()=>[$([[[0,1],[4,5]],[[8,9],[12,13]]]),$([[[2,3],[6,7]],[[10,11],[14,15]]])])).add(Cn,(()=>Cn(J(16).reshape(2,2,4),$([3,6]))),(()=>[$([[[0,1,2],[4,5,6]],[[8,9,10],[12,13,14]]]),$([[[3],[7]],[[11],[15]]]),q([2,2,0])])),i.add(Xn,(()=>Xn(J(16).reshape(4,4),2)),(()=>[$([[0,1],[4,5],[8,9],[12,13]]),$([[2,3],[6,7],[10,11],[14,15]])])).add(Xn,(()=>Xn(J(16).reshape(4,4),$([3,6]))),(()=>[$([[0,1,2],[4,5,6],[8,9,10],[12,13,14]]),$([[3],[7],[11],[15]]),q([4,0])])).add(Xn,(()=>Xn(J(8).reshape(2,2,2),2)),(()=>[$([[[0,1]],[[4,5]]]),$([[[2,3]],[[6,7]]])])).add(Xn,(()=>Xn($([0,1,2,3,4,5]),2)),(()=>[$([0,1,2]),$([3,4,5])])),i.add(Hn,(()=>Hn(J(16).reshape(4,4),2)),(()=>[$([[0,1,2,3],[4,5,6,7]]),$([[8,9,10,11],[12,13,14,15]])])).add(Hn,(()=>Hn(J(16).reshape(4,4),$([3,6]))),(()=>[$([[0,1,2,3],[4,5,6,7],[8,9,10,11]]),$([[12,13,14,15]]),q([0,4])])).add(Hn,(()=>Hn(J(8).reshape(2,2,2),2)),(()=>[$([[[0,1],[2,3]]]),$([[[4,5],[6,7]]])])),i.add(Kn,(()=>Kn(3,4)),(()=>$([3,3,3,3]))).add(Kn,(()=>Kn($([[1,2],[3,4]]),2)),(()=>$([1,1,2,2,3,3,4,4]))).add(Kn,(()=>Kn($([[1,2],[3,4]]),3,1)),(()=>$([[1,1,1,2,2,2],[3,3,3,4,4,4]]))).add(Kn,(()=>Kn($([[1,2],[3,4]]),[1,2],0)),(()=>$([[1,2],[3,4],[3,4]]))),i.add(Qn,(()=>{let e=$([0,1,2]);return[Qn(e,2),Qn(e,[2,2]),Qn(e,[2,1,2])]}),(()=>[$([0,1,2,0,1,2]),$([[0,1,2,0,1,2],[0,1,2,0,1,2]]),$([[[0,1,2,0,1,2]],[[0,1,2,0,1,2]]])])).add(Qn,(()=>{let e=$([[1,2],[3,4]]);return[Qn(e,2),Qn(e,[2,1])]}),(()=>[$([[1,2,1,2],[3,4,3,4]]),$([[1,2],[3,4],[1,2],[3,4]])])).add(Qn,(()=>Qn($([1,2,3,4]),[4,1])),(()=>$([[1,2,3,4],[1,2,3,4],[1,2,3,4],[1,2,3,4]]))),i.add(Rn,(()=>Rn(J(4).reshape(2,2))),(()=>$([0,3]))).add(Rn,(()=>Rn(J(4).reshape(2,2),1)),(()=>$([1]))).add(Rn,(()=>Rn(J(8).reshape(2,2,2),0,0,1)),(()=>$([[0,6],[1,7]]))).add(Rn,(()=>Rn(J(8).reshape(2,2,2).get(u(":"),u(":"),0),0,0,1)),(()=>$([0,6]))).add(Rn,(()=>Rn(J(8).reshape(2,2,2).get(u(":"),u(":"),1),0,0,1)),(()=>$([1,7]))).add(Rn,(()=>{let e=J(8);return Rn(e.reshape(2,2,2),0,0,1).set(-1),e}),(()=>$([-1,-1,2,3,4,5,-1,-1]))),i.add(Wn,(()=>Wn(J(9).reshape([3,3]))),(()=>$([0,4,8]))).add(Wn,(()=>Wn(J(9).reshape([3,3]),1)),(()=>$([1,5]))).add(Wn,(()=>Wn(J(9).reshape([3,3]),-1)),(()=>$([3,7]))).add(Wn,(()=>Wn(Wn(J(9).reshape([3,3])))),(()=>$([[0,0,0],[0,4,0],[0,0,8]]))),i.add(Zn,(()=>{let e=J(8).reshape([2,2,2]);return[e,Zn(e,0),Zn(e,1),Zn(e),Zn(e,[0,2])]}),(()=>[$([[[0,1],[2,3]],[[4,5],[6,7]]]),$([[[4,5],[6,7]],[[0,1],[2,3]]]),$([[[2,3],[0,1]],[[6,7],[4,5]]]),$([[[7,6],[5,4]],[[3,2],[1,0]]]),$([[[5,4],[7,6]],[[1,0],[3,2]]])])).add(Zn,(()=>{let e=vn.normal(0,1,[3,4,5]);return pt(Ur(Zn(e,2),e.get(u(":"),u(":"),u("::-1"),u("..."))))}),(()=>!0)),i.add(ea,(()=>ea(Wn([1,2,3]))),(()=>$([[0,0,1],[0,2,0],[3,0,0]]))).add(ea,(()=>{let e=vn.normal(0,1,[2,4,5]);return pt(Ur(ea(e),e.get(u(":"),u("::-1"),u("..."))))}),(()=>!0)),i.add(ta,(()=>ta(Wn([1,2,3]))),(()=>$([[0,0,3],[0,2,0],[1,0,0]]))).add(ta,(()=>{let e=vn.normal(0,1,[2,3,5]);return pt(Ur(ta(e),e.get(u("::-1"),u("..."))))}),(()=>!0)).add(ta,(()=>ta([1,2])),(()=>$([2,1])));let ra=e=>"number"==typeof e||e instanceof o?e:u(e);const na=Symbol("tupleType");function aa(...e){let t=e.map(ra);return t[na]=!0,t}function la(...e){return 1==e.length?ra(e[0]):aa(...e)}function ia(e,t,r,n){if("raise"==t)return function(e,t,r){let n=Array(e.length);for(let a=0;a<e.length;a++){let l=e[a];if(l<0&&(l+=t),l<0||l>=t)throw`index ${e[a]} is out of bounds for axis ${r} with size ${t}`;n[a]=l}return n}(e,r,n);if("wrap"==t)return function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let a=e[n]%t;a<0&&(a+=t),r[n]=a}return r}(e,r);if("clip"==t)return function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let a=e[n];r[n]=Math.max(0,Math.min(a,t-1))}return r}(e,r);throw`unexpected mode ${t}`}function sa(e,t,r,n="raise"){"number"==typeof t&&(t=[t]),"number"==typeof r&&(r=[r]),t=ia(t,n,e.size,0);let a=e.flat,l=r.length;for(let e=0;e<t.length;e++)a.set(t[e],r[e%l])}function da(e,t){"number"==typeof t&&(t=[t]),e=xe(e);let r=1;for(let e of t){if(e<0)throw"all elements of 'new_shape' must be non-negative";r*=e}if(0==e.size||0==r)return H(t);let n=Math.ceil(r/e.size);return P(e=je(Array(n).fill(e)).get(u(0,r)),t)}function oa(e,t){let r=0,n=e.length-1;for(;r<=n;){let a=r+n>>1;e[a]<t?r=a+1:n=a-1}return r}function ua(e,t){let r=0,n=e.length-1;for(;r<=n;){let a=r+n>>1;e[a]>t?n=a-1:r=a+1}return r}function ha(e,t,r="left"){e instanceof z&&(e=e.toarray());let n=F(t=S(t)),a=0,l="left"==r?oa:ua;for(let r of t.flat)n.data[a++]=l(e,r);return n}i.add(la,(()=>J(8).reshape(2,2,-1).get(la(0,[0,-1],"::-1"))),(()=>$([[1,0]]))),i.add(sa,(()=>{let e=J(5);return sa(e,[0,2],[-44,-55]),e}),(()=>$([-44,1,-55,3,4]))).add(sa,(()=>{let e=J(5);return sa(e,22,-5,"clip"),e}),(()=>$([0,1,2,3,-5]))),i.add(da,(()=>da($([[0,1],[2,3]]),[2,3])),(()=>$([[0,1,2],[3,0,1]]))).add(da,(()=>da($([[0,1],[2,3]]),[1,4])),(()=>$([[0,1,2,3]]))).add(da,(()=>da($([[0,1],[2,3]]),[2,4])),(()=>$([[0,1,2,3],[0,1,2,3]]))),i.add(ha,(()=>ha([1,2,3,4,5],3)),(()=>2)).add(ha,(()=>ha([1,2,3,4,5],3,"right")),(()=>3)).add(ha,(()=>ha([1,2,3,4,5],[-10,10,2,3])),(()=>$([0,5,1,2])));class fa{constructor(e){this.length=e.length,this.elements=e.map((e=>Array.from(e))),this.lengths=this.elements.map((e=>e.length)),this.size=this.lengths.reduce(((e,t)=>e*t)),this.coords=Array(this.length),this.done=this.index=void 0,this.reset()}[Symbol.iterator](){return this.reset()}reset(){return this.coords.fill(0),this.index=0,this.done=0==this.size,this}next(){if(this.done)return{done:!0};let{elements:e,coords:t,length:r,lengths:n}=this,a=e.map(((e,r)=>e[t[r]])),l=r-1,i=!0;e:for(;l>=0;)switch(n[l]){case 1:l--;break;case t[l]:t[l--]=0,i=!0;break;default:if(!i)break e;t[l]+=1,i=!1}return this.index++,this.done=this.index>=this.size,{value:a,done:!1}}}function pa(e,t,r=null){if(e=S(e),null==r)return pa(e.ravel(),t,0).reshape(e.shape);{let n=ne(t,r=oe(r,e.ndim,!0));if(n.ndim>1)throw new Error("'shift' and 'axis' should be scalars or 1D sequences");let a=Array(e.ndim).fill(0);for(let[e,t]of n)a[t]+=e;let l=Array(e.ndim).fill([[u(null),u(null)]]);for(let[t,r]of a.entries())r%=e.shape[t]||1,r&&(l[t]=[[u(null,-r),u(r,null)],[u(-r,null),u(null,r)]]);let i=F(e);for(let t of new fa(l)){let r=t.map((e=>e[0])),n=t.map((e=>e[1]));i.set(n,e.get(...r))}return i}}function ca(e,t,r=null){e=S(e);let{shape:n,strides:a,offset:l,data:i}=e,s=[];for(let e of E(n,a,l))s.push(t.call(r,i[e],e,i));return new z(n,s)}function ma(e,t,r=null){e=S(e),t=S(t),ga(e.ndim>0,"x1 does not have enough dimensions"),ga(t.ndim>0,"x2 does not have enough dimensions");let n=1==e.ndim,a=1==t.ndim,l=n||a;if(n&&(e=e.get(null,u(":"))),a&&(t=t.get(u(":"),null)),2==e.ndim&&2==t.ndim){ga(e.shape[1]==t.shape[0],"input shape mismatch");let i=[e.shape[0],t.shape[1]],s=l?i.slice(n?1:0,a?-1:void 0):i;null==r?r=q(s):ga(Ae(s,r.shape),"out shape mismatch");let d=l?r.reshape(i):r,o=t.T;for(let[t,r]of I(i))d.set([t,r],ya(e.get(t),o.get(r)));return r}let i=G(e.shape.slice(0,-2),t.shape.slice(0,-2));e=N(e,[...i,...e.shape.slice(-2)]),t=N(t,[...i,...t.shape.slice(-2)]),ga(e.shape.at(-1)==t.shape.at(-2),"input shape mismatch");let s=e.shape.at(-2),d=t.shape.at(-1),o=[...i,s,d];null==r?r=q(o):ga(Ae(o,r.shape),"out shape mismatch");for(let n of I(i))ma(e.get(...n),t.get(...n),r.get(...n));return r}function ga(e,t){if(!e)throw new Error(t)}function ya(e,t,r=null){if(e=S(e),t=S(t),1==e.ndim&&1==t.ndim)return Wt(it(e,t),0,r);if(2==e.ndim&&2==t.ndim)return ma(e,t,r);if(0==e.ndim||0==t.ndim)return it(e,t,r);if(1==t.ndim){ga(e.shape.at(-1)==t.shape[0],`shapes ${e.shape} and ${t.shape} not aligned`);let n=e.shape.slice(0,-1);null==r?r=q(n):ga(Ae(n,r.shape),"out shape mismatch");for(let a of I(n))ya(e.get(...a),t,r.get(u("..."),...a));return r}}i.add(pa,(()=>[...function*(){let e=J(10);yield pa(e,2),yield pa(e,-2);let t=e.reshape([2,5]);yield t,yield pa(t,1),yield pa(t,-1),yield pa(t,1,0),yield pa(t,-1,0),yield pa(t,1,1),yield pa(t,-1,1),yield pa(t,[1,1],[1,0]),yield pa(t,[2,1],[1,0])}()]),(()=>[...function*(){yield $([8,9,0,1,2,3,4,5,6,7]),yield $([2,3,4,5,6,7,8,9,0,1]),yield $([[0,1,2,3,4],[5,6,7,8,9]]),yield $([[9,0,1,2,3],[4,5,6,7,8]]),yield $([[1,2,3,4,5],[6,7,8,9,0]]),yield $([[5,6,7,8,9],[0,1,2,3,4]]),yield $([[5,6,7,8,9],[0,1,2,3,4]]),yield $([[4,0,1,2,3],[9,5,6,7,8]]),yield $([[1,2,3,4,0],[6,7,8,9,5]]),yield $([[9,5,6,7,8],[4,0,1,2,3]]),yield $([[8,9,5,6,7],[3,4,0,1,2]])}()])),i.add(ca,(()=>ca(J(10).reshape(-1,2),((e,t)=>e+t))),(()=>$([[0,2],[4,6],[8,10],[12,14],[16,18]]))),i.add(ma,(()=>ma($([[1,0],[0,1]]),$([[4,1],[2,2]]))),(()=>$([[4,1],[2,2]]))).add(ma,(()=>{let e=$([[1,0],[0,1]]),t=$([1,2]);return[ma(e,t),ma(t,e)]}),(()=>[$([1,2]),$([1,2])])).add(ma,(()=>ma(J(16).reshape([2,2,4]),J(16).reshape([2,4,2]))),(()=>$([[[28,34],[76,98]],[[428,466],[604,658]]]))),i.add(ya,(()=>ya(3,4)),(()=>12)).add(ya,(()=>ya([[1,2],[3,4]],[4,1])),(()=>$([6,16]))).add(ya,(()=>ya([[1,0],[0,1]],[[4,1],[2,2]])),(()=>$([[4,1],[2,2]])));let wa={edgeitems:3,threshold:1e3,linewidth:75,precision:void 0,formatter:null,separator:" ",prefix:""};function ba(e,t,r=[]){let n=r.length;if(n==e.ndim)return e.get(...r);if(e.shape[n]>2*t){let a=r.concat(aa([,t])),l=r.concat(aa([-t]));return je([ba(e,t,a),ba(e,t,l)],n)}return ba(e,t,r.concat(aa(":")))}class xa{get __call__(){return this.call.bind(null,this)}}class _a extends xa{constructor(e){super(),this.padLeft=e.size>0?Math.max(String(e.max()).length,String(e.min()).length):0}call({padLeft:e}=this,t){let r=String(t);return" ".repeat(e-r.length)+r}}function za(e,t){return e.toExponential(t)}function va(e,t){return null!=t?e.toFixed(t):String(e)}class $a extends xa{constructor(e,t=undefined){super(),this.precision=t;let r=!1;{let t=e.item(0),n=t,a=!1;for(let r of e.flat)Number.isFinite(r)&&0!=r&&(r=Math.abs(r),t=Math.min(t,r),n=Math.max(n,r),a=!0);a&&(n>=1e8||t<1e-4||n/t>1e3)&&(r=!0)}this.exp_format=r;let n=0;if(this.exp_format)for(let r of e.flat)n=Math.max(n,za(r,t).length);else for(let r of e.flat)n=Math.max(n,va(r,t).length);this.padLeft=n}call({padLeft:e,exp_format:t,precision:r}=this,n){let a=t?za(n,r):va(n,r);return" ".repeat(e-a.length)+a}}function Aa(e){return`${e}`}let Ma=e=>()=>e;function ka(e,t,r,n,a,l){let i=t.length+r.length>n;return l>113&&t.length<=a.length&&(i=!1),i&&(e+=t.trimEnd()+"\n",t=a),[e,t+=r]}function Na(e,t,r,n,a,l){let i=r.split(/\r?\n/);if(1===i.length||l<=113)return ka(e,t,r,n,a,l);let s,d=Math.max(...i.map((e=>e.length)));t.length+d>n&&t.length>a.length?(e+=t.trimEnd()+"\n",t=a+i[0],s=a):(s=" ".repeat(t.length),t+=i[0]);for(let r=1;r<i.length;r++)e+=t.trimEnd()+"\n",t=s+i[r];let o=d-i.at(-1).length;return[e,t+=" ".repeat(o)]}function ja(e,t=wa,r=" ",n=""){let a,l=S(e);0==e.ndim&&(e=l),e.size>t.threshold?(a="...",l=ba(l,t.edgeitems)):a="";let i=function(e,t){let r=function(e,t){let r={int:()=>new _a(e).__call__,float:()=>new $a(e,t.precision).__call__,object:()=>Aa},{formatter:n}=t;if(null!=n)for(let e of Object.keys(n))r[e]=Ma(n[e]);return r}(e,t);return r[Number.isInteger(e.item(0))?"int":"number"==typeof e.item(0)?"float":"object"](t)}(l,t),s=" "+" ".repeat(n.length),d=function(e,t,r,n,a,l,i,s){function d(r,n,o){let u=r.length,h=e.ndim-u;if(0===h)return t(e.item(r));let f,p=n+" ";f=s<=113?o:o-"]".length;let c,m,g=e.shape[u],y=i&&2*l<g;y?(c=l,m=l):(c=0,m=g);let w="";if(1===h){let e,t=a.trimEnd().length;e=s<=113?o-t:o-Math.max(t,"]".length);let l=n;for(let t=0;t<c;t++){let i=d([...r,t],p,f);[w,l]=Na(w,l,i,e,n,s),l+=a}y&&([w,l]=ka(w,l,i,e,n,s),l+=s<=113?", ":a);for(let t=m;t>1;t--){let i=d([...r,-t],p,f);[w,l]=Na(w,l,i,e,n,s),l+=a}s<=113&&(e=o);let u=d([...r,-1],p,f);[w,l]=Na(w,l,u,e,n,s),w+=l}else{w="";let e=a.trimEnd()+"\n".repeat(h-1);for(let t=0;t<c;t++)w+=n+d([...r,t],p,f)+e;y&&(w+=n+i,w+=s<=113?", \n":e);let t=m;for(;t>1;t--)w+=n+d([...r,-t],p,f)+e;w+=n+d([...r,-t],p,f)}return w="["+w.slice(n.length)+"]",w}try{return d([],n,r)}finally{d=null}}(e,i,t.linewidth,s,r,t.edgeitems,a,t.legacy);return d}function Ia(e,t=null){t=null!=t?Object.assign(Object.create(wa),t):wa;let{separator:r,prefix:n}=t;return 0==e.size?"[]":ja(e,t,r,n)}function Oa(e,t=null,r=null){return t??=wa.linewidth,r??=wa.precision,0==e.ndim?`${e.item()}`:Ia(e,{linewidth:t,precision:r})}function Ea(e,t=null,r=null){if(t??=wa.linewidth,r??=wa.precision,0==e.ndim)return`${e.item()}`;let n,a=e instanceof z?"array":typeof e,l=e.size>0,i=a+"(",s=l?")":",";n=e.size>0||Ae(e.shape,[0])?Ia(e,{linewidth:t,precision:r,separator:", ",prefix:i}):`[], shape=[${arr.shape.join(", ")}]`;let d=i+n+s;if(l)return d;let o=`dtype=${arr.dtype})`,u=" ";return d.length-(d.lastIndexOf("\n")+1)+o.length+1>t&&(u="\n"+" ".repeat((a+"(").length)),d+u+o}i.add(Ia,(()=>Ia(J(2520).reshape(3,4,210))),(()=>"[[[   0    1    2 ...  207  208  209]\n  [ 210  211  212 ...  417  418  419]\n  [ 420  421  422 ...  627  628  629]\n  [ 630  631  632 ...  837  838  839]]\n\n [[ 840  841  842 ... 1047 1048 1049]\n  [1050 1051 1052 ... 1257 1258 1259]\n  [1260 1261 1262 ... 1467 1468 1469]\n  [1470 1471 1472 ... 1677 1678 1679]]\n\n [[1680 1681 1682 ... 1887 1888 1889]\n  [1890 1891 1892 ... 2097 2098 2099]\n  [2100 2101 2102 ... 2307 2308 2309]\n  [2310 2311 2312 ... 2517 2518 2519]]]")).add(Ia,(()=>Ia($([.1,100,50,-9e3]))),(()=>"[ 1e-1  1e+2  5e+1 -9e+3]")).add(Ia,(()=>Ia($([1.1,100.2,50.6]))),(()=>"[  1.1 100.2  50.6]")),i.add(Ea,(()=>Ea($([1.1,100.2,50.6]))),(()=>"array([  1.1, 100.2,  50.6])")).add(Ea,(()=>""+$([1.1,100.2,50.6])),(()=>"array([  1.1, 100.2,  50.6])"))})(),nj=n})();