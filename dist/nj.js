var nj;(()=>{var e={460:()=>{}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var l=t[n]={exports:{}};return e[n](l,l.exports,r),l.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";function e(t,r){if(t==r)return!0;if(Array.isArray(t)&&Array.isArray(r)){if(t.length!=r.length)return!1;for(let n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}return Oe(t,r,!0)}function t(e){return e instanceof A&&(e=e.valueOf()),e}r.r(n),r.d(n,{Broadcast:()=>he,Dtype:()=>h,Flatiter:()=>Xa,Generator:()=>mn,NDArray:()=>A,NINF:()=>_t,NdenumerateIterator:()=>Ga,NdindexIterator:()=>U,Nditer:()=>je,NdoffsetIterator:()=>Va,Product:()=>la,Slice:()=>y,Tester:()=>l,_ndim:()=>me,_shape:()=>F,abs:()=>_r,absolute:()=>$r,accumulate_:()=>ga,add:()=>De,all:()=>ut,allclose:()=>nl,amax:()=>yr,amin:()=>gr,and:()=>nt,any:()=>ht,arange:()=>K,arccos:()=>Mt,arccosh:()=>Lt,arcsin:()=>zt,arcsinh:()=>Dt,arctan:()=>Nt,arctan2:()=>Et,arctanh:()=>Ut,argmax:()=>pl,argmin:()=>cl,argsort:()=>Kr,argwhere:()=>$e,around:()=>Vt,array:()=>E,array2string:()=>Na,array_equal:()=>Oe,array_equiv:()=>qe,array_repr:()=>Ea,array_split:()=>Pn,array_str:()=>ka,asarray:()=>V,ascontiguousarray:()=>ne,assert:()=>za,atleast_1d:()=>ie,atleast_2d:()=>de,atleast_3d:()=>oe,average:()=>xn,bincount:()=>An,bitwise_and:()=>zr,bitwise_not:()=>kr,bitwise_or:()=>Mr,bitwise_xor:()=>Nr,broadcast:()=>ue,broadcast_arrays:()=>P,broadcast_shapes:()=>J,broadcast_to:()=>T,cbrt:()=>br,ceil:()=>Gt,choice:()=>on,clip:()=>Jr,column_stack:()=>In,compile:()=>Ja,compress:()=>ve,concatenate:()=>Te,contiguous:()=>ae,convolve:()=>Hr,copy:()=>we,copysign:()=>or,copyto:()=>D,cos:()=>vt,cosh:()=>Tt,count_nonzero:()=>Ne,cross:()=>Gr,cumprod:()=>Ka,cumsum:()=>Qa,deg2rad:()=>Ft,degrees:()=>jt,diag:()=>Gn,diagonal:()=>Cn,diff:()=>Rt,divide:()=>Xe,divmod:()=>tt,dot:()=>Ma,dsplit:()=>Ln,dstack:()=>Fn,dtype:()=>p,dtype_:()=>c,e:()=>gt,ediff1d:()=>Yt,empty:()=>B,empty_like:()=>X,eq:()=>Dr,equal:()=>Or,exp:()=>Zt,exp2:()=>tr,expand_dims:()=>ye,expm1:()=>er,extract:()=>ze,eye:()=>fe,fix:()=>Xt,flatnonzero:()=>Me,flip:()=>Wn,fliplr:()=>Hn,flipud:()=>Jn,float_power:()=>Je,floor:()=>Ct,floor_divide:()=>He,fmod:()=>Ke,fromfunction:()=>be,fromiter:()=>xe,full:()=>W,full_like:()=>H,gcd:()=>pr,get:()=>hl,get_size:()=>M,get_strides:()=>z,gradient:()=>Cr,greater:()=>Tr,greater_equal:()=>Pr,gt:()=>Br,gte:()=>Xr,guessType:()=>S,hsplit:()=>Un,hstack:()=>qn,hypot:()=>kt,identity:()=>pe,in1d:()=>Nn,index_exp:()=>Rn,indices:()=>zn,inf:()=>xt,interp:()=>Rr,invert:()=>Er,isclose:()=>tl,isfinite:()=>ft,isinf:()=>pt,isnan:()=>ct,isneginf:()=>mt,isposinf:()=>yt,isscalar:()=>$,ix_:()=>Mn,lcm:()=>fr,ldexp:()=>ur,left_shift:()=>jr,less:()=>Fr,less_equal:()=>Ir,linspace:()=>Q,log:()=>rr,log10:()=>nr,log1p:()=>lr,log2:()=>ar,logaddexp:()=>sr,logaddexp2:()=>ir,logical_and:()=>rt,logical_not:()=>st,logical_or:()=>at,logical_xor:()=>dt,lt:()=>Ur,lte:()=>Vr,lu:()=>ll,lu_factor:()=>sl,lu_factor_:()=>il,lu_solve:()=>dl,map:()=>sa,map2_:()=>ma,map_:()=>ca,matmul:()=>Aa,maximum:()=>cr,mean:()=>_n,minimum:()=>mr,mod:()=>Qe,modf:()=>Re,moveaxis:()=>Pe,multiply:()=>Be,nan:()=>wt,nan_to_num:()=>Ar,nancumprod:()=>Ya,nancumsum:()=>el,nanprod:()=>Kt,nansum:()=>Qt,ndenumerate:()=>Ca,ndim:()=>ce,ndindex:()=>L,nditer:()=>Se,ndoffset:()=>Ba,negative:()=>Ve,neq:()=>Lr,nonzero:()=>_e,normalize_axes:()=>$a,normalize_axis:()=>ke,normalize_axis_index:()=>va,normalize_axis_tuple:()=>Ee,not:()=>it,not_equal:()=>qr,ogrid:()=>wn,ones:()=>Z,ones_like:()=>ee,or:()=>lt,packbits:()=>kn,pi:()=>bt,pick:()=>dn,positive:()=>Ue,power:()=>Ce,prod:()=>Ht,ptp:()=>bn,put:()=>Zn,rad2deg:()=>qt,radians:()=>St,rand:()=>pn,random:()=>yn,random_sample:()=>un,ranf:()=>hn,ravel:()=>Ae,ravel_multi_index:()=>Ha,reciprocal:()=>Le,reduce:()=>ia,reduce_:()=>ya,remainder:()=>et,repeat:()=>Bn,reshape:()=>G,resize:()=>ea,right_shift:()=>Sr,rint:()=>Bt,roll:()=>aa,row_stack:()=>Tn,s_:()=>Yn,sample:()=>fn,scatter:()=>ol,searchsorted:()=>ta,set:()=>fl,shallow_array_equal:()=>Fe,shape:()=>q,shape_:()=>I,sign:()=>vr,signbit:()=>dr,sin:()=>$t,sinh:()=>It,slice:()=>_,solve:()=>al,sort:()=>Qr,split:()=>Dn,sqrt:()=>wr,square:()=>xr,squeeze:()=>ge,stack:()=>Sn,std:()=>vn,subtract:()=>Ge,sum:()=>Jt,swapaxes:()=>le,take:()=>R,tan:()=>At,tanh:()=>Pt,tester:()=>s,tile:()=>Xn,timeit:()=>d,timeit2:()=>i,toArray:()=>v,transpose:()=>se,trapz:()=>Wr,true_divide:()=>We,trunc:()=>Wt,tupleType:()=>Qn,tuple_:()=>C,unique:()=>ml,unpackbits:()=>En,unravel_index:()=>Wa,unwrap:()=>Ot,variance:()=>$n,vsplit:()=>Vn,vstack:()=>On,where:()=>gn,wrapper_:()=>oa,wrapper_accumulate:()=>pa,wrapper_map:()=>ua,wrapper_map2:()=>ha,wrapper_reduce:()=>fa,xor:()=>ot,zeros:()=>te,zeros_like:()=>re});class l{compare=e;constructor(){this.tasks={},this._onload=[]}onload(e){this._onload.push(e)}add(e,t,r,n=this.compare){return"function"==typeof e&&(e=e.name),(this.tasks[e]??(this.tasks[e]=[])).push({test:t,expected:r,compare:n}),this}run(e){if(null==e){let e=!0;for(let t of Object.keys(this.tasks))e=this.run(t)&&e;let t=(e?"[32m":"[31m")+"%s[0m";return console.log(t,`Status: ${e}, Total: ${Object.keys(this.tasks).length}`),this._onload.forEach((e=>e())),e}let r=this.tasks[e];if(null==r)throw"no such name";let n=1,a=0,l=[];for(let e of r){let r,s,{test:i,expected:d,compare:o}=e,u=!1,h=!1;try{r=i()}catch(e){r=`[Error]: ${e}`,console.log(e),h=!0}try{s=d()}catch(e){s=`[Error]: ${e}`,console.log(e),h=!0}h||(u=o(r,s)),u&&a++;let f=(u?"[32m":"[31m")+"%s[0m";l.push([f,`#${n}: ${u?"passed":"fail"}`,"\nTest=\n",t(r),"\nExpected=\n",t(s)]),n++}let s=(a==r.length?"[32m":"[31m")+"%s[0m";if(console.log(s,`Testing ${e}: ${a} / ${r.length} cases passed`),a!=r.length)for(let e of l)console.log(...e);return a==r.length}}let s=new l;function i(e,t=1e3){let r,n=performance.now(),a=0;for(;e(),a++,r=performance.now(),!(r-n>=t););let l=a/((r-n)/t);console.log(`ops: ${l} per sec`,e)}function d(e,{name:t="test",setup:r=null,duration:n=1e3,warmup:a=100,cycle:l="auto",cycle_duration:s=100,repeat:i="auto",verbose:d=!1}={}){let o=r?.();if(s>n&&(s=n),"auto"==i&&(i=n/s|0),"auto"==l){let t,r=1;for(;;){let n=Date.now();for(let t=0;t<r;t++)e(o);if(t=Date.now()-n,t>s)break;r*=2}l=Math.max(r/t*(n/i)|0,1)}let u=[];for(let t=0;t<a;t++)e(o);for(let t=0;t<i;t++){let t=Date.now();for(let t=0;t<l;t++)e(o);let r=l/((Date.now()-t)/1e3);u.push(r)}let h=u.length,f=u.reduce(((e,t)=>e+t))/h;if(d){let e=Math.max(...u),r=Math.min(...u),n=Math.max(e-f,f-r);console.log(`#${t} ${0|f} Â± ${(n/f*100).toFixed(2)}% ops/sec (${i} runs)`)}return f}let o=e=>e,u=new WeakMap;class h{#e;constructor(e=o,t=Array,r=`${e}`){this.name=r,this.type=e,this.#e=t,u.set(e,r),u.set(t,r)}new(e,t=null){let r=new this.#e(e);if(null!=t)if(null!=r.set)r.set(t);else for(let e=0;e<t.length;e++)r[e]=t[e];return r}toString(){return`dtype('${this.name}')`}valueOf(){return this.type}}let f={int8:new h(Number,Int8Array,"int8"),uint8:new h(Number,Uint8Array,"uint8"),int16:new h(Number,Int16Array,"int16"),uint16:new h(Number,Uint16Array,"uint16"),int32:new h(Number,Int32Array,"int32"),uint32:new h(Number,Uint32Array,"uint32"),float32:new h(Number,Float32Array,"float32"),float64:new h(Number,Float64Array,"float64"),boolean:new h(Boolean,class extends Array{},"boolean"),number:new h(Number,class extends Array{},"number"),string:new h(String,class extends Array{},"string"),object:new h(o,Array,"object")};function p(e="object",t=undefined,r=undefined){if("string"==typeof e){if(!Object.hasOwn(f,e))throw new Error(`${e} is not supported`);return f[e]}return e instanceof h?e:u.has(e)?f[u.get(e)]:f[r]=new h(e,t,r)}Object.assign(f,{int:f.number,float:f.number});const c=p;s.add(p,(()=>p("number")),(()=>p("number"))).add(p,(()=>p(Number)),(()=>p("number"))).add(p,(()=>p(Int16Array)),(()=>p("int16")));var m=r(460);class y{static newaxis=null;static ellipsis=new y;static colon=new y;constructor(e,t,r){this.start=e,this.stop=t,this.step=r}indices(e=null){if(this==y.ellipsis)throw new Error("ellipsis does not support .indices()");let t,{start:r,stop:n,step:a}=this;if(a??=1,null==e){if(r??=0,null==n)throw new Error("stop must be non-null")}else null==r?r=a<0?e-1:0:(r<0&&(r+=e),r<0&&(r=a<0?-1:0),r>=e&&(r=a<0?e-1:e)),null==n?n=a<0?-1:e:(n<0&&(n+=e),n<0&&(n=a<0?-1:0),n>=e&&(n=a<0?e-1:e));return t=0==a||a<0&&n>=r||a>0&&r>=n?0:a<0?(n-r+1)/a+1|0:(n-r-1)/a+1|0,new g(r,n,a,t)}toString(){if(this==y.ellipsis)return"...";if(this==y.colon)return":";let{start:e,stop:t,step:r}=this,n=`${e??""}:${t??""}`;return null!=r&&(n+=`:${r}`),n}}y.prototype[m?.inspect?.custom]=function(){return this.toString()};class g{#t;#r;#n;constructor(e,t,r,n){this.start=e,this.stop=t,this.step=r,this.slicelength=n}[Symbol.iterator](){return this.reset(),this}reset(){let{start:e,slicelength:t}=this;this.#n=0,this.#r=0==t,this.#t=e}next(){if(this.#r)return{done:!0};let{step:e,slicelength:t}=this,r=this.#t;return this.#t+=e,this.#r=++this.#n>=t,{value:r,done:!1}}}let w=Object.assign(Object.create(null),{None:y.newaxis,"...":y.ellipsis,":":y.colon}),b=e=>0==(e=e.trim()).length?null:+e,x=(e,t)=>{if(null!=e&&!Number.isInteger(e=+e))throw new Error(`${t} must be either null or able to convert to integer`);return e};function _(e=null,t=null,r=null){if("string"==typeof e){if(Object.hasOwn(w,e))return w[e];let n=e.split(":");if(0==n.length||n.length>3)throw new Error(`invalid string slice representation ${e}`);e=b(n[0]),t=n.length>1?b(n[1]):null,r=n.length>2?b(n[2]):null}else e&&"object"==typeof e&&(null!=e[Symbol.iterator]?[e=null,t=null,r=null]=e:null!=e.length?({0:e=null,1:t=null,2:r=null}=e):({start:e=null,stop:t=null,step:r=null}=e));return null==e&&null==t&&null==r?y.colon:(e=x(e,"start"),t=x(t,"stop"),r=x(r,"step"),new y(e,t,r))}function $(e){switch(typeof e){case"boolean":case"function":case"number":case"string":return!0}return!1}function v(e){return e instanceof A?e.array():e}_.newaxis=y.newaxis,_.ellipsis=y.ellipsis,_.colon=y.colon,s.add(_,(()=>_(0,1,2).toString()),(()=>"0:1:2")).add(_,(()=>_(null,1,2).toString()),(()=>":1:2")).add(_,(()=>_(0,null,2).toString()),(()=>"0::2")).add(_,(()=>_(null,null,-1).toString()),(()=>"::-1")).add(_,(()=>_(null,null,null).toString()),(()=>":")),s.add("isscalar",(()=>$(3.1)),(()=>!0)).add("isscalar",(()=>$(E(3.1))),(()=>!1)).add("isscalar",(()=>$([3.1])),(()=>!1)).add("isscalar",(()=>$(!1)),(()=>!0)).add("isscalar",(()=>$("numpy")),(()=>!0)).add("isscalar",(()=>$(Number())),(()=>!0));class A{constructor(e,t=null,r=null,n=null,a=null,l=0,s=1){this.ndim=e.length,this.size=M(e),this.shape=e,this.data=t??Array(this.size),this.itemsize=s,this.strides=a??z(e,this.ndim,s),this.offset=l,this.dtype=c(r??t.constructor),this.base=n?.base??n}get length(){let{ndim:e,shape:t}=this;if(0!=e)return t[0]}get flat(){return new Xa(this)}set flat(e){this.flat.set(":",e)}get T(){return se(this)}set T(e){this.T.set(e)}toString(){return ka(this)}valueOf(){return 0==this.ndim?this.item():Ea(this)}*[Symbol.iterator](){for(let e=0;e<this.shape[0];e++)yield this.at(e)}as_strided(e=this.shape,t=this.strides,r=this.offset){let{data:n,dtype:a,base:l,itemsize:s}=this;return new A(e,n,a,l??this,t,r,s)}keys(){let{shape:e,strides:t,offset:r}=this;return Ba(e,t,r)}values(){return this.flat}idx(e){let{shape:t,strides:r,ndim:n,size:a,offset:l}=this;if(0==e)return l;if(null==e){if(1!=a)throw new Error("index cannot be empty if size != 1");return l}let s=function(e,t,r,n){if(Number.isInteger(e)){let a=e;if(a<0&&(a+=n),a<0||a>=n)throw new Error(`index ${e} out of bound for size ${n}`);if(0==r)return[0];let l=Array(r);for(let e=r-1;e>=0;e--)l[e]=a%t[e],a=a/t[e]|0;return l}if(e.length!=r)throw new Error("incorrect number of indices for array");return e}(e,t,n,a);for(let e=0;e<s.length;e++){let n=s[e],a=t[e];if(n<0&&(n+=a),n<0||n>=a)throw new Error(`index ${s[e]} out of bound for dimension ${a}`);l+=n*r[e]}return l}at(...e){return this.get(e)}slice(e=null,t=null){return this.at(_(e,t))}get(e,t=0){return N(e)?k(this,e,t):ol(this,e,t).get()}set(e,t){return 1==arguments.length?D(this,e):N(e)?D(k(this,e),t):ol(this,e).set(t),this}item(e){return this.data[this.idx(e)]}itemset(e,t){return this.data[this.idx(e)]=t,this}astype(e,t=!0){if(e=c(e),t||=this.dtype!=e,!t)return this;let{shape:r,size:n}=this,a=e.new(n,[...this.flat]);return new A(r,a,e)}array(){let{ndim:e}=this;if(0==e)return this.data[this.offset];let t,{shape:r,size:n}=this;if(0==n){if(1==e)return[];let n=1,a=0;for(let t;a<e&&(t=r[a]);a++)n*=t;e=a,t=Array.from({length:n},(()=>[]))}else t=[...this.flat];for(let n=e-1;n>0;n--){let e=r[n],a=[];for(let r=0;r<t.length;r+=e)a.push(t.slice(r,r+e));t=a}return t}toarray(){return this.array()}tolist(){return this.array()}reshape(...e){return 1==e.length&&"object"==typeof e[0]&&(e=e[0]),G(this,e)}add(e,t=null){return De(this,e,t)}sub(e,t=null){return Ge(this,e,t)}mul(e,t=null){return Be(this,e,t)}div(e,t=null){return Xe(this,e,t)}mod(e,t=null){return Qe(this,e,t)}all(e=null,t=null,r=!1,n=!0,a=!0){return ut(this,e,t,r,n,a)}any(e=null,t=null,r=!1,n=!1,a=!0){return ht(this,e,t,r,n,a)}argmax(e=null,t=null,r=!1){return pl(this,e,t,r)}argmin(e=null,t=null,r=!1){return cl(this,e,t,r)}argpartition(e,t=-1,r="introselect",n=null){throw"not implemented"}argsort(e=-1,t=null){return Kr(this,e,t)}byteswap(){throw"not implemented"}choose(e,t=null,r="raise"){throw"not implemented"}clip(e,t,r=null){return Jr(this,e,t,r)}compress(e,t=null,r=null){return ve(e,this,t,r)}conj(){throw"not implemented"}conjugate(){throw"not implemented"}copy(){return E(this)}cumprod(e,t){return Ka(this,e,t)}cumsum(e,t){return Qa(this,e,t)}diagonal(e=0,t=0,r=1){return Cn(this,e,t,r)}dump(){throw"not implemented"}dumps(){throw"not implemented"}fill(e){let{data:t,shape:r,strides:n,offset:a}=this;for(let l of Ba(r,n,a))t[l]=e;return this}flatten(){let{size:e,flat:t,dtype:r}=this;return new A([e],[...t],r)}getfield(){throw"not implemented"}max(e=null,t=null,r=!1,n=null,a=!0){return yr(this,e,t,r,n,a)}mean(e=null,t=null,r=!1){return _n(this,e,t,r)}min(e=null,t=null,r=!1,n=null,a=!0){return gr(this,e,t,r,n,a)}newbyteorder(){throw"not implemented"}nonzero(){return _e(this)}partition(e,t=-1,r="introselect",n=null){throw"not implemented"}prod(e=null,t=null,r=!1,n=0,a=!0){return Ht(this,e,t,r,n,a)}ptp(e=null,t=null,r=!1){return bn(this,e,t,r)}put(e,t,r="raise"){return Zn(this,e,t,r),this}ravel(){return Ae(this)}repeat(e,t=null){return Bn(this,e,t)}resize(e){if(null!=this.base)throw"cannot resize this array: it does not own its data";if(!ae(this))throw"resize only works on single-segment arrays";let t=M(e);return t<=this.size?this.data=[...this.data.slice(this.offset,t)]:this.data=[...this.data.slice(this.offset,t),...Array(t-this.size).fill(0)],this.shape=e,this.ndim=e.length,this.strides=z(e,this.ndim,this.itemsize),this.offset=0,this}round(e=0,t=null){return Vt(this,e,t)}searchsorted(e,t="left"){return ta(this,e,t)}setfield(){throw"not implemented"}setflags(){throw"not implemented"}sort(e=-1,t=null){return this.set(Qr(this,e,t)),this}squeeze(e=null){return ge(this,e)}std(e=null,t=null,r=0,n=!1){return vn(this,e,t,r,n)}sum(e=null,t=null,r=!1,n=0,a=!0){return Jt(this,e,t,r,n,a)}swapaxes(e,t){return le(this,e,t)}take(e,t=null,r=null,n="raise"){return R(this,e,t,r,n)}tobytes(){throw"not implemented"}tofile(){throw"not implemented"}trace(){throw"not implemented"}transpose(e=null){return se(this,e)}variance(e=null,t=null,r=0,n=!1){return $n(this,e,t,r,n)}}function z(e,t,r){if(0==t)return[];let n=Array(t);n[t-1]=r;for(let r=t-1;r>0;r--)n[r-1]=n[r]*e[r];return n}function M(e){let t=1;for(let r of e)t*=r;return t}function N(e){for(let t of e)if(null!=t&&"object"==typeof t&&null!=t.length)return!1;return!0}function k(e,t,r=0){let{ndim:n,shape:a,strides:l,offset:s}=e,i=0,d=-1;for(let e=0;e<t.length;e++){let r=t[e];if(r==y.ellipsis||"..."==r){if(-1!=d)throw new Error("can only have a single ellipsis '...'");d=e}else null==r&&i++}let o=0;if(-1!=d&&(o=n-r-(t.length-i-1)),r+(t.length-i-(-1!=d))>n)throw new Error("too many indices");let u=[],h=[];for(let e=0;e<r;e++)u.push(a[e]),h.push(l[e]);for(let e of t)if(null==e)u.push(1),h.push(0);else{if("string"==typeof e)e=_(e);else if(!(e instanceof y)){let t=e;if(e<0&&(e+=a[r]),e<0||e>a[r])throw new Error(`index ${t} out of bound for dimension size ${a[r]}`);s+=l[r]*e,r++;continue}if(e==y.ellipsis){for(let e=0;e<o;e++)u.push(a[r+e]),h.push(l[r+e]);r+=o}else if(e==y.colon)u.push(a[r]),h.push(l[r]),r++;else{let{start:t,step:n,slicelength:i}=e.indices(a[r]);s+=l[r]*t,u.push(i),h.push(l[r]*n),r++}}for(let e=r;e<n;e++)u.push(a[e]),h.push(l[e]);return e.as_strided(u,h,s)}function E(e,t=undefined,r=!0,n=0){if(e instanceof A){let{shape:a,ndim:l}=e;return l<n&&(a=Array(n-l).fill(1).concat(a),e=e.reshape(a)),e.astype(t??e.dtype,r)}let a=I(e),l=[];j(l,e,a,0);let s=a.length;return s<n&&(a=Array(n-s).fill(1).concat(a)),t=c(t??S(l)),new A(a,t.new(l.length,l),t)}function j(e,t,r,n=0){if(n<r.length)for(let a=0;a<r[n];a++)j(e,t.at(a),r,n+1);else"function"==typeof t?.toarray&&(t=t.toarray()),e.push(t)}function S(e){let t;if("object"==typeof e&&e?.[Symbol.iterator]){t=typeof e[0];for(let r of e)if(t!=typeof r){t="object";break}}else t=typeof e;return"number"==t||"string"==t||"boolean"==t?t:"object"}function O(e,t,r=0){for(let n=0;n<e.length&&r<t.length;n++){let a=e[n];if(null==a||"object"!=typeof a||a.length!=t[r]){t.length=r;break}if(a instanceof A){for(let e=r,n=0;e<t.length&&n<a.ndim;e++,n++)if(t[e]!=a.shape[n]){t.length=e;break}}else r+1<t.length&&O(a,t,r+1)}}function q(e){if(null==e||"object"!=typeof e)return[];if(null!=e.shape)return e.shape;let t=[],r=e;for(;;){if(r instanceof A)t.push(...r.shape);else if("object"==typeof r&&null!=r?.length){t.push(r.length),r=r[0];continue}break}return t.length>1&&O(e,t,1),t}A.prototype[m?.inspect?.custom]=function(){return this.valueOf()},s.onload((()=>{})),s.add("ndarray.get",(()=>K(120).reshape(4,6,5,1).at(E([0,2,1]),_(),[0,2,4],_())),(()=>E([[[0],[5],[10],[15],[20],[25]],[[62],[67],[72],[77],[82],[87]],[[34],[39],[44],[49],[54],[59]]]))).add("ndarray.get",(()=>K(120).reshape(4,6,5,1).at(E([0,2,1]),E([0,2,1]),_(),_())),(()=>E([[[0],[1],[2],[3],[4]],[[70],[71],[72],[73],[74]],[[35],[36],[37],[38],[39]]]))).add("ndarray.get",(()=>K(120).reshape(4,6,5,1).at(_(),E([0,2,1]),E([0,2,4]),_())),(()=>E([[[0],[12],[9]],[[30],[42],[39]],[[60],[72],[69]],[[90],[102],[99]]]))).add("ndarray.get",(()=>K(120).reshape(4,6,5,1).at(_(),E([0,2,1]),_(),[0,0,0])),(()=>E([[[0,1,2,3,4],[30,31,32,33,34],[60,61,62,63,64],[90,91,92,93,94]],[[10,11,12,13,14],[40,41,42,43,44],[70,71,72,73,74],[100,101,102,103,104]],[[5,6,7,8,9],[35,36,37,38,39],[65,66,67,68,69],[95,96,97,98,99]]]))).add("ndarray.get",(()=>K(120).reshape(4,6,5,1).at(_(),_(),E([0,2,1]),E([0,0,0]))),(()=>E([[[0,2,1],[5,7,6],[10,12,11],[15,17,16],[20,22,21],[25,27,26]],[[30,32,31],[35,37,36],[40,42,41],[45,47,46],[50,52,51],[55,57,56]],[[60,62,61],[65,67,66],[70,72,71],[75,77,76],[80,82,81],[85,87,86]],[[90,92,91],[95,97,96],[100,102,101],[105,107,106],[110,112,111],[115,117,116]]]))).add("ndarray.get",(()=>K(120).reshape(4,6,5,1).at(E([0,2,1]),_(),_(),E([0,0,0]))),(()=>E([[[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19],[20,21,22,23,24],[25,26,27,28,29]],[[60,61,62,63,64],[65,66,67,68,69],[70,71,72,73,74],[75,76,77,78,79],[80,81,82,83,84],[85,86,87,88,89]],[[30,31,32,33,34],[35,36,37,38,39],[40,41,42,43,44],[45,46,47,48,49],[50,51,52,53,54],[55,56,57,58,59]]]))).add("ndarray.get",(()=>K(120).reshape(4,6,5,1).at(E([0,2,1]),E([0,2,1]),_(),0)),(()=>E([[0,1,2,3,4],[70,71,72,73,74],[35,36,37,38,39]]))).add("ndarray.get",(()=>K(120).reshape(4,6,5,1).at(E([0,2,1]),_(),_(),0)),(()=>E([[[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19],[20,21,22,23,24],[25,26,27,28,29]],[[60,61,62,63,64],[65,66,67,68,69],[70,71,72,73,74],[75,76,77,78,79],[80,81,82,83,84],[85,86,87,88,89]],[[30,31,32,33,34],[35,36,37,38,39],[40,41,42,43,44],[45,46,47,48,49],[50,51,52,53,54],[55,56,57,58,59]]]))).add("ndarray.get",(()=>new A([2,5],[...Array(10).keys()]).at(_(),_([,,-1]))),(()=>[[4,3,2,1,0],[9,8,7,6,5]])).add("ndarray.get",(()=>new A([2,5],[...Array(10).keys()]).at(_(-1),3)),(()=>[8])).add("ndarray.get",(()=>new A([2,5],[...Array(10).keys()]).at(_([,,-1]),_([,,-1]))),(()=>[[9,8,7,6,5],[4,3,2,1,0]])).add("ndarray.get",(()=>{let e;return e=E([[3,0,0],[0,4,0],[5,6,0]]).at(_(),_(),null),e}),(()=>E([[[3],[0],[0]],[[0],[4],[0]],[[5],[6],[0]]]))).add("ndarray.get",(()=>{let e;return e=E([[3,0,0],[0,4,0],[5,6,0]]).at(_("..."),null),e}),(()=>E([[[3],[0],[0]],[[0],[4],[0]],[[5],[6],[0]]]))).add("ndarray.get",(()=>K(24).reshape(2,3,4).at(null,"...",null)),(()=>E([[[[[0],[1],[2],[3]],[[4],[5],[6],[7]],[[8],[9],[10],[11]]],[[[12],[13],[14],[15]],[[16],[17],[18],[19]],[[20],[21],[22],[23]]]]]))).add("ndarray.get",(()=>K(24).reshape(2,3,4).at(_(":"),[0,2],_("::2"))),(()=>E([[[0,2],[8,10]],[[12,14],[20,22]]]))).add("ndarray.get",(()=>K(24).reshape(2,3,4).at([1,0],0).shape),(()=>[2,4])),s.add("ndarray.item",(()=>new A([2,5],[...Array(10).keys()]).at(_([,,-1]),_([,,-1])).item(5)),(()=>4)),s.add("ndarray.itemset",(()=>{let e=new A([3,3],[[2,2,6],[1,3,6],[1,0,1]].flat());return e.itemset(4,0),e.itemset([2,2],9),e}),(()=>[[2,2,6],[1,0,6],[1,0,9]])),s.add("ndarray.array",(()=>E(1).array()),(()=>1)).add("ndarray.array",(()=>E([1]).array()),(()=>[1])).add("ndarray.array",(()=>E([]).array()),(()=>[])).add("ndarray.array",(()=>E([[[]]]).array()),(()=>[[[]]])).add("ndarray.array",(()=>E([[],[],[]]).array()),(()=>[[],[],[]])).add("ndarray.array",(()=>Z([2,3,0,2,1]).array()),(()=>[[[],[],[]],[[],[],[]]])),s.add("ndarray.set",(()=>{let e=new A([2,5],[...Array(10).keys()]);return e.at(_(),_(1,-1)).set(10),e}),(()=>[[0,10,10,10,4],[5,10,10,10,9]])).add("ndarray.set",(()=>{let e=K(24).reshape(2,3,4);return e.set([Pr(e,10)],-1),e}),(()=>E([[[0,1,2,3],[4,5,6,7],[8,9,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]]))).add("ndarray.set",(()=>{let e=K(24).reshape(2,3,4);return e.set([":",[!0,!1,!0]],[-1,-2,-3,-4]),e}),(()=>E([[[-1,-2,-3,-4],[4,5,6,7],[-1,-2,-3,-4]],[[-1,-2,-3,-4],[16,17,18,19],[-1,-2,-3,-4]]]))).add("ndarray.set",(()=>{let e=K(24).reshape(2,3,4);return e.set([":",[[!0,!1,!0,!1],[!1,!1,!0,!0],[!1,!0,!0,!0]]],[1,2,3,4,5,6,7]),e}),(()=>E([[[1,1,2,3],[4,5,3,4],[8,5,6,7]],[[1,13,2,15],[16,17,3,4],[20,5,6,7]]]))).add("ndarray.set",(()=>{let e=K(24).reshape(2,3,4);return e.set([":",[[!0,!1,!0,!1],[!1,!1,!0,!0],[!1,!0,!0,!0]]],-1),e}),(()=>E([[[-1,1,-1,3],[4,5,-1,-1],[8,-1,-1,-1]],[[-1,13,-1,15],[16,17,-1,-1],[20,-1,-1,-1]]]))),s.add("ndarray.flatten",(()=>E([[1,2],[3,4]]).flatten()),(()=>E([1,2,3,4]))),s.add("ndarray.flat.set",(()=>{let e=E([[1,2,3],[4,5,6]]);return e.flat=3,e}),(()=>E([[3,3,3],[3,3,3]]))).add("ndarray.flat.set",(()=>{let e=E([[1,2,3],[4,5,6]]);return e.flat=[7,8,9,10],e}),(()=>E([[7,8,9],[10,7,8]]))),s.add("ndarray.copy",(()=>{let e=E([[1,2,3]]);return e.copy()==e}),(()=>!1)).add("ndarray.copy",(()=>{let e=E([[1,2,3]]),t=e.copy();return t.itemset(0,-1),[e,t]}),(()=>[E([[1,2,3]]),E([[-1,2,3]])])),s.add("ndarray.resize",(()=>{let e=E([[0,1],[2,3]]);return e.resize([2,1]),e}),(()=>E([[0],[1]]))).add("ndarray.resize",(()=>{let e=E([[0,1],[2,3]]);return e.resize([2,3]),e}),(()=>E([[0,1,2],[3,0,0]]))).add("ndarray.resize",(()=>{let e=E([[0,1],[2,3]]),t=e;return e.resize([1,1]),[e,t]}),(()=>[E([[0]]),E([[0]])])),s.add("array",(()=>E([3.1,9])),(()=>[3.1,9])).add("array",(()=>E([[9,6],3.1,9]).shape),(()=>[3])).add("array",(()=>E(5)),(()=>5));const F=q,I=q;function T(e,t){e=V(e);let{strides:r,ndim:n}=e;if(n>t.length)throw new Error("broadcast shape has less dimensions than input array");let a=[];for(let n=t.length-1,l=e.shape.length-1;n>=0;n--,l--){if(l>=0&&1!=e.shape[l]&&e.shape[l]!=t[n])throw new Error("operands could not be broadcast together");a[n]=l<0||1==e.shape[l]?0:r[l]}return e.as_strided(t,a)}function P(...e){let t=J(...(e=e.map((e=>V(e)))).map((e=>e.shape)));return e.map((e=>T(e,t)))}function D(e,t){if(1==(t=V(t)).size)e.fill(t.item());else{let r=T(t,e.shape).flat[Symbol.iterator](),{data:n,shape:a,strides:l,offset:s}=e;for(let e of Ba(a,l,s))n[e]=r.next().value}}function L(e){return new U(e)}s.add("shape",(()=>q([[[3,9]],[[3,9,3]],[[3,9]]])),(()=>[3,1])).add("shape",(()=>q([1,2,3,[1,3]])),(()=>[4])).add("shape",(()=>q([0])),(()=>[1])).add("shape",(()=>q(0)),(()=>[])).add("shape",(()=>q([K(24).reshape(1,2,3,4),K(24).reshape(1,2,12),K(24).reshape(1,2,12)])),(()=>[3,1,2])).add("shape",(()=>q([K(24).reshape(1,2,3,4),K(24).reshape(1,2,3,4),K(24).reshape(1,2,3,4)])),(()=>[3,1,2,3,4])),s.add("broadcast_to",(()=>T(E([1,2,3]).reshape(3),[3,3]).array()),(()=>[[1,2,3],[1,2,3],[1,2,3]])),s.add("broadcast_to",(()=>T(E([1,2,3]).reshape(1,3,1),[2,3,4]).array()),(()=>[[[1,1,1,1],[2,2,2,2],[3,3,3,3]],[[1,1,1,1],[2,2,2,2],[3,3,3,3]]])),s.add("copyto",(()=>{let e=V([4,5,6]);return D(e,[1,2,3]),e}),(()=>[1,2,3])).add("copyto",(()=>{let e=V([[1,2,3],[4,5,6]]);return D(e,[[4,5,6],[7,8,9]]),e}),(()=>[[4,5,6],[7,8,9]])).add("copyto",(()=>{let e=V([[0,1,2],[3,4,5]]);return D(e.at(_(),1),[-1,-2]),e}),(()=>[[0,-1,2],[3,-2,5]]));class U{constructor(e){this.ndim=e.length,this.size=M(e),this.shape=e,this.coords=Array(this.ndim),this.index,this.done,this[Symbol.iterator]()}[Symbol.iterator](){return this.coords.fill(0),this.index=0,this.done=0==this.size,this}next(){if(this.done)return{done:!0};let{coords:e,size:t,index:r}=this;if(0!=r){let{shape:t,ndim:r}=this,n=r-1,a=!0;for(;n>=0;){let r=t[n];if(1==r)n--;else if(r==e[n])e[n--]=0,a=!0;else{if(!a)break;e[n]++,a=!1}}}return this.done=++this.index>=t,{value:e,done:!1}}}function V(e,t=undefined){return e instanceof A?null==t?e:e.astype(t,!1):E(e,t)}function B(e,t=undefined){return e=C(e),t=c(t),new A(e,t.new(M(e)),t)}function X(e,t=undefined){return B((e=V(e)).shape,t??e.dtype)}function C(e){return e?("function"==typeof e.toarray&&(e=e.toarray()),"object"==typeof e&&null!=e.length?e:[e]):[e]}function G(e,t){e=V(e),t=C(t);let r=-1,n=1;for(let e=0;e<t.length;e++)if(-1==t[e]){if(-1!=r)throw new Error("can only specify one unknown dimension");r=e}else n*=t[e];if(-1!=r){if(e.size%n!=0)throw new Error(`cannot reshape array of size ${e.size} into shape [${t.join(", ")}]`);t[r]=0==n?0:e.size/n}if(e.size!=M(t))throw new Error(`cannot reshape array of size ${e.size} into shape [${t.join(", ")}]`);if(null==e.base)return e.as_strided(t,z(t,t.length,e.itemsize));{let r=!0,n=0;for(let a=0;a<t.length;a++)if(1!=t[a]){for(;n<e.shape.length&&1==e.shape[n];n++);if(n>=e.shape.length||t[a]!=e.shape[n]){r=!1;break}n++}if(n!=e.shape.length&&(r=!1),r){let r=[];for(let n=0,a=0;n<t.length;n++){if(1!=t[n])for(;a<e.shape.length&&1==e.shape[a];a++);r.push(a<e.shape.length?e.strides[a++]:1)}return e.as_strided(t,r)}}let a=null;return 1==t.length&&function(e,t,r){let n;for(let t=r-1;t>0;t--)if(e[t]>1){n=t;break}for(let r=n-1;r>=0;r--)if(e[r]>1){if(t[r]!=t[n]*e[n])return!1;n=r}return!0}(e.shape,e.strides,e.ndim)?a=[e.strides[0]]:0!=t.length&&(e=E(e)),e.as_strided(t,a)}function W(e,t,r=undefined){let n=B(e,r??S(t));return D(n,t),n}function H(e,t,r=undefined){return W(q(e),t,r)}function J(...e){let t=0;for(let r of e)t=Math.max(t,r.length);if(0==t)return[];let r=Array(t).fill(1);for(let n of e)for(let e=n.length-1,a=t-1;e>=0;e--,a--){let t=n[e];if(1!=t)if(1==r[a])r[a]=t;else if(r[a]!=t)throw new Error("shape mismatch")}return r}function K(e,t=undefined,r=1){null==t&&(t=e,e=0);let n=Math.max(0,(t-e)/r|0),a=B([n],"number"),{data:l}=a;for(let t=0;t<n;t++)l[t]=e+t*r;return a}function Q(e,t,r=50,n=!0,a=!1){let l=(t-e)/(n?r-1:r),s=[];for(let t=0;t<r;t++)s[t]=e+t*l;let i=E(s);return a?[i,l]:i}function R(e,t,r=null,n=null,a="raise"){if(e=V(e),t=E(t),null==r){t.data=Y(t.data,a,e.size);let r=t.shape;if(null==n)n=B(r);else if(!Fe(n.shape,r))throw"output array does not match result of ndarray.take";for(let r=0;r<t.size;r++)n.data[r]=e.item(t.data[r]);return n}{r<0&&(r+=e.ndim),t.data=Y(t.data,a,e.shape[r]);let l=e.shape.slice();if(l.splice(r,1,...t.shape),null==n)n=B(l);else if(!Fe(n.shape,l))throw"output array does not match result of ndarray.take";let s=Array(r).fill(_());for(let r of L(t.shape))n.get(s.concat(r)).set(e.get([...s,t.item(r)]));return n}}function Y(e,t,r){let n=[];if("wrap"==t)for(let t of e)t%=r,t=t<0?t+r:t,n.push(t);else if("clip"==t)for(let t of e)s=r-1,t=(l=t)<0?0:l>s?s:l,n.push(t);else{if("raise"!=t)throw`unexpected mode = ${t}`;for(let t of e){if(t<-r||t>=r)throw`index ${t} is out of bounds for axis 0 with size ${r}`;t=t<0?t+a.size:t,n.push(t)}}var l,s;return n}function Z(e,t=undefined){return W(e,1,t)}function ee(e,t=undefined){return H(e,1,t)}function te(e,t=undefined){return W(e,0,t)}function re(e,t=undefined){return H(e,0,t)}function ne(e,t=undefined){return ae(e=V(e,t))?e:E(e)}function ae(e){let{strides:t,shape:r,ndim:n,itemsize:a}=e;if(0==n)return!1;for(let e=n-1;e>=0;e--)if(r[e]>1){if(a!=t[e])return!1;a*=r[e]}return!0}function le(e,t,r){e=V(e);let n=[...Array(e.ndim).keys()];return[n[t],n[r]]=[n[r],n[t]],se(e,n)}function se(e,t=null){e=V(e);let r,n,{ndim:a,shape:l,strides:s}=e;if(null==t)r=l.slice().reverse(),n=s.slice().reverse();else{t=function(e,t){if(e.length!=t)throw new Error("axes don't match array");let r=[],n={};for(let a=0;a<t;a++){let l=e[a];if(l<0&&(l+=t),l<0||t<=l)throw new Error(`axis ${l} is out of bounds for array of dimension ${a+1}`);if(n[l])throw new Error("repeated axis in transpose");n[l]=!0,r[a]=l}return r}(t,a),r=Array(a),n=Array(a);for(let e=0;e<a;e++)r[e]=l[t[e]],n[e]=s[t[e]]}return e.as_strided(r,n)}function ie(...e){if(1!=e.length)return e.map((e=>ie(e)));let t=V(e[0]),{ndim:r}=t;return r>=1?t:t.copy().reshape([1])}function de(...e){if(1!=e.length)return e.map((e=>de(e)));let t=V(e[0]),{ndim:r,shape:n}=t;return r>=2?t:1==r?t.reshape([1,n[0]]):t.copy().reshape([1,1])}function oe(...e){if(1!=e.length)return e.map((e=>oe(e)));let t=V(e[0]),{ndim:r,shape:n}=t;return r>=3?t:2==r?t.reshape([n[0],n[1],1]):1==r?t.reshape([1,n[0],1]):t.copy().reshape([1,1,1])}function ue(...e){return new he(e.map((e=>V(e))))}s.add("asarray",(()=>{let e=E([[1,2],[3,4]]);return V(e)===e}),(()=>!0)).add("asarray",(()=>V([[1,2],[3,4]])),(()=>[[1,2],[3,4]])),s.add("empty",(()=>B([2,2])),(()=>[[,,],[,,]])).add("empty",(()=>B(0)),(()=>[])).add("empty",(()=>B([])),(()=>{})),s.add("empty_like",(()=>X([[1,2,3],[4,5,6]])),(()=>[[,,,],[,,,]])).add("empty_like",(()=>X([1,2,3,[1,3]])),(()=>[,,,,])),s.add(G,(()=>G(E([1,2,3,4,5]).at(_("::-2")),-1)),(()=>E([5,3,1]))).add(G,(()=>G(E([1]),[])),(()=>E(1))).add(G,(()=>G(E(1),1)),(()=>E([1]))).add(G,(()=>G(E(1),-1)),(()=>E([1]))).add("reshape",(()=>G(V([[0,1],[2,3],[4,5]]),[2,3])),(()=>[[0,1,2],[3,4,5]])).add("reshape",(()=>G(V([[[[0,1]]]]),[2,-1])),(()=>[[0],[1]])).add("reshape",(()=>{let e=V([[[[0,1]]]]);return G(e,[2,-1]).base===e}),(()=>!0)).add("reshape",(()=>{let e=V([[[[0,1]]]]).at(0);return G(e,[2,-1]).base===e}),(()=>!1)).add("reshape",(()=>G(E([[1,2,3],[4,5,6]]),[-1])),(()=>E([1,2,3,4,5,6]))).add("reshape",(()=>{let e=K(30),t=e.reshape([10,3]).at(_("::2")),r=t.reshape(t.shape);return[t.toarray(),G(t,[1,1,5,-1,3]).base===e,t.base===e,t.reshape(-1).base===e,r===t,r.base===e]}),(()=>[E([[0,1,2],[6,7,8],[12,13,14],[18,19,20],[24,25,26]]).array(),!0,!0,!1,!1,!0])),s.add("full",(()=>W([2,2],1/0)),(()=>[[1/0,1/0],[1/0,1/0]])).add("full",(()=>W([2,2],10)),(()=>[[10,10],[10,10]])).add("full",(()=>W([2,2],[1,2])),(()=>[[1,2],[1,2]])).add("full",(()=>W(2,-1)),(()=>[-1,-1])),s.add(H,(()=>H([1],2)),(()=>[2])).add(H,(()=>H(1,99)),(()=>99)).add(H,(()=>Oe(H([[0,1],[2,3]],[1.1,2.2],"int8"),E([[1,2],[1,2]]))),(()=>!0)),s.add("broadcast_shapes",(()=>J([1,2],[3,1],[3,2])),(()=>[3,2])),s.add("broadcast_shapes",(()=>J([6,7],[5,6,1],[7],[5,1,7])),(()=>[5,6,7])),s.add("arange",(()=>K(3)),(()=>E([0,1,2]))).add("arange",(()=>K(-10,10)),(()=>E([-10,-9,-8,-7,-6,-5,-4,-3,-2,-1,0,1,2,3,4,5,6,7,8,9]))).add("arange",(()=>K(-10,10,-1)),(()=>E([]))).add("arange",(()=>K(3,7,2)),(()=>E([3,5]))).add("arange",(()=>K(0,-10,-1)),(()=>E([0,-1,-2,-3,-4,-5,-6,-7,-8,-9]))),s.add("linspace",(()=>Q(2,3,5)),(()=>E([2,2.25,2.5,2.75,3]))).add("linspace",(()=>Q(2,3,5,!1)),(()=>E([2,2.2,2.4,2.6,2.8]))).add("linspace",(()=>Q(2,3,5,!0,!0)),(()=>[E([2,2.25,2.5,2.75,3]),.25])).add("linspace",(()=>Q(2,3,5,!1,!0)),(()=>[E([2,2.2,2.4,2.6,2.8]),.2])).add("linspace",(()=>Q(1,10,10,!1)),(()=>E([1,1.9,2.8,3.7,4.6,5.5,6.4,7.3,8.2,9.1]))),s.add("take",(()=>R([4,3,5,7,6,8],[0,1,4])),(()=>E([4,3,6]))).add("take",(()=>R([4,3,5,7,6,8],[[0,1],[2,3]])),(()=>E([[4,3],[5,7]]))).add("take",(()=>R(E([[1,2],[3,4],[5,6],[7,8]]),[[0,1],[2,3]],0)),(()=>E([[[1,2],[3,4]],[[5,6],[7,8]]]))).add("take",(()=>R(E([[1,2],[3,4],[5,6],[7,8]]),E([[[[0,1],[0,1]]]]),1)),(()=>E([[[[[1,2],[1,2]]]],[[[[3,4],[3,4]]]],[[[[5,6],[5,6]]]],[[[[7,8],[7,8]]]]]))).add("take",(()=>R([[5,6,2,7,1],[4,9,2,9,3]],[0,4],1)),(()=>[[5,1],[4,3]])),s.add(ne,(()=>{let e=Z([3,1,5]).at(_(),_([,,3]),_());return ne(e)===e}),(()=>!0)),s.add(ne,(()=>{let e=Z([3,4,5]).at(_(),_([,,1]),_());return ne(e)===e}),(()=>!0)),s.add(ne,(()=>{let e=Z([3,4,5]).at(_(),_(),_(1));return ne(e)===e}),(()=>!1)),s.add(ne,(()=>{let e=Z([3]).at(_([,,-3]));return ne(e)===e}),(()=>!0)),s.add(ne,(()=>{let e=Z([2]).at(_([,,2]));return ne(e)===e}),(()=>!0)),s.add(ne,(()=>{let e=Z([3]).at(_([,,2]));return ne(e)===e}),(()=>!1)),s.add(ne,(()=>{let e=Z([3]).at(_([1,2]));return ne(e)===e}),(()=>!0)).add(ne,(()=>{let e,t;return e=E([]),t=ne(e),e===t}),(()=>!0)).add(ne,(()=>{let e,t;return e=E(5),t=ne(e),e===t}),(()=>!1)),s.add(le,(()=>le(E([[1,2,3]]),0,1)),(()=>E([[1],[2],[3]]))).add(le,(()=>le(E([[[0,1],[2,3]],[[4,5],[6,7]]]),0,2)),(()=>E([[[0,4],[2,6]],[[1,5],[3,7]]]))),s.add(se,(()=>se(K(4).reshape([2,2]))),(()=>E([[0,2],[1,3]]))).add(se,(()=>se(Z([1,2,3]),[1,0,2])),(()=>E([[[1,1,1]],[[1,1,1]]]))).add(se,(()=>se(Z([2,3,4,5])).shape),(()=>[5,4,3,2])),s.add(ie,(()=>ie(1)),(()=>E([1]))).add(ie,(()=>ie(1,[3,4])),(()=>[E([1]),E([3,4])])).add(ie,(()=>ie(K(9).reshape([3,3]))),(()=>E([[0,1,2],[3,4,5],[6,7,8]]))).add(ie,(()=>{let e=E([1]),t=e.at(0),r=ie(t);return r.set([0],-96),[e.array(),t.array(),r.array(),null===e.base,null===t.base,r.base!=t,r.base]}),(()=>[E([1]),1,E([-96]),!0,!1,!0,E(-96)])),s.add(de,(()=>de(3)),(()=>E([[3]]))).add(de,(()=>{let e=K(3);return[de(e),de(e).base===e]}),(()=>[E([[0,1,2]]),!0])).add(de,(()=>de(1,[1,2],[[1,2]])),(()=>[E([[1]]),E([[1,2]]),E([[1,2]])])),s.add(oe,(()=>oe(3)),(()=>E([[[3]]]))).add(oe,(()=>oe(K(3)).shape),(()=>[1,3,1])).add(oe,(()=>{let e=K(12).reshape(4,3);return[oe(e).shape,oe(e).base===e.base]}),(()=>[[4,3,1],!0])).add(oe,(()=>oe([1,2],[[1,2]],[[[1,2]]])),(()=>[[[[1],[2]]],[[[1],[2]]],[[[1,2]]]]));class he{constructor(e){this.shape=J(...e.map((e=>e.shape))),this.arrays=e.map((e=>T(e,this.shape))),this.ndim=this.shape.length,this.size=M(this.shape),this.reset()}[Symbol.iterator](){return 0!=this.index&&this.reset(),this}next(){let e=this.iters.map((e=>e.next().value)),t=this.index>=this.size;return this.index++,{value:e,done:t}}reset(){this.iters=this.arrays.map((e=>e.flat)),this.index=0}}function fe(e,t=e,r=0,n="number"){let a=te([e,t],n),{data:l,size:s}=a;for(let e=r+Math.ceil(-r/(t+1))*(t+1);e<s;e+=t+1)l[e]=1;return a}function pe(e,t="number"){return fe(e,e,0,t)}function ce(e){return null==e||"object"!=typeof e?0:null!=e.ndim?e.ndim:q(e).length}s.add(ue,(()=>{let e=ue(E([[1],[2],[3]]),E([4,5,6])),t=B(e.shape),r=[];for(let[t,n]of e)r.push(t+n);return t.flat=r,t}),(()=>E([[5,6,7],[6,7,8],[7,8,9]]))).add(ue,(()=>{let e=[],t=ue(E([1,2,3]),E([[4],[5],[6]]));return e.push(t.index),e.push(t.next().value,t.next().value,t.next().value),e.push(t.index),t.reset(),e.push(t.index),e}),(()=>[0,[1,4],[2,4],[3,4],3,0])),s.add("eye",(()=>fe(2)),(()=>[[1,0],[0,1]])).add("eye",(()=>fe(3,3,1)),(()=>[[0,1,0],[0,0,1],[0,0,0]])).add("eye",(()=>fe(4,5,-1)),(()=>[[0,0,0,0,0],[1,0,0,0,0],[0,1,0,0,0],[0,0,1,0,0]])),s.add("identity",(()=>pe(3)),(()=>[[1,0,0],[0,1,0],[0,0,1]])).add("identity",(()=>pe(0)),(()=>E([]).reshape([0,0])));const me=ce;function ye(e,t){"number"==typeof t&&(t=[t]);let r=(e=V(e)).ndim+t.length;t=Ee(t,r,!1);let n=[];for(let a=0,l=0;a<r;a++)n.push(t.includes(a)?1:e.shape[l++]);return e.reshape(n)}function ge(e,t=null){e=V(e),null!=t&&(t=Ee(t));let{shape:r,ndim:n}=e,a=[];for(let e=0;e<n;e++)(t?t.includes(e):1==r[e])||a.push(r[e]);return e.reshape(a)}function we(e){return E(e)}function be(e,t,r=undefined){let n=[];for(let r of L(t))n.push(e(r));return E(n,r??S(n)).reshape(t)}function xe(e,t=-1,r=undefined){let n;if(-1==t)n=[...e];else{n=[];let r=0;if(r<t)for(let a of e)if(n.push(a),r++,r>=t)break}return E(n,r??S(n))}function _e(e){e=ie(e);let{ndim:t}=e,r=[];for(let e=0;e<t;e++)r.push([]);for(let[n,a]of Ca(e))if(a)for(let e=0;e<t;e++)r[e].push(n[e]);return r.map((e=>V(e)))}function $e(e){return 0==ce(e)?$e(e=ie(e)).at(_(),_(null,0)):se(_e(e))}function ve(e,t,r=null,n=null){if(1!=(e=V(e)).ndim)throw"condition must be a 1-d array";return R(t,_e(e)[0],r,n)}function Ae(e){e=ne(e);let{size:t,base:r,offset:n,itemsize:a}=e;return(e=e.as_strided([t],z([t],1,a),n)).base=r,e}function ze(e,t){return ve(Ae(e),Ae(t))}function Me(e){return _e(Ae(e))[0]}function Ne(e,t=null,r=!1){return Jt(qr(e,0),t,null,r)}function ke(e,t,r=!1){if(Array.isArray(e)||(e=[e]),e=e.map((e=>va(e,t))),!r&&new Set(e).size!=e.length)throw"repeated axis";return e}s.add("ndim",(()=>ce([[1,2,3],[4,5,6]])),(()=>2)).add("ndim",(()=>ce(V([[1,2,3],[4,5,6]]))),(()=>2)).add("ndim",(()=>ce(1)),(()=>0)).add("ndim",(()=>ce(null)),(()=>0)),s.add(ye,(()=>ye(E([1,2]),0)),(()=>E([[1,2]]))).add(ye,(()=>ye(E([1,2]),1)),(()=>E([[1],[2]]))).add(ye,(()=>ye(E([1,2]),[0,1])),(()=>E([[[1,2]]]))).add(ye,(()=>ye(E([1,2]),[2,0])),(()=>E([[[1],[2]]]))).add(ye,(()=>{let e=E([1,2]);return ye(e,[2,0]).base===e}),(()=>!0)),s.add(ge,(()=>ge(E([[[0],[1],[2]]])).shape),(()=>[3])).add(ge,(()=>ge(E([[[0],[1],[2]]]),0).shape),(()=>[3,1])).add(ge,(()=>ge(E([[[0],[1],[2]]]),2).shape),(()=>[1,3])).add(ge,(()=>ge(E([[1234]]))),(()=>E(1234))).add(ge,(()=>{let e,t,r,n,a;return e=K(20),t=e.reshape([5,-1]),r=t.at(_([,,-1])),n=ne(r),a=n.reshape([5,1,1,-1]),[a.reshape([5,-1]).base===n,a.reshape(-1).base===n,ge(a).base===n,e,t,r,ge(a)]}),(()=>[!0,!0,!0,E([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]),E([[0,1,2,3],[4,5,6,7],[8,9,10,11],[12,13,14,15],[16,17,18,19]]),E([[16,17,18,19],[12,13,14,15],[8,9,10,11],[4,5,6,7],[0,1,2,3]]),E([[16,17,18,19],[12,13,14,15],[8,9,10,11],[4,5,6,7],[0,1,2,3]])])),s.add(we,(()=>{let e,t,r;return e=E([1,2,3]),t=e,r=we(e),e.set([0],10),[e.item(0)==t.item(0),e.item(0)==r.item(0)]}),(()=>[!0,!1])),s.add(be,(()=>be((([e,t])=>e),[2,2])),(()=>E([[0,0],[1,1]]))).add(be,(()=>be((([e,t])=>t),[2,2])),(()=>E([[0,1],[0,1]]))).add(be,(()=>be((([e,t])=>e==t),[3,3])),(()=>E([[!0,!1,!1],[!1,!0,!1],[!1,!1,!0]]))).add(be,(()=>be((([e,t])=>e+t),[3,3])),(()=>E([[0,1,2],[1,2,3],[2,3,4]]))),s.add(xe,(()=>xe({*[Symbol.iterator](){for(let e=0;e<5;e++)yield e*e}})),(()=>E([0,1,4,9,16]))).add(xe,(()=>xe({*[Symbol.iterator](){for(let e=0;e<5;e++)yield[e+1,e+2]}})),(()=>E([[1,2],[2,3],[3,4],[4,5],[5,6]]))),s.add(_e,(()=>{let e;return e=E([[3,0,0],[0,4,0],[5,6,0]]).at(_("..."),null),_e(e)}),(()=>[E([0,1,2,2]),E([0,1,0,1]),E([0,0,0,0])])).add(_e,(()=>_e(E([[!1,!1,!1],[!0,!0,!0],[!0,!0,!0]]))),(()=>[E([1,1,1,2,2,2]),E([0,1,2,0,1,2])])).add(_e,(()=>_e(55)),(()=>[E([0])])),s.add($e,(()=>$e(55).shape),(()=>[1,0])).add($e,(()=>$e(Tr(K(6).reshape(2,3),1))),(()=>E([[0,2],[1,0],[1,1],[1,2]]))),s.add(ve,(()=>ve([0,1],E([[1,2],[3,4],[5,6]]),0)),(()=>E([[3,4]]))).add(ve,(()=>ve([!1,!0,!0],E([[1,2],[3,4],[5,6]]),0)),(()=>E([[3,4],[5,6]]))).add(ve,(()=>ve([!1,!0],E([[1,2],[3,4],[5,6]]),1)),(()=>E([[2],[4],[6]]))).add(ve,(()=>ve([!1,!0],E([[1,2],[3,4],[5,6]]))),(()=>E([2]))),s.add(Ae,(()=>Ae(E([[1,2,3],[4,5,6]]))),(()=>E([1,2,3,4,5,6]))).add(Ae,(()=>Ae(E([[1,2,3],[4,5,6]]).T)),(()=>E([1,4,2,5,3,6]))).add(Ae,(()=>Ae(K(12).reshape(2,3,2).swapaxes(1,2))),(()=>E([0,2,4,1,3,5,6,8,10,7,9,11]))).add(Ae,(()=>{let e,t;return e=K(40).reshape([5,-1]).copy(),t=e.at(null,_(":"),null,null,_("::2"),null),[t.reshape(-1).base==e,Ae(t).base]}),(()=>[!0,null])).add(Ae,(()=>{let e,t;return e=K(40).reshape([5,-1]).copy(),t=e.at(null,_(":"),null,null,_("::3"),null),[t.reshape(-1).base==e,Ae(t).base]}),(()=>[!1,null])),s.add(ze,(()=>{let e,t;return e=K(12).reshape([3,4]),t=E([[!0,!1,!1,!0],[!1,!1,!0,!1],[!1,!0,!1,!1]]),ze(t,e)}),(()=>E([0,3,6,9]))),s.add(Me,(()=>{let e;return e=K(-2,3),Me(e)}),(()=>E([0,1,3,4]))),s.add(Ne,(()=>{let e;return e=Z([2,3,4,5]),Ne(e)}),(()=>120)).add(Ne,(()=>{let e;return e=Z([2,3,4,5]),Ne(e,0)}),(()=>E([[[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2]],[[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2]],[[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2]]]))).add(Ne,(()=>{let e;return e=Z([2,3,4,5]),Ne(e,1)}),(()=>E([[[3,3,3,3,3],[3,3,3,3,3],[3,3,3,3,3],[3,3,3,3,3]],[[3,3,3,3,3],[3,3,3,3,3],[3,3,3,3,3],[3,3,3,3,3]]]))).add(Ne,(()=>{let e;return e=Z([2,3,4,5]),Ne(e,-1)}),(()=>E([[[5,5,5,5],[5,5,5,5],[5,5,5,5]],[[5,5,5,5],[5,5,5,5],[5,5,5,5]]]))).add(Ne,(()=>{let e;return e=Z([2,3,4,5]),Ne(e,[0,-1])}),(()=>E([[10,10,10,10],[10,10,10,10],[10,10,10,10]]))).add(Ne,(()=>{let e;return e=Z([2,3,4,5]),Ne(e,[0,-1],!0)}),(()=>E([[[[10],[10],[10],[10]],[[10],[10],[10],[10]],[[10],[10],[10],[10]]]])));const Ee=ke;class je{constructor(e,t=null){this.array=V(e);let{ndim:r,shape:n}=e;if(null!=t&&(t=ke(t,r)),this.axis=t,null!=t){let e=[],a=[],l=[];for(let s=0;s<r;s++)(l[s]=!t.includes(s))?(a[s]=0,e.push(n[s])):a[s]=_[":"];this.shape=e,this.indices=a,this.mask=l}else this.shape=[e.size],this.indices=[0],this.mask=null}*[Symbol.iterator](){let{array:e,axis:t}=this;if(null==t)return void(yield*e.flat);let{shape:r,mask:n,indices:a}=this;for(let t of L(r)){for(let r=0,l=0;r<e.ndim;r++)n[r]&&(a[r]=t[l++]);yield[t,e.get(a)]}}}function Se(e,t=null){return new je(e,t)}function Oe(e,t,r=!1){return e=V(e),t=V(t),!!Fe(e.shape,t.shape)&&ut(r?Ie(e,t):Or(e,t))}function qe(e,t){return e=V(e),t=V(t),!!function(...e){let t=0;for(let r of e)t=Math.max(t,r.length);for(let r=0;r<t;r++){let t=-1;for(let n of e){let e=n.length-r-1;if(!(e<0))if(-1==t)t=n[e];else if(1!=t&&t!=n[e])return!1}}return!0}(e.shape,t.shape)&&ut(Or(e,t))}function Fe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}const Ie=ha("nan_equal",((e,t)=>e==t||Number.isNaN(e)&&Number.isNaN(t)));function Te(e,t=0,r=undefined){if(0==e.length)throw new Error("need at least one array to concatenate");e=e.map((e=>V(e))),null==t&&(e=e.map((e=>Ae(e))),t=0);let{ndim:n,shape:a}=e[0];if(0==n)throw new Error("zero-dimensional arrays cannot be concatenated");for(let r=1;r<e.length;r++){let l=e[r];if(l.ndim!=n)throw new Error(`all the input arrays must have same number of dimensions, but the array at index 0 has ${n} dimension(s) and the array at index ${r} has ${e[r].ndim} dimension(s)`);for(let s=0;s<n;s++)if(s!=t&&l.shape[s]!=a[s])throw new Error(`all the input array dimensions for the concatenation axis must match exactly, but along dimension ${s}, the array at index 0 has size ${a[s]} and the array at index ${r} has size ${e[r].shape[s]}`)}t=va(t,n);let l=a.slice();if(l[t]=e.reduce(((e,r)=>e+r.shape[t]),0),null==r)r=B(l);else{if(r.ndim!=n)throw new Error("output array has wrong dimensionality");if(!Fe(r.shape,l))throw new Error("output array is the wrong shape")}let s=Array(n).fill(_(":")),i=0;for(let n of e)s[t]=_(i,i+=n.shape[t]),r.set(s,n);return r}function Pe(e,t,r){e=V(e);let{ndim:n}=e;if(t=Ee(t,n),r=Ee(r,n),t.length!=r.length)throw new Error("'src' and 'dst' arguments must have the same number of elements");let a=[...Array(n).keys()].filter((e=>!t.includes(e)));for(let e=0;e<t.length;e++)a.splice(r[e],0,t[e]);return se(e,a)}s.add(Oe,(()=>Oe([1,2],[1,2])),(()=>!0)).add(Oe,(()=>Oe(E([1,2]),E([1,2]))),(()=>!0)).add(Oe,(()=>Oe([1,2],[1,2,3])),(()=>!1)).add(Oe,(()=>Oe([1,2],[1,4])),(()=>!1)).add(Oe,(()=>{let e=E([1,NaN]);return Oe(e,e)}),(()=>!1)).add(Oe,(()=>{let e=E([1,NaN]);return Oe(e,e,!0)}),(()=>!0)),s.add(qe,(()=>qe([1,2],[1,2])),(()=>!0)).add(qe,(()=>qe([1,2],[1,3])),(()=>!1)).add(qe,(()=>qe([1,2],[[1,2],[1,2]])),(()=>!0)).add(qe,(()=>qe([1,2],[[1,2,1,2],[1,2,1,2]])),(()=>!1)).add(qe,(()=>qe([1,2],[[1,2],[1,3]])),(()=>!1)),s.add(Te,(()=>{let e=E([[1,2],[3,4]]),t=E([[5,6]]);return[Te([e,t],0),Te([e,t.T],1),Te([e,t],null)]}),(()=>[E([[1,2],[3,4],[5,6]]),E([[1,2,5],[3,4,6]]),E([1,2,3,4,5,6])])),s.add(Pe,(()=>Pe(te([3,4,5]),0,-1).shape),(()=>[4,5,3])).add(Pe,(()=>Pe(te([3,4,5]),-1,0).shape),(()=>[5,3,4]));const De=ha("add",((e,t)=>e+t)),Le=ua("reciprocal",(e=>1/e)),Ue=ua("positive",(e=>+e)),Ve=ua("negative",(e=>-e)),Be=ha("multiply",((e,t)=>e*t)),Xe=ha("divide",((e,t)=>e/t)),Ce=ha("power",((e,t)=>e**t)),Ge=ha("subtract",((e,t)=>e-t)),We=Xe,He=ha("floor_divide",((e,t)=>e/t|0)),Je=Ce,Ke=ha("fmod",((e,t)=>e-(e/t|0)*t)),Qe=ha("mod",((e,t)=>(e%t+t)%t));function Re(e,t=[null,null]){return[ca(Ye,e,t[0]),ca(Ze,e,t[1])]}const Ye=e=>e%1,Ze=e=>0|e,et=Qe;function tt(e,t,r=[null,null]){return[He(e,t,r[0]),Qe(e,t,r[1])]}s.add(tt,(()=>tt(K(5),3)),(()=>[E([0,0,0,1,1]),E([0,1,2,0,1])])),s.add(Re,(()=>Re([0,3.5])),(()=>[E([0,.5]),E([0,3])])).add(Re,(()=>Re(-.5)),(()=>[-.5,-0])),s.add(Ke,(()=>Ke([-3,-2,-1,1,2,3],2)),(()=>E([-1,0,-1,1,0,1]))).add(Ke,(()=>et([-3,-2,-1,1,2,3],2)),(()=>E([1,0,1,1,0,1]))),s.add(De,(()=>De(K(9).reshape([3,3]),K(3))),(()=>E([[0,2,4],[3,5,7],[6,8,10]]))),s.add(Ge,(()=>Ge(1,4)),(()=>-3)).add(Ge,(()=>Ge(K(9).reshape([3,3]),K(3))),(()=>E([[0,0,0],[3,3,3],[6,6,6]]))),s.add(Be,(()=>Be(2,4)),(()=>8)).add(Ge,(()=>Be(K(9).reshape([3,3]),K(3))),(()=>E([[0,1,4],[0,4,10],[0,7,16]]))),s.add(Xe,(()=>Xe(2,4)),(()=>.5)).add(Xe,(()=>Xe(K(9).reshape([3,3]),K(3))),(()=>E([[NaN,1,1],[1/0,4,2.5],[1/0,7,4]]))),s.add(Qe,(()=>Qe([4,7],[2,3])),(()=>E([0,1]))).add(Qe,(()=>Qe(K(7),5)),(()=>E([0,1,2,3,4,0,1]))),s.add(Ce,(()=>Ce(K(6),3)),(()=>E([0,1,8,27,64,125]))).add(Ce,(()=>Ce(K(6),[1,2,3,3,2,1])),(()=>E([0,1,8,27,16,5]))).add(Ce,(()=>Ce(K(6),E([[1,2,3,3,2,1],[1,2,3,3,2,1]]))),(()=>E([[0,1,8,27,16,5],[0,1,8,27,16,5]]))).add(Ce,(()=>Ce(K(6),E([1,2,3,3,2,1]))),(()=>E([0,1,8,27,16,5])));const rt=ha("logical_and",((e,t)=>e&&t),{dtype:"boolean"}),nt=rt,at=ha("logical_or",((e,t)=>e||t),{dtype:"boolean"}),lt=at,st=ua("logical_not",(e=>!e),{dtype:"boolean"}),it=st,dt=ha("logical_xor",((e,t)=>!e!=!t),{dtype:"boolean"}),ot=dt,ut=fa("all",((e,t)=>e&&!!t),!0),ht=fa("any",((e,t)=>e||!!t),!1),ft=ua("isfinite",Number.isFinite),pt=ua("isinf",(e=>e==1/0||e==-1/0)),ct=ua("isnan",Number.isNaN),mt=ua("isneginf",(e=>e==-1/0)),yt=ua("isposinf",(e=>e==1/0));s.add(rt,(()=>rt(!0,!1)),(()=>!1)).add(rt,(()=>rt([!0,!1],[!1,!1])),(()=>E([!1,!1]))).add(rt,(()=>{let e=K(5);return rt(Tr(e,1),Fr(e,4))}),(()=>E([!1,!1,!0,!0,!1]))).add(rt,(()=>rt(E([!0,!1]),E([!1,!1]))),(()=>E([!1,!1]))),s.add(ut,(()=>0==ut([[!0,!1],[!0,!0]])),(()=>!0)).add(ut,(()=>ut([[!0,!1],[!0,!0]],0)),(()=>E([!0,!1]))).add(ut,(()=>ut([-1,4,5])),(()=>!0)).add(ut,(()=>{let e=E(!1);return[ut([-1,4,5],null,e)==e,e]}),(()=>[!0,E(!0)])).add(ut,(()=>ut([])),(()=>!0)),s.add(ht,(()=>ht([[!0,!1],[!0,!0]])),(()=>!0)).add(ht,(()=>ht([[!0,!1],[!1,!1]],0)),(()=>E([!0,!1]))).add(ht,(()=>ht([-1,0,5])),(()=>!0)).add(ht,(()=>ht(NaN)),(()=>!1));const gt=Math.E,wt=NaN,bt=Math.PI,xt=1/0,_t=-1/0,$t=ua("sin",Math.sin),vt=ua("cos",Math.cos),At=ua("tan",Math.tan),zt=ua("arcsin",Math.asin),Mt=ua("arccos",Math.acos),Nt=ua("arctan",Math.atan),kt=ua("hypot",Math.hypot),Et=ua("arctan2",Math.atan2),jt=ua("degrees",(e=>180*e/bt)),St=ua("radians",(e=>e/180*bt));function Ot(e,t=2*bt,r=t/2){if(1!=(e=V(e)).ndim)throw"unwrap currently only supports 1d arrays";let n=[e.data[e.offset]],a=e.data[e.offset],l=!0;for(let s of Ba(e.shape,e.strides)){if(l){l=!1;continue}let i=e.data[e.offset+s]-a;i>r?i-=t:i<-r&&(i+=t);let d=a+i;n.push(d),a=d}return V(n)}const qt=ua("rad2deg",(e=>180*e/bt)),Ft=ua("deg2rad",(e=>e/180*bt)),It=ua("sinh",Math.sinh),Tt=ua("cosh",Math.cosh),Pt=ua("tanh",Math.tanh),Dt=ua("arcsinh",Math.asinh),Lt=ua("arccosh",Math.acosh),Ut=ua("arctanh",Math.atanh);function Vt(e,t=0,r=null){if(e=V(e),null==r)r=B(e.shape);else if(!Fe(r.shape,e.shape))throw new Error("shape does not match");let n=0;for(let a of e.flat){let e=10**t,l=a*e,s=Math.round(l),i=l%1;.5!=i&&-.5!=i||(s=s%2?s-1:s),r.itemset(n++,s/e)}return r}const Bt=ua("rint",(e=>{let t=e%1,r=Math.round(e);return.5!=t&&-.5!=t||(r=r%2?r-1:r),r})),Xt=ua("fix",(e=>Math.sign(e)*Math.floor(Math.abs(e)))),Ct=ua("floor",Math.floor),Gt=ua("ceil",Math.ceil),Wt=ua("trunc",Math.trunc),Ht=fa("prod",((e,t)=>e*t),1),Jt=fa("sum",((e,t)=>e+t),0),Kt=fa("nanprod",((e,t)=>e*(isNaN(t)?1:t)),1),Qt=fa("nansum",((e,t)=>e+(isNaN(t)?0:t)),0);function Rt(e,t=1,r=-1){e=V(e);let{ndim:n}=e;r=va(r,n);let a=Array(n).fill(_()),l=Array(n).fill(_());a[r]=_(1,null),l[r]=_(null,-1);for(let r=0;r<t;r++)e=Ge(e.get(a),e.get(l));return e}function Yt(e,t=null,r=null){if(e=Rt(G(e,-1)),null!=r||null!=t){let n=[];null!=r&&n.push(r),n.push(e),null!=t&&n.push(t),e=Te(n,null)}return e}const Zt=ua("exp",Math.exp,1),er=ua("expm1",(e=>Math.exp(e)-1)),tr=ua("exp2",(e=>2**e)),rr=ua("log",Math.log),nr=ua("log10",Math.log10),ar=ua("log2",Math.log2),lr=ua("log1p",Math.log1p),sr=ha("logaddexp",((e,t)=>Math.log(Math.exp(e)+Math.exp(t)))),ir=ha("logaddexp2",((e,t)=>Math.log2(2**e+2**t))),dr=ua("signbit",(e=>e<0)),or=ha("copysign",((e,t)=>t<0?-Math.abs(e):Math.abs(e))),ur=ha("ldexp",((e,t)=>e*2**t));function hr(e,t){for(;0!=t;){let r=t;t=e%t,e=r}return e}const fr=ha("lcm",(function(e,t){return e*t/hr(e,t)})),pr=ha("gcd",hr),cr=ha("maximum",Math.max),mr=ha("minimum",Math.min),yr=fa("amax",Math.max,-xt),gr=fa("amin",Math.min,xt),wr=ua("sqrt",Math.sqrt),br=ua("cbrt",Math.cbrt),xr=ua("square",(e=>e**2)),_r=ua("abs",Math.abs),$r=_r,vr=ua("sign",Math.sign),Ar=ua("nan_to_num",(e=>isNaN(e)?0:e==1/0?Number.MAX_VALUE:e==-1/0?Number.MIN_VALUE:e));s.add(yr,(()=>yr(K(4).reshape(2,2))),(()=>3)).add(yr,(()=>yr(K(4).reshape(2,2),0)),(()=>E([2,3]))).add(yr,(()=>yr(K(4).reshape(2,2),1)),(()=>E([1,3]))),s.add(cr,(()=>cr([2,3,4],[1,5,2])),(()=>E([2,5,4]))).add(cr,(()=>cr(fe(2),[.5,2])),(()=>E([[1,2],[.5,2]]))),s.add(pr,(()=>pr(12,20)),(()=>4)).add(pr,(()=>pr(K(6),20)),(()=>E([20,1,2,1,4,5]))),s.add(fr,(()=>fr(12,20)),(()=>60)).add(fr,(()=>fr(K(6),20)),(()=>E([0,20,20,60,20,20]))),s.add(or,(()=>or(1.3,-1)),(()=>-1.3)).add(or,(()=>1/or(0,1)),(()=>1/0)).add(or,(()=>1/or(0,-1)),(()=>-1/0)),s.add(dr,(()=>dr(-1.2)),(()=>!0)).add(dr,(()=>dr(E([1,-2.3,2.1]))),(()=>E([!1,!0,!1]))),s.add(sr,(()=>{let e=rr(1e-50),t=rr(2.5e-50);return sr(e,t)}),(()=>-113.87649168120691)),s.add(Ot,(()=>Ot([0,1,2,-1,0],4)),(()=>E([0,1,2,3,4]))).add(Ot,(()=>Ot([1,2,3,4,5,6,1,2,3],6)),(()=>E([1,2,3,4,5,6,7,8,9]))).add(Ot,(()=>Ot([2,3,4,5,2,3,4,5],4)),(()=>E([2,3,4,5,6,7,8,9]))),s.add(Vt,(()=>Vt([.37,1.64])),(()=>E([0,2]))).add(Vt,(()=>Vt([.37,1.64],1)),(()=>E([.4,1.6]))).add(Vt,(()=>Vt([.5,1.5,2.5,3.5,4.5])),(()=>E([0,2,2,4,4]))).add(Vt,(()=>Vt([5,15,25,35,45],-1)),(()=>E([0,20,20,40,40]))).add(Vt,(()=>Vt([-5,-15,-25,-35,-45],-1)),(()=>E([0,-20,-20,-40,-40]))).add(Vt,(()=>Vt([1,2,3,11],1)),(()=>E([1,2,3,11]))).add(Vt,(()=>Vt([1,2,3,11],-1)),(()=>E([0,0,0,10]))),s.add(Bt,(()=>Bt(E([-1.7,-1.5,-.2,.2,1.5,1.7,2]))),(()=>E([-2,-2,-0,0,2,2,2]))),s.add(Xt,(()=>Xt(3.14)),(()=>3)).add(Xt,(()=>Xt(3)),(()=>3)).add(Xt,(()=>Xt([2.1,2.9,-2.1,-2.9])),(()=>E([2,2,-2,-2]))),s.add(Ht,(()=>Ht([])),(()=>1)).add(Ht,(()=>Ht([1,2])),(()=>2)).add(Ht,(()=>Ht(E([[1,2],[3,4]]))),(()=>24)).add(Ht,(()=>Ht(E([[1,2],[3,4]]),1)),(()=>E([2,12]))).add(Ht,(()=>Ht(E([[1,2],[3,4]]),0)),(()=>E([3,8]))).add(Ht,(()=>Ht([1,2],null,null,null,5)),(()=>10)),s.add(Jt,(()=>Jt([.5,1.5])),(()=>2)).add(Jt,(()=>Jt([[0,1],[0,5]])),(()=>6)).add(Jt,(()=>Jt([[0,1],[0,5]],0)),(()=>E([0,6]))).add(Jt,(()=>Jt([[0,1],[0,5]],1)),(()=>E([1,5]))).add(Jt,(()=>Jt([10],null,null,null,5)),(()=>15)).add(Jt,(()=>Jt(K(100).reshape(5,-1,1).at(_("::-2"),_("2:7")),[0,-1])),(()=>E([126,129,132,135,138]))).add(Jt,(()=>{let e=K(100);return e=e.at(_(20,-20)).reshape([2,1,-1,2]).at(_("..."),_("::-1")),Jt(e,[1,-2],null,!0,-99)}),(()=>E([[[[426,411]]],[[[876,861]]]]))),s.add(Kt,(()=>Kt(1)),(()=>1)).add(Kt,(()=>Kt([1])),(()=>1)).add(Kt,(()=>Kt([1,wt])),(()=>1)).add(Kt,(()=>Kt(E([[1,2],[3,wt]]))),(()=>6)).add(Kt,(()=>Kt(E([[1,2],[3,wt]]),0)),(()=>E([3,2]))),s.add(Qt,(()=>Qt(1)),(()=>1)).add(Qt,(()=>Qt([1])),(()=>1)).add(Qt,(()=>Qt([1,wt])),(()=>1)).add(Qt,(()=>Qt(E([[1,1],[1,wt]]))),(()=>3)).add(Qt,(()=>Qt(E([[1,1],[1,wt]]),0)),(()=>E([2,1]))).add(Qt,(()=>Qt([1,wt,xt])),(()=>xt)).add(Qt,(()=>Qt([1,wt,_t])),(()=>-xt)),s.add(Rt,(()=>Rt(E([1,2,4,7,0]))),(()=>E([1,2,3,-7]))).add(Rt,(()=>Rt(E([1,2,4,7,0]),2)),(()=>E([1,1,-10]))).add(Rt,(()=>Rt(E([[1,3,6,10],[0,5,6,8]]))),(()=>E([[2,3,4],[5,1,2]]))).add(Rt,(()=>Rt(E([[1,3,6,10],[0,5,6,8]]),1,0)),(()=>E([[-1,2,0,-2]]))),s.add(Yt,(()=>Yt(E([1,2,4,7,0]))),(()=>E([1,2,3,-7]))).add(Yt,(()=>Yt(E([1,2,4,7,0]),E([88,99]),-99)),(()=>E([-99,1,2,3,-7,88,99]))).add(Yt,(()=>Yt([[1,2,4],[1,6,24]])),(()=>E([1,2,-3,5,18]))),s.add(_r,(()=>_r(E([-1.2,1.2]))),(()=>E([1.2,1.2]))),s.add($t,(()=>$t(K(30).reshape(2,5,1,-1,1)).shape),(()=>E([[[[[0],[.8414709848078965],[.9092974268256817]]],[[[.1411200080598672],[-.7568024953079282],[-.9589242746631385]]],[[[-.27941549819892586],[.6569865987187891],[.9893582466233818]]],[[[.4121184852417566],[-.5440211108893698],[-.9999902065507035]]],[[[-.5365729180004349],[.4201670368266409],[.9906073556948704]]]],[[[[.6502878401571168],[-.2879033166650653],[-.9613974918795568]]],[[[-.7509872467716762],[.14987720966295234],[.9129452507276277]]],[[[.8366556385360561],[-.008851309290403876],[-.8462204041751706]]],[[[-.9055783620066238],[-.13235175009777303],[.7625584504796028]]],[[[.956375928404503],[.27090578830786904],[-.6636338842129675]]]]]).shape));const zr=ha("bitwise_and",((e,t)=>e&t)),Mr=ha("bitwise_or",((e,t)=>e|t)),Nr=ha("bitwise_xor",((e,t)=>e^t)),kr=ua("bitwise_not",(e=>~e)),Er=kr,jr=ha("left_shift",((e,t)=>e<<t)),Sr=ha("right_shift",((e,t)=>e>>t));s.add(Er,(()=>Er([13])),(()=>E([-14]))),s.add(zr,(()=>zr(13,17)),(()=>1)).add(zr,(()=>zr([11,7],[4,25])),(()=>E([0,1]))).add(zr,(()=>zr(E([2,5,255]),E([3,14,16]))),(()=>E([2,4,16]))).add(zr,(()=>zr([!0,!0],[!1,!0])),(()=>E([!1,!0]))),s.add(Mr,(()=>Mr([33,4],1)),(()=>E([33,5]))),s.add(Nr,(()=>{let e=[1,2,3],t=[4,5,6];return e=Nr(e,t),t=Nr(e,t),e=Nr(e,t),[e,t]}),(()=>[[4,5,6],[1,2,3]])),s.add(jr,(()=>jr(5,[1,2,3])),(()=>E([10,20,40]))),s.add(Sr,(()=>Sr(10,[1,2,3])),(()=>E([5,2,1])));const Or=ha("equal",((e,t)=>e==t),{dtype:"boolean"}),qr=ha("not_equal",((e,t)=>e!=t),{dtype:"boolean"}),Fr=ha("less",((e,t)=>e<t),{dtype:"boolean"}),Ir=ha("less_equal",((e,t)=>e<=t),{dtype:"boolean"}),Tr=ha("greater",((e,t)=>e>t),{dtype:"boolean"}),Pr=ha("greater_equal",((e,t)=>e>=t),{dtype:"boolean"}),Dr=Or,Lr=qr,Ur=Fr,Vr=Ir,Br=Tr,Xr=Pr;function Cr(e,t,r=null,n=1){throw new Error}function Gr(e,t,r=-1,n=r,a=r,l=r){e=V(e),t=V(t),n=va(n,e.ndim),a=va(a,t.ndim),e=Pe(e,n,-1),t=Pe(t,a,-1);let s=e.shape.at(-1),i=t.shape.at(-1);if(2!=s&&3!=s||2!=i&&3!=i)throw"incompatible dimensions for cross product (dimension must be 2 or 3)";let d=J(e.shape.slice(0,-1),t.shape.slice(0,-1));3!=e.shape.at(-1)&&3!=t.shape.at(-1)||(d=[...d,3],l=va(l,d.length));let o,u,h,f,p,c,m,y,g,w=B(d);if(o=e.at("...",0),u=e.at("...",1),3==e.shape.at(-1)&&(h=e.at("...",2)),f=t.at("...",0),p=t.at("...",1),3==t.shape.at(-1)&&(c=t.at("...",2)),0!=w.ndim&&3==w.shape.at(-1)&&(m=w.at("...",0),y=w.at("...",1),g=w.at("...",2)),2==e.shape.at(-1)){if(2==t.shape.at(-1))return Be(o,p,w),Ge(w,Be(u,f),w),w;if(3!=t.shape.at(-1))throw"b.shape.at(-1) != 3";Be(u,c,m),Be(o,c,y),Ve(y,y),Be(o,p,g),Ge(g,Be(u,f),g)}else{if(3!=e.shape.at(-1))throw"a.shape.at(-1) != 3";if(3==t.shape.at(-1)){Be(u,c,m);let e=Be(h,p);Ge(m,e,m),Be(h,f,y),Be(o,c,e),Ge(y,e,y),Be(o,p,g),Be(u,f,e),Ge(g,e,g)}else{if(2!=t.shape.at(-1))throw"b.shape.at(-1) != 2";Be(h,p,m),Ve(m,m),Be(h,f,y),Be(o,p,g),Ge(g,Be(u,f),g)}}return Pe(w,-1,l)}function Wr(e,t=null,r=1,n=-1){e=V(e);let{ndim:a}=e;n=va(n,a);let l=r;if(null!=t)if(1==(t=V(t)).ndim){l=Rt(t);let e=Array(a).fill(1);e[n]=l.shape[0],l=l.reshape(e)}else l=Rt(t,null,n);let s,i=Array(a).fill(_()),d=Array(a).fill(_());return i[n]=_(1,null),d[n]=_(null,-1),s=De(e.get(i),e.get(d)),Be(l,s,s),Xe(s,2,s),Jt(s,n)}function Hr(e,t,r="full"){if(e=ie(e),t=ie(t),0==e.size)throw"a cannot be empty";if(0==t.size)throw"v cannot be empty";if(e.ndim>1||t.ndim>1)throw"object too deep for desired array";if(t.ndim>e.ndim){let r=e;e=t,t=r}let n=e.size;if("valid"==r)n+=1-t.size;else if("full"==r)n+=t.size-1;else if("same"!=r)throw`mode must be one of 'valid', 'same', or 'full' (got '${r}')`;let a=Array(n),l=0;if("valid"!=r)for(let r=0;r<t.size-1;r++){let n=0;for(let a=r+1,l=0;a--;l++)n+=e.item(l)*t.item(a);a[l++]=n}for(let r=0;r<e.size+1-t.size;r++){let n=0;for(let a=0,l=t.size-1;a<t.size;a++,l--)n+=e.item(r+a)*t.item(l);a[l++]=n}if("valid"!=r)for(let r=0;r<t.size-1;r++){let n=0;for(let a=0;a<t.size-1-r;a++)n+=e.item(e.size-t.size+1+r+a)*t.item(t.size-1-a);a[l++]=n}return"same"==r&&(a=a.slice((t.size-1)/2|0,((t.size-1)/2|0)+n)),E(a)}function Jr(e,t,r,n=null){if(e=V(e),null==n)n=X(e);else if(!Fe(e.shape,n.shape))throw"out shape does not match input shape";if($(t)&&$(r)){let a=Ba(e.shape,e.strides)[Symbol.iterator]();for(let l of Ba(n.shape,n.strides))n.data[l]=Math.min(Math.max(t,e.data[a.next().value]),r);return n}t=T(t,e.shape),r=T(r,e.shape);let a=Ba(e.shape,e.strides)[Symbol.iterator](),l=Ba(t.shape,t.strides)[Symbol.iterator](),s=Ba(r.shape,r.strides)[Symbol.iterator]();for(let i of Ba(n.shape,n.strides))n.data[i]=Math.min(Math.max(t.data[l.next().value],e.data[a.next().value]),r.data[s.next().value]);return n}function Kr(e,t=-1,r=null){e=V(e),null==t?(e=Ae(e),t=0):t=va(t,e.ndim);let n=X(e),a=Array(e.shape[t]),l=Array(e.shape[t]),s=(e,t)=>a[e]-a[t],i=e.shape.slice();i[t]=1;for(let d of L(i)){let{offset:o}=e,{offset:u}=n;for(let t=0;t<i.length;t++)o+=d[t]*e.strides[t],u+=d[t]*n.strides[t];for(let n=0;n<e.shape[t];n++){let s=e.data[o+n*e.strides[t]];a[n]=null!=r?r(s):s,l[n]=n}l.sort(s);for(let r=0;r<e.shape[t];r++)n.data[u+r*n.strides[t]]=l[r]}return n}function Qr(e,t=-1,r=null){e=V(e),null==t?(e=Ae(e),t=0):t=va(t,e.ndim);let n=X(e),a=Array(e.shape[t]),l=(e,t)=>e-t,s=e.shape.slice();s[t]=1;for(let i of L(s)){let{offset:d}=e,{offset:o}=n;for(let t=0;t<s.length;t++)d+=i[t]*e.strides[t],o+=i[t]*n.strides[t];for(let n=0;n<e.shape[t];n++){let l=e.data[d+n*e.strides[t]];a[n]=null!=r?r(l):l}a.sort(l);for(let r=0;r<e.shape[t];r++)n.data[o+r*n.strides[t]]=a[r]}return n}function Rr(e,t,r,n=null,a=null,l=null){if([e,t,r]=[e,t,r].map((e=>V(e))),1!=t.ndim||1!=r.ndim)throw"Data points must be 1-D sequences";if(t.shape[0]!=r.shape[0])throw"fp and xp are not of the same length";if(null!=l){e=Qe(e,l);let n=Kr(t=Qe(t,l));t=t.at(n),r=r.at(n),t=Te([Ge(t.at(_(-1)),l),t,De(t.at(_(0,1)),l)]),r=Te([r.at(_(-1)),r,r.at(_(0,1))])}n??=r.item(0),a??=r.item(-1);let s=Array(e.size),i=0,d=t.item(0),o=t.item(-1);for(let l of e.flat){let e;if(l<d)e=n;else if(l>o)e=a;else{let n=1;for(;n<t.length&&l>t.item(n);n++);let a=t.item(n-1);if(l==a)e=r.item(n-1);else{let s=t.item(n);if(l==s)e=r.item(n);else{let t=r.item(n-1);e=(l-a)*(r.item(n)-t)/(s-a)+t}}}s[i++]=e}return E(s).reshape(e.shape)}function Yr(e){let t=Array(e.length),r=t[0]=e[0];for(let n=1;n<e.length;n++)t[n]=r+=e[n];return t}function Zr(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}function en(e,t,r){let n=r()*t,a=e.length-1;for(let t=0;t<a;t++)if(n-=e[t],n<0)return t;return a}function tn(e,t,r){let n=r()*t,a=0,l=e.length-1;for(;a<l;){let t=a+l>>1;n>e[t]?a=t+1:l=t}return a}function rn(e){let t=e.length,r=[],n=[],a=t/Zr(e);e=e.map((e=>e*a));for(let a=0;a<t;a++)e[a]<1?r.push(a):n.push(a);let l=Array(t),s=Array(t);for(;r.length>0&&n.length>0;){let t=r.pop(),a=n.pop();l[t]=e[t],s[t]=a,e[a]=e[a]+e[t]-1,e[a]<1?r.push(a):n.push(a)}for(;n.length>0;)l[n.pop()]=1;for(;r.length>0;)l[r.pop()]=1;return{n:t,prob:l,alias:s}}function nn(e,t,r,n){let a=n()*e|0;return n()<t[a]?a:r[a]}function an(e){let t=e.length,r=Math.ceil(Math.log2(t)),n=1<<r,a=Array(2*n-1),l=n-1;for(let r=0;r<t;r++)a[l+r]=e[r];for(let e=t;e<n;e++)a[l+e]=0;let s=l;for(;n>1;){let e=s;s-=n>>=1;for(let t=0;t<n;t++)a[s+t]=a[e]+a[e+1],e+=2}return{tree:a,level:r,offset:l}}function ln(e,t,r,n){let a=n-e[r+=t];for(;r>=0;)e[r]+=a,r=r-1>>1}function sn(e,t,r,n){let a=n()*e[0],l=1;for(;--t;)a>e[l]&&(a-=e[l++]),l=2*l+1;return a>e[l]&&l++,l-r}function dn(e,t=null,r=!0,n="auto",a=Array(e),l=Math.random){let s=t.length;if(r||=1==e,r)switch("auto"==n&&(n=1==e||e*s<600?"linear":e>(s>100?2*s:50)?"alias":"binary"),n){case"linear":{let r=Zr(t);for(let n=0;n<e;n++)a[n]=en(t,r,l);break}case"binary":{let r=Yr(t),n=r.at(-1);for(let t=0;t<e;t++)a[t]=tn(r,n,l);break}case"alias":{let{n:r,prob:n,alias:s}=rn(t);for(let t=0;t<e;t++)a[t]=nn(r,n,s,l);break}case"sumtree":{let{tree:r,level:n,offset:s}=an(t);for(let t=0;t<e;t++)a[t]=sn(r,n,s,l);break}default:throw`unexpected method '${n}'`}else{if(e>t)throw"size > p is not allowed when replace = true";switch("auto"==n&&(n=s+e<150?"linear":s+e<200?"binary":"sumtree"),n){case"linear":{let r=Zr(t);t=t.slice();for(let n=0;n<e;n++){let e=a[n]=en(t,r,l);r-=t[e],t[e]=0}break}case"binary":{let r=Yr(t),n=r.at(-1);for(let s=0;s<e;s++){let e=a[s]=tn(r,n,l),i=t[s];for(let t=e;t<r.length;t++)r[t]-=i;n-=i}break}case"alias":t=t.slice();for(let r=0;r<e;r++){let{n:e,prob:n,alias:s}=rn(t);t[a[r]=nn(e,n,s,l)]=0}break;case"sumtree":{let{tree:r,level:n,offset:s}=an(t);for(let t=0;t<e;t++)ln(r,s,a[t]=sn(r,n,s,l),0);break}default:throw`unexpected method '${n}'`}}return a}function on(e,t=null,r=!0,n=null){if(1!=(e="number"==typeof e?K(e):V(e)).ndim)throw"'p' must be 1-dimensional";if(0==e.size)throw"'a' cannot be empty unless no samples are taken";if(null==n)n=Array(e.size).fill(1/e.size);else{if(1!=(n=V(n)).ndim)throw"'p' must be 1-dimensional";if(n.size!=e.size)throw"'a' and 'p' must have same size";n=n.toarray()}if(e=e.toarray(),null==t)return e[dn(1,n)[0]];"number"==typeof t&&(t=[t]);let a=function(e){let t=1;for(let r of e)t*=r;return t}(t);if(Ne(n)<a)throw"Fewer non-zero entries in p than size";return E(dn(a,n,r).map((t=>e[t]))).reshape(t)}function un(e=null){if(null==e)return Math.random();"number"==typeof e&&(e=[e]);let t=function(e){let t=1;for(let r of e)t*=r;return t}(e),r=Array(t);for(let e=0;e<t;e++)r[e]=Math.random();return E(r).reshape(e)}s.add(Or,(()=>Or([0,1,3],K(3))),(()=>E([!0,!0,!1]))).add(Or,(()=>Or(1,Z(1))),(()=>E([!0]))).add(Or,(()=>Or(E([2,4,6]),E([2,4,2]))),(()=>E([!0,!0,!1]))),s.add(qr,(()=>qr([1,2],[1,3])),(()=>E([!1,!0]))).add(qr,(()=>qr([1,2],[[1,3],[1,4]])),(()=>E([[!1,!0],[!1,!0]]))),s.add(Ir,(()=>Ir([4,2,1],[2,2,2])),(()=>E([!1,!0,!0]))),s.add(Fr,(()=>Fr([1,2],[2,2])),(()=>E([!0,!1]))),s.add(Pr,(()=>Pr([4,2,1],[2,2,2])),(()=>E([!0,!0,!1]))),s.add(Tr,(()=>Tr([4,2],[2,2])),(()=>E([!0,!1]))),s.add(Gr,(()=>Gr([1,2,3],[4,5,6])),(()=>E([-3,6,-3]))).add(Gr,(()=>Gr([1,2],[4,5,6])),(()=>E([12,-6,-3]))).add(Gr,(()=>Gr([1,2,0],[4,5,6])),(()=>E([12,-6,-3]))).add(Gr,(()=>Gr([1,2],[4,5])),(()=>E(-3))).add(Gr,(()=>Gr(E([[1,2,3],[4,5,6]]),E([[4,5,6],[1,2,3]]))),(()=>E([[-3,6,-3],[3,-6,3]]))).add(Gr,(()=>Gr(E([[1,2,3],[4,5,6]]),E([[4,5,6],[1,2,3]]),void 0,void 0,void 0,0)),(()=>E([[-3,3],[6,-6],[-3,3]]))).add(Gr,(()=>{let e=E([[1,2,3],[4,5,6],[7,8,9]]),t=E([[7,8,9],[4,5,6],[1,2,3]]);return[Gr(e,t),Gr(e,t,void 0,0,0)]}),(()=>[E([[-6,12,-6],[0,0,0],[6,-12,6]]),E([[-24,48,-24],[-30,60,-30],[-36,72,-36]])])),s.add(Wr,(()=>Wr([1,2,3])),(()=>4)).add(Wr,(()=>Wr([1,2,3],[4,6,8])),(()=>8)).add(Wr,(()=>Wr([1,2,3],null,2)),(()=>8)).add(Wr,(()=>Wr([1,2,3],[8,6,4])),(()=>-8)).add(Wr,(()=>Wr(K(6).reshape(2,3),void 0,void 0,0)),(()=>E([1.5,2.5,3.5]))).add(Wr,(()=>Wr(K(6).reshape(2,3),void 0,void 0,1)),(()=>E([2,8]))),s.add(Hr,(()=>Hr([1,2,3],[0,1,.5])),(()=>E([0,1,2.5,4,1.5]))).add(Hr,(()=>Hr([1,2,3],[1,.5],"full")),(()=>E([1,2.5,4,1.5]))).add(Hr,(()=>Hr([1,2,3],[0,1,.5],"same")),(()=>E([1,2.5,4]))).add(Hr,(()=>Hr([1,2,3],[0,1,.5],"valid")),(()=>E([2.5]))),s.add(Jr,(()=>Jr(K(10),1,8)),(()=>E([1,1,2,3,4,5,6,7,8,8]))).add(Jr,(()=>Jr(K(10),8,1)),(()=>E([1,1,1,1,1,1,1,1,1,1]))).add(Jr,(()=>{let e=K(10);return[Jr(e,3,6,e),e]}),(()=>[E([3,3,3,3,4,5,6,6,6,6]),E([3,3,3,3,4,5,6,6,6,6])])).add(Jr,(()=>Jr(K(10),[3,4,1,1,1,4,4,4,4,4],8)),(()=>E([3,4,2,3,4,5,6,7,8,8]))),Kr(E([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),0),s.add(Kr,(()=>Kr([3,1,2])),(()=>E([1,2,0]))).add(Kr,(()=>Kr(E([[0,3],[2,2]]),0)),(()=>E([[0,1],[1,0]]))).add(Kr,(()=>Kr(E([[0,3],[2,2]]),1)),(()=>E([[0,1],[0,1]]))).add(Kr,(()=>Kr(E([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),0)),(()=>E([[[0,0],[0,1],[0,1]],[[1,1],[1,0],[1,0]]]))).add(Kr,(()=>Kr(E([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),1)),(()=>E([[[0,1],[1,2],[2,0]],[[1,2],[2,1],[0,0]]]))).add(Kr,(()=>Kr(E([[[0,3],[2,2],[2,2]],[[8,5],[4,1],[6,-2]]]),2)),(()=>E([[[0,1],[0,1],[0,1]],[[1,0],[1,0],[1,0]]]))),s.add(Qr,(()=>Qr(E([[1,4],[3,1]]))),(()=>E([[1,4],[1,3]]))).add(Qr,(()=>Qr(E([[1,4],[3,1]]),null)),(()=>E([1,1,3,4]))).add(Qr,(()=>Qr(E([[1,4],[3,1]]),0)),(()=>E([[1,1],[3,4]]))),s.add(Rr,(()=>Rr(2.5,[1,2,3],[3,2,0])),(()=>1)).add(Rr,(()=>Rr(4.5,[6,4,5],[3,2,0])),(()=>3)).add(Rr,(()=>Rr([0,1,1.5,2.5,3.14],[1,2,3],[3,2,0])),(()=>E([3,3,2.5,1,0]))).add(Rr,(()=>Rr([-180,-170,-185,185,-10,-5,0,365],[190,-190,350,-350],[5,10,3,4],null,null,360)),(()=>E([7.5,5,8.75,6.25,3,3.25,3.5,3.75])));const hn=un,fn=un;function pn(...e){return un(e)}function cn(e,t=null,r=null,n=!0){if(null!=r){if(!ae(r))throw"output array must be contiguous";null==t&&(t=r.shape)}let a;if(null==t){if(n)return e();a=[],t=1}else"number"==typeof t?a=[t]:(a=t,t=M(a));if(null==r)r=B(a);else if(!Fe(a,r.shape))throw"size must match out.shape when used together";let{data:l,offset:s}=r;for(let r=0;r<t;r++)l[s+r]=e();return r}class mn{constructor(e=Math.random){this.rand=e}integers(e,t=null,r=null,n=!1){null==t&&(t=e,e=0);let a=t-e;return n&&(a+=1),cn((()=>this.rand()*a+e|0),r)}random(e=null,t=null){return cn((()=>this.rand()),e,t)}choice(e,t=null,r=!0,n=null,a=0){if("number"==typeof e){if(e<=0)throw"a must be a positive integer unless no samples are taken";e=K(e)}else if(0==(e=V(e)).size)throw"a cannot be empty unless no samples are taken";if(null==n)n=Array(e.shape[a]).fill(1/e.shape[a]);else{if(1!=(n=V(n)).ndim)throw"p must be 1-dimensional";if(n.size!=e.shape[a])throw"a and p must have same size";n=n.toarray()}let l=Array(a).fill(_());if(null==t)return l[a]=dn(1,n,void 0,void 0,void 0,this.rand)[0],e._getview(l).copy();let s=t;if("number"==typeof t&&(s=[t]),t=M(s),n.length<t)throw"Cannot take a larger sample than population when replace is false";if(Ne(n)<t)throw"Fewer non-zero entries in p than size";let i=[...e.shape];i.splice(a,1,...s);let d=Array(a).fill(_()),o=B(i),u=dn(t,n,r,void 0,void 0,this.rand),h=0;for(let t of L(s)){for(let e=0;e<t.length;e++)d[a+e]=t[e];l[a]=u[h++],o.set(d,e._getview(l))}return o}shuffle(e,t=0){t=va(t,(e=V(e)).ndim);let r=Array(t+1).fill(_(":")),{shape:n}=e,a=n[t],l=B([...n.slice(0,t),...n.slice(t+1)]);for(let n=0;n<a-2;n++){let s=this.rand()*(a-n)+n|0;r[t]=n;let i=e._getview(r);r[t]=s;let d=e._getview(r);l.set(i),i.set(d),d.set(l)}}permuted(e,t=null,r=null){t=va(t,(e=V(e)).ndim);let n=[...e.shape];n[t]=1,null==r&&(r=X(e));for(let a of L(n)){a[t]=_();let n=e._getview(a).flatten();this.shuffle(n),r.set(a,n)}return r}permutation(e,t=0){return e="number"==typeof e?K(e):E(e),this.shuffle(e,t),e}uniform(e=0,t=1,r=null){return cn((()=>this.rand()*(t-e)+e),r)}normal(e=0,t=1,r=null){return cn((()=>{let r=this.rand(),n=this.rand(),a=Math.sqrt(-2*Math.log(r))*Math.cos(2*Math.PI*n);return e+t*a}),r)}}const yn=new mn;function gn(e,t=null,r=null){if(null==t&&null==r)return _e(e);let n=ue(e,t,r),a=B(n.shape),l=0;for(let[e,t,r]of n)a.data[l++]=e?t:r;return a}function wn(...e){let t=[];for(let r=0;r<e.length;r++){let{start:n,stop:a,step:l,slicelength:s}=e[r].indices(),i=Array(s);for(let e=0;e<s;e++)i[e]=n+e*l;let d=Array(e.length).fill(1);d[r]=s,t.push(E(i).reshape(d))}return t}function bn(e,t=null,r=null,n=!1){e=V(e),null==t?(e=Ae(e),t=0):t=va(t,e.ndim);let a=[...e.shape.slice(0,t),...n?[1]:[],...e.shape.slice(t+1)];if(null==r)r=B(a);else if(!Fe(a,r.shape))throw"out must have the same shape as the expected output";return Ge(yr(e,t,null,n),gr(e,t,null,n),r),r}function xn(e,t=null,r=null,n=!1,a=!1){let l;if(e=V(e),null==t?(e=Ae(e),t=0):t=va(t,e.ndim),null!=r&&(r=V(r)),null!=r){if(l=Jt(r),0==l)throw"sum(weights) must not be 0";if(1==r.ndim)r=r.reshape([...Array(t).fill(1),e.shape[t]]);else if(!Fe(r.shape,e.shape))throw"weights.shape and a.shape do not match";e=Be(e,r)}else l=e.shape[t];let s=Xe(Jt(e,t,null,a),l);return n?[s,l]:s}function _n(e,t=null,r=null,n=!1){e=V(e),null==t?(e=Ae(e),t=0):t=va(t,e.ndim);let a=[...e.shape.slice(0,t),...n?[1]:[],...e.shape.slice(t+1)];if(null==r)r=B(a);else if(!Fe(a,r.shape))throw"out must have the same shape as the expected output";return Xe(Jt(e,t,null,n),e.shape[t],r),r}function $n(e,t=null,r=null,n=0,a=!1){e=V(e),null==t?(e=Ae(e),t=0):t=va(t,e.ndim);let l=[...e.shape.slice(0,t),...a?[1]:[],...e.shape.slice(t+1)];if(null==r)r=B(l);else if(!Fe(l,r.shape))throw"out must have the same shape as the expected output";return _n(xr(Ge(e,Xe(Jt(e,t,null,!0),e.shape[t]-n))),t,r,a),r}function vn(e,t=null,r=null,n=0,a=!1){return r=$n(e,t,r,n,a),wr(r,r),r}function An(e,t=null,r=0){if(1!=(e=V(e)).ndim)throw"a.dim != 1";if(gr(e)<0)throw"amin(a) < 0";if(r<0)throw"minlength < 0";if(null!=t){if(!Fe((t=V(t)).shape,e.shape))throw"weights.shape != a.shape";t=t.toarray()}let n=Array(Math.max(yr(e)+1,r)).fill(0),a=0;for(let r of e.flat)n[r]+=null!=t?t[a]:1,a++;return E(n)}function zn(e,t=!1){let r,n=e.length,a=Array(n).fill(1);r=t?[]:B([n,...e]);for(let n=0;n<e.length;n++){let l=e[n],s=K(l).reshape([...a.slice(0,n),l,...a.slice(n+1)]);t?r.push(s):r.set([n],s)}return r}function Mn(...e){let t=[],r=e.length;for(let n=0;n<r;n++){let a=e[n];a=V(a),a.ndim,"boolean"==typeof a.item(0)&&([a]=_e(a)),a=a.reshape([...Array(n).fill(1),a.size,...Array(r-n-1).fill(1)]),t.push(a)}return t}function Nn(e,t,r=!1,n=!1,a="table"){throw new Error}function kn(e,t=null,r="big"){e=V(e),null==t?(e=Ae(e),t=0):t=va(t,e.ndim);let n=e.shape.slice();n[t]=Math.ceil(n[t]/8);let a=B(n),l=e.shape.slice();l[t]=1;let s=Array(8*n[t]);for(let n of L(l)){let{offset:i}=e,{offset:d}=a;for(let t=0;t<l.length;t++)i+=n[t]*e.strides[t],d+=n[t]*a.strides[t];s.fill(0);for(let r=0;r<e.shape[t];r++){let n=e.data[i+r*e.strides[t]];s[r]=n}let o=0;for(let e=0;e<s.length;e+=8){let n=0;if("big"==r)for(let t=0;t<8;t++)n+=s[e+t]<<7-t;else{if("little"!=r)throw"bitorder can be either big or little";for(let t=0;t<8;t++)n+=s[e+t]<<t}a.data[d+o*a.strides[t]]=n,o++}}return a}function En(e,t=null,r=null,n="big"){e=V(e),null==t?(e=Ae(e),t=0):t=va(t,e.ndim);let a=0,l=8;null!=r&&(r<0?a=8-r:l=r);let s=e.shape.slice();s[t]=s[t]*(l-a);let i=B(s),d=Array(8);for(let r of L(e.shape)){let{offset:s}=e,{offset:o}=i;for(let t=0;t<e.shape.length;t++)s+=r[t]*e.strides[t],o+=r[t]*i.strides[t];jn(e.data[s],d,n);for(let e=a,r=0;e<l;e++,r++)i.data[o+r*i.strides[t]]=d[e]}return i}function jn(e,t=[],r="big"){if("big"==r)for(let r=7;r>=0;r--)t[r]=e%2,e=e/2|0;else for(let r=0;r<=7;r++)t[r]=e%2,e=e/2|0;return t}function Sn(e,t=0,r=null){if(0==(e=e.map((e=>V(e)))).length)throw"need at least one array to stack";for(let t=1;t<e.length;t++)if(!Fe(e[0],e[t]))throw"all input arrays must have the same shape";t=va(t,e[0].ndim+1);let n=[...Array(t).fill(y.colon),y.newaxis];return Te(e.map((e=>e.get(n))),t,r)}function On(e){return e=de(...e),Array.isArray(e)||(e=[e]),Te(e,0)}function qn(e){return e=ie(...e),Array.isArray(e)||(e=[e]),e.length>0&&1==e[0].ndim?Te(e,0):Te(e,1)}function Fn(e){return e=oe(...e),Array.isArray(e)||(e=[e]),Te(e,2)}function In(e){let t=[];for(let r of e)r=V(r),r.ndim<2&&(r=E(r,null,!1,2).T),t.push(r);return Te(t,1)}function Tn(e){return e=de(...e),Array.isArray(e)||(e=[e]),Te(e,0)}function Pn(e,t,r=0){let n,a,l;if(null!=e.shape?(r=va(r,e.ndim),n=e.shape[r]):n=e.length,"number"==typeof t){if(a=0|t,a<=0)throw"number sections must be larger than 0.";let e=n/a|0,r=n%a;l=E([0,...Array(r).fill(e+1),...Array(a-r).fill(e)]).cumsum().array()}else a=t.length+1,l=[0,...t,n];let s=[],i=le(e,r,0);for(let e=0;e<a;e++){let t=l[e],n=l[e+1];s.push(le(i.at(_(t,n)),r,0))}return s}function Dn(e,t,r=0){if(r=va(r,(e=V(e)).ndim),null!=t.shape&&(t=t.array()),null==t.length){let n=t;if(e.shape[r]%n)throw"array split does not result in an equal division"}return Pn(e,t,r)}function Ln(e,t){if(ce(e)<3)throw"dsplit only works on arrays of 3 or more dimensions";return Dn(e,t,2)}function Un(e,t){if(0==ce(e))throw"hsplit only works on arrays of 1 or more dimensions";return Dn(e,t,ce(e)>1?1:0)}function Vn(e,t){if(ce(e)<2)throw"vsplit only works on arrays of 2 or more dimensions";return Dn(e,t,0)}function Bn(e,t,r=null){e=V(e),null==r?(e=Ae(e),r=0):r=va(r,e.ndim);let n=e.shape.slice(),a="number"==typeof t;if(a)n[r]*=t;else if(1==t.length)t=t[0],n[r]*=t,a=!0;else{if(n[r]!=t.length)throw`operands could not be broadcast together with shape (${n[r]},) (${t.length},)`;n[r]=t.reduce(((e,t)=>e+t))}let l=B(n),s=l.strides.slice();s.splice(r,1);let i=e.shape.slice();i.splice(r,1);let d=e.strides.slice();d.splice(r,1);let o=n[r];for(let n of L(i)){let i=0,u=0;for(let e=0;e<n.length;e++)i+=n[e]*d[e],u+=n[e]*s[e];let h=0;for(let n=0;n<o;n++){let s=e.data[i+n*e.strides[r]],d=a?t:t[n];for(let e=0;e<d;e++,h++)l.data[u+h*l.strides[r]]=s}}return l.astype(e.dtype)}function Xn(e,t){"number"==typeof t&&(t=[t]);let r=t.length;if(t.every((e=>1==e))&&e instanceof A)return E(e,e.dtype,!0,r);let n=E(e,e.dtype,!1,r);r<n.ndim&&(t=[...Array(n.ndim-r).fill(1),...t]);let a=n.shape.map(((e,r)=>e*t[r])),l=n.size;if(l>0){let{ndim:e,shape:r}=n;for(let a=0;a<e;a++){let e=r[a],s=t[a];1!=s&&(n=n.reshape(-1,l).repeat(s,0)),l=l/e|0}}return n.reshape(a)}function Cn(e,t=0,r=0,n=1){e=V(e);let{ndim:a}=e;if(a<2)throw"array.ndim must be >= 2";r=va(r,a),n=va(n,a);let l=Array(a);l[a-2]=r,l[a-1]=n;for(let e=0,t=0;e<a;e++)e!=r&&e!=n&&(l[t++]=e);let s,i,d=(e=se(e,l)).shape[a-2],o=e.shape[a-1],u=o+1;t<0?(s=-o*t,i=Math.min(o,d+t)*(o+1)-o*t):(s=t,i=Math.min(d,o-t)*(o+1)+t);let h=Math.ceil((i-s)/u);return e.as_strided([...e.shape.slice(0,-2),h],[...e.strides.slice(0,-2),u*e.strides[a-1]],e.offset+s)}function Gn(e,t=0){let r=(e=V(e)).shape;if(1==r.length){let n=r[0]+Math.abs(t),a=te([n,n]),l=t>=0?t:-t*n,s=a.at(_(null,n-t));for(let t=0;t<e.size;t++,l+=n+1)s.itemset(l,e.item(t));return a}if(2!=r.length)throw"Input must be 1- or 2-d.";return Cn(e,t)}function Wn(e,t=null){let r;if(e=V(e),null==t)r=Array(e.ndim).fill(_("::-1"));else{t=Ee(t,e.ndim),r=Array(e.ndim).fill(_(":"));for(let e of t)r[e]=_("::-1")}return e.get(r)}function Hn(e){if((e=V(e)).ndim<2)throw"Input must be >= 2-d.";return e.get(Rn(":","::-1"))}function Jn(e){if((e=V(e)).ndim<1)throw"Input must be >= 1-d.";return e.at(_("::-1"))}s.add(gn,(()=>{let e=K(10);return gn(Fr(e,5),e,Be(10,e))}),(()=>E([0,1,2,3,4,50,60,70,80,90]))).add(gn,(()=>gn([[!0,!1],[!0,!0]],[[1,2],[3,4]],[[9,8],[7,6]])),(()=>E([[1,8],[3,4]]))).add(gn,(()=>{let[e,t]=wn(_(":3"),_(null,4));return gn(Fr(e,t),e,De(10,t))}),(()=>E([[10,0,0,0],[10,11,1,1],[10,11,12,2]]))).add(gn,(()=>{let e=E([[0,1,2],[0,2,4],[0,3,6]]);return gn(Fr(e,4),e,-1)}),(()=>E([[0,1,2],[0,2,-1],[0,3,-1]]))),s.add(wn,(()=>wn(_("0:5"),_("0:5"))),(()=>[E([[0],[1],[2],[3],[4]]),E([[0,1,2,3,4]])])).add(wn,(()=>wn(_("3:5"),_("0:-5"),_("0:1"))),(()=>[E([[[3]],[[4]]]),E([]).reshape([1,0,1]),E([[[0]]])])),s.add(bn,(()=>bn(E([[4,9,2,10],[6,9,7,12]]),1)),(()=>E([8,6]))).add(bn,(()=>bn(E([[4,9,2,10],[6,9,7,12]]),0)),(()=>E([2,0,5,2]))).add(bn,(()=>bn(E([[4,9,2,10],[6,9,7,12]]))),(()=>10)).add(bn,(()=>bn(Ce(K(10,40),2).reshape(5,2,3),0,null,!0)),(()=>E([[[1056,1104,1152],[1200,1248,1296]]]))),s.add(xn,(()=>xn(K(1,5))),(()=>2.5)).add(xn,(()=>xn(K(1,11),void 0,K(10,0,-1))),(()=>4)).add(xn,(()=>xn(K(6).reshape(3,2),1,[1/4,3/4])),(()=>E([.75,2.75,4.75]))).add(xn,(()=>xn(K(6).reshape(3,2),1,void 0,void 0,!0)),(()=>E([[.5],[2.5],[4.5]]))),s.add(_n,(()=>_n(E([[1,2],[3,4]]))),(()=>2.5)).add(_n,(()=>_n(E([[1,2],[3,4]]),0)),(()=>E([2,3]))).add(_n,(()=>_n(E([[1,2],[3,4]]),1)),(()=>E([1.5,3.5]))),s.add($n,(()=>$n(E([[1,2],[3,4]]))),(()=>1.25)).add($n,(()=>$n(E([[1,2],[3,4]]),0)),(()=>E([1,1]))).add($n,(()=>$n(E([[1,2],[3,4]]),1)),(()=>E([.25,.25]))),s.add(vn,(()=>vn(E([[1,2],[3,4]]))),(()=>1.118033988749895)).add(vn,(()=>vn(E([[1,2],[3,4]]),0)),(()=>E([1,1]))).add(vn,(()=>vn(E([[1,2],[3,4]]),1)),(()=>E([.5,.5]))),s.add(An,(()=>An(K(5))),(()=>E([1,1,1,1,1]))).add(An,(()=>An(E([0,1,1,3,2,1,7]))),(()=>E([1,3,1,1,0,0,0,1]))).add(An,(()=>An(E([0,1,1,2,2,2]),E([.3,.5,.2,.7,1,-.6]))),(()=>E([.3,.7,1.1]))),s.add(zn,(()=>zn([2,3])),(()=>E([[[0,0,0],[1,1,1]],[[0,1,2],[0,1,2]]]))).add(zn,(()=>zn([2,3],!0)),(()=>[E([[0],[1]]),E([[0,1,2]])])),s.add(Mn,(()=>Mn([0,1],[2,4])),(()=>[E([[0],[1]]),E([[2,4]])])).add(Mn,(()=>Mn([!0,!0],[2,4])),(()=>[E([[0],[1]]),E([[2,4]])])).add(Mn,(()=>Mn([!0,!0],[!1,!1,!0,!1,!0])),(()=>[E([[0],[1]]),E([[2,4]])])),s.add(kn,(()=>kn(E([[[1,0,1],[0,1,0]],[[1,1,0],[0,0,1]]]),-1)),(()=>E([[[160],[64]],[[192],[32]]]))).add(kn,(()=>kn(E([[[1,0,1],[0,1,0]],[[1,1,0],[0,0,1]]]))),(()=>E([171,16]))).add(kn,(()=>kn(E([[[1,0,1,0,0,0,0,0,0,0,0,0,0]]]),-1)),(()=>E([[[160,0]]]))),s.add(En,(()=>En(E([[2],[7],[23]]),1)),(()=>E([[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,1,1],[0,0,0,1,0,1,1,1]]))).add(En,(()=>{let e=E([[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,1,1],[0,0,0,1,0,1,1,1]]),t=kn(e,0);return[En(t,0),Oe(e,En(t,0,e.shape[0]))]}),(()=>[E([[0,0,0,0,0,0,1,0],[0,0,0,0,0,1,1,1],[0,0,0,1,0,1,1,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]),!0])),s.add(Sn,(()=>Sn(Array(10).fill().map((()=>yn.normal(0,1,[3,4]))),0).shape),(()=>[10,3,4])).add(Sn,(()=>Sn(Array(10).fill().map((()=>yn.normal(0,1,[3,4]))),1).shape),(()=>[3,10,4])).add(Sn,(()=>Sn(Array(10).fill().map((()=>yn.normal(0,1,[3,4]))),2).shape),(()=>[3,4,10])).add(Sn,(()=>Sn([E([1,2,3]),E([4,5,6])])),(()=>E([[1,2,3],[4,5,6]]))).add(Sn,(()=>Sn([E([1,2,3]),E([4,5,6])],-1)),(()=>E([[1,4],[2,5],[3,6]]))),s.add(On,(()=>On([E([1,2,3]),E([4,5,6])])),(()=>E([[1,2,3],[4,5,6]]))).add(On,(()=>On([E([[1],[2],[3]]),E([[4],[5],[6]])])),(()=>E([[1],[2],[3],[4],[5],[6]]))),s.add(qn,(()=>qn([E([1,2,3]),E([4,5,6])])),(()=>E([1,2,3,4,5,6]))).add(qn,(()=>qn([E([[1],[2],[3]]),E([[4],[5],[6]])])),(()=>E([[1,4],[2,5],[3,6]]))),s.add(Fn,(()=>Fn([E([1,2,3]),E([2,3,4])])),(()=>E([[[1,2],[2,3],[3,4]]]))).add(Fn,(()=>Fn([E([[1],[2],[3]]),E([[2],[3],[4]])])),(()=>E([[[1,2]],[[2,3]],[[3,4]]]))),s.add(In,(()=>In([E([1,2,3]),E([2,3,4])])),(()=>E([[1,2],[2,3],[3,4]]))),s.add(Tn,(()=>Tn([E([1,2,3]),E([4,5,6])])),(()=>E([[1,2,3],[4,5,6]]))).add(Tn,(()=>Tn([E([[1],[2],[3]]),E([[4],[5],[6]])])),(()=>E([[1],[2],[3],[4],[5],[6]]))),s.add(Pn,(()=>Pn(K(8),3)),(()=>[E([0,1,2]),E([3,4,5]),E([6,7])])).add(Pn,(()=>Pn(K(9),4)),(()=>[E([0,1,2]),E([3,4]),E([5,6]),E([7,8])])),s.add(Dn,(()=>Dn(K(9),3)),(()=>[E([0,1,2]),E([3,4,5]),E([6,7,8])])).add(Dn,(()=>Dn(K(8),[3,5,6,10])),(()=>[E([0,1,2]),E([3,4]),E([5]),E([6,7]),E([])])),s.add(Ln,(()=>Ln(K(16).reshape(2,2,4),2)),(()=>[E([[[0,1],[4,5]],[[8,9],[12,13]]]),E([[[2,3],[6,7]],[[10,11],[14,15]]])])).add(Ln,(()=>Ln(K(16).reshape(2,2,4),E([3,6]))),(()=>[E([[[0,1,2],[4,5,6]],[[8,9,10],[12,13,14]]]),E([[[3],[7]],[[11],[15]]]),B([2,2,0])])),s.add(Un,(()=>Un(K(16).reshape(4,4),2)),(()=>[E([[0,1],[4,5],[8,9],[12,13]]),E([[2,3],[6,7],[10,11],[14,15]])])).add(Un,(()=>Un(K(16).reshape(4,4),E([3,6]))),(()=>[E([[0,1,2],[4,5,6],[8,9,10],[12,13,14]]),E([[3],[7],[11],[15]]),B([4,0])])).add(Un,(()=>Un(K(8).reshape(2,2,2),2)),(()=>[E([[[0,1]],[[4,5]]]),E([[[2,3]],[[6,7]]])])).add(Un,(()=>Un(E([0,1,2,3,4,5]),2)),(()=>[E([0,1,2]),E([3,4,5])])),s.add(Vn,(()=>Vn(K(16).reshape(4,4),2)),(()=>[E([[0,1,2,3],[4,5,6,7]]),E([[8,9,10,11],[12,13,14,15]])])).add(Vn,(()=>Vn(K(16).reshape(4,4),E([3,6]))),(()=>[E([[0,1,2,3],[4,5,6,7],[8,9,10,11]]),E([[12,13,14,15]]),B([0,4])])).add(Vn,(()=>Vn(K(8).reshape(2,2,2),2)),(()=>[E([[[0,1],[2,3]]]),E([[[4,5],[6,7]]])])),s.add(Bn,(()=>Bn(3,4)),(()=>E([3,3,3,3]))).add(Bn,(()=>Bn(E([[1,2],[3,4]]),2)),(()=>E([1,1,2,2,3,3,4,4]))).add(Bn,(()=>Bn(E([[1,2],[3,4]]),3,1)),(()=>E([[1,1,1,2,2,2],[3,3,3,4,4,4]]))).add(Bn,(()=>Bn(E([[1,2],[3,4]]),[1,2],0)),(()=>E([[1,2],[3,4],[3,4]]))),s.add(Xn,(()=>{let e=E([0,1,2]);return[Xn(e,2),Xn(e,[2,2]),Xn(e,[2,1,2])]}),(()=>[E([0,1,2,0,1,2]),E([[0,1,2,0,1,2],[0,1,2,0,1,2]]),E([[[0,1,2,0,1,2]],[[0,1,2,0,1,2]]])])).add(Xn,(()=>{let e=E([[1,2],[3,4]]);return[Xn(e,2),Xn(e,[2,1])]}),(()=>[E([[1,2,1,2],[3,4,3,4]]),E([[1,2],[3,4],[1,2],[3,4]])])).add(Xn,(()=>Xn(E([1,2,3,4]),[4,1])),(()=>E([[1,2,3,4],[1,2,3,4],[1,2,3,4],[1,2,3,4]]))),s.add(Cn,(()=>Cn(K(4).reshape(2,2))),(()=>E([0,3]))).add(Cn,(()=>Cn(K(4).reshape(2,2),1)),(()=>E([1]))).add(Cn,(()=>Cn(K(8).reshape(2,2,2),0,0,1)),(()=>E([[0,6],[1,7]]))).add(Cn,(()=>Cn(K(8).reshape(2,2,2).at(_(":"),_(":"),0),0,0,1)),(()=>E([0,6]))).add(Cn,(()=>Cn(K(8).reshape(2,2,2).at(_(":"),_(":"),1),0,0,1)),(()=>E([1,7]))).add(Cn,(()=>{let e=K(8);return Cn(e.reshape(2,2,2),0,0,1).set(-1),e}),(()=>E([-1,-1,2,3,4,5,-1,-1]))),s.add(Gn,(()=>Gn(K(9).reshape([3,3]))),(()=>E([0,4,8]))).add(Gn,(()=>Gn(K(9).reshape([3,3]),1)),(()=>E([1,5]))).add(Gn,(()=>Gn(K(9).reshape([3,3]),-1)),(()=>E([3,7]))).add(Gn,(()=>Gn(Gn(K(9).reshape([3,3])))),(()=>E([[0,0,0],[0,4,0],[0,0,8]]))),s.add(Wn,(()=>{let e=K(8).reshape([2,2,2]);return[e,Wn(e,0),Wn(e,1),Wn(e),Wn(e,[0,2])]}),(()=>[E([[[0,1],[2,3]],[[4,5],[6,7]]]),E([[[4,5],[6,7]],[[0,1],[2,3]]]),E([[[2,3],[0,1]],[[6,7],[4,5]]]),E([[[7,6],[5,4]],[[3,2],[1,0]]]),E([[[5,4],[7,6]],[[1,0],[3,2]]])])).add(Wn,(()=>{let e=yn.normal(0,1,[3,4,5]);return ut(Or(Wn(e,2),e.at(_(":"),_(":"),_("::-1"),_("..."))))}),(()=>!0)),s.add(Hn,(()=>Hn(Gn([1,2,3]))),(()=>E([[0,0,1],[0,2,0],[3,0,0]]))).add(Hn,(()=>{let e=yn.normal(0,1,[2,4,5]);return ut(Or(Hn(e),e.at(_(":"),_("::-1"),_("..."))))}),(()=>!0)),s.add(Jn,(()=>Jn(Gn([1,2,3]))),(()=>E([[0,0,3],[0,2,0],[1,0,0]]))).add(Jn,(()=>{let e=yn.normal(0,1,[2,3,5]);return ut(Or(Jn(e),e.at(_("::-1"),_("..."))))}),(()=>!0)).add(Jn,(()=>Jn([1,2])),(()=>E([2,1])));let Kn=e=>"number"==typeof e||e instanceof y?e:_(e);const Qn=Symbol("tupleType");function Rn(...e){let t=e.map(Kn);return t[Qn]=!0,t}function Yn(...e){return 1==e.length?Kn(e[0]):Rn(...e)}function Zn(e,t,r,n="raise"){"number"==typeof t&&(t=[t]),"number"==typeof r&&(r=[r]),t=function(e,t,r,n){if("raise"==t)return function(e,t,r){let n=Array(e.length);for(let r=0;r<e.length;r++){let a=e[r];if(a<0&&(a+=t),a<0||a>=t)throw`index ${e[r]} is out of bounds for axis 0 with size ${t}`;n[r]=a}return n}(e,r);if("wrap"==t)return function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let a=e[n]%t;a<0&&(a+=t),r[n]=a}return r}(e,r);if("clip"==t)return function(e,t){let r=Array(e.length);for(let n=0;n<e.length;n++){let a=e[n];r[n]=Math.max(0,Math.min(a,t-1))}return r}(e,r);throw`unexpected mode ${t}`}(t,n,e.size);let a=e.flat,l=r.length;for(let e=0;e<t.length;e++)a.set(t[e],r[e%l])}function ea(e,t){"number"==typeof t&&(t=[t]),e=Ae(e);let r=1;for(let e of t){if(e<0)throw"all elements of 'new_shape' must be non-negative";r*=e}if(0==e.size||0==r)return te(t);let n=Math.ceil(r/e.size);return G(e=Te(Array(n).fill(e)).at(_(0,r)),t)}function ta(e,t,r="left"){e instanceof A&&(e=e.array());let n=X(t=V(t)),a=0,l="left"==r?ra:na;for(let r of t.flat)n.data[a++]=l(e,r);return n}function ra(e,t){let r=0,n=e.length-1;for(;r<=n;){let a=r+n>>1;e[a]<t?r=a+1:n=a-1}return r}function na(e,t){let r=0,n=e.length-1;for(;r<=n;){let a=r+n>>1;e[a]>t?n=a-1:r=a+1}return r}function aa(e,t,r=null){if(e=V(e),null==r)return aa(e.ravel(),t,0).reshape(e.shape);{let n=ue(t,r=Ee(r,e.ndim,!0));if(n.ndim>1)throw new Error("'shift' and 'axis' should be scalars or 1D sequences");let a=Array(e.ndim).fill(0);for(let[e,t]of n)a[t]+=e;let l=Array(e.ndim).fill([[_(null),_(null)]]);for(let[t,r]of a.entries())r%=e.shape[t]||1,r&&(l[t]=[[_(null,-r),_(r,null)],[_(-r,null),_(null,r)]]);let s=X(e);for(let t of new la(l)){let r=t.map((e=>e[0])),n=t.map((e=>e[1]));s.set(n,e.get(r))}return s}}s.add(Yn,(()=>K(8).reshape(2,2,-1).get(Yn(0,[0,-1],"::-1"))),(()=>E([[1,0]]))),s.add(Zn,(()=>{let e=K(5);return Zn(e,[0,2],[-44,-55]),e}),(()=>E([-44,1,-55,3,4]))).add(Zn,(()=>{let e=K(5);return Zn(e,22,-5,"clip"),e}),(()=>E([0,1,2,3,-5]))),s.add(ea,(()=>ea(E([[0,1],[2,3]]),[2,3])),(()=>E([[0,1,2],[3,0,1]]))).add(ea,(()=>ea(E([[0,1],[2,3]]),[1,4])),(()=>E([[0,1,2,3]]))).add(ea,(()=>ea(E([[0,1],[2,3]]),[2,4])),(()=>E([[0,1,2,3],[0,1,2,3]]))),s.add(ta,(()=>ta([1,2,3,4,5],3)),(()=>2)).add(ta,(()=>ta([1,2,3,4,5],3,"right")),(()=>3)).add(ta,(()=>ta([1,2,3,4,5],[-10,10,2,3])),(()=>E([0,5,1,2])));class la{constructor(e){this.length=e.length,this.elements=e.map((e=>Array.from(e))),this.lengths=this.elements.map((e=>e.length)),this.size=this.lengths.reduce(((e,t)=>e*t)),this.coords=Array(this.length),this.done=this.index=void 0,this.reset()}[Symbol.iterator](){return this.reset()}reset(){return this.coords.fill(0),this.index=0,this.done=0==this.size,this}next(){if(this.done)return{done:!0};let{elements:e,coords:t,length:r,lengths:n}=this,a=e.map(((e,r)=>e[t[r]])),l=r-1,s=!0;e:for(;l>=0;)switch(n[l]){case 1:l--;break;case t[l]:t[l--]=0,s=!0;break;default:if(!s)break e;t[l]+=1,s=!1}return this.index++,this.done=this.index>=this.size,{value:a,done:!1}}}function sa(e,t){return ca(t,e)}function ia(e,t){return ya(t,e,axis)}function da(e){let t=Object.create(null);return(...r)=>t[r]??(t[r]=e(...r))}function oa(e,t,...r){return t=t.bind(null,...r),Object.defineProperty(t,"name",{value:e}),t}function ua(e,t,r=null){return Object.defineProperty(ca.bind(r,t),"name",{value:e})}function ha(e,t,r=null){return Object.defineProperty(ma.bind(r,t),"name",{value:e})}function fa(e,t,r=undefined){return Object.defineProperty(ya.bind({defaultinitial:r},t),"name",{value:e})}function pa(e,t,r=null){return Object.defineProperty(ga.bind(r,t),"name",{value:e})}function ca(e,t,r=null,n=this?.dtype){return t=V(t),null==r?r=B(t.shape,n):t=T(t,r.shape),wa(r.ndim)(e,t,r),r}function ma(e,t,r,n=null,a=this?.dtype){let l;return t=V(t),r=V(r),null==n?(l=J(t.shape,r.shape),n=B(l,a)):l=n.shape,t=T(t,l),r=T(r,l),ba(n.ndim)(e,t,r,n),n}function ya(e,t,r=null,n=null,a=!1,l=this?.defaultinitial,s=!0,i=this?.dtype){let d=$a(r,(t=V(t)).ndim),o=[],u=[];for(let e=0;e<d.length;e++)d[e]?u.push(1):(o.push(t.shape[e]),u.push(t.shape[e]));if(null==n)n=B(o,i);else if(!Fe(o,n.shape))throw new Error("unmatch shape");let h=n.reshape(u);return a&&(n=h),xa(t.ndim,d)(e,t,h,l),s&&0==n.ndim?n.item():n}function ga(e,t,r=null,n=null,a=this?.dtype){t=V(t),null==r&&(t=Ae(t));let l=$a(r,t.ndim);if(null==n)n=B(t.shape,a);else if(!Fe(t.shape,n.shape))throw new Error("unmatch shape");return _a(t.ndim,l)(e,t,n),n}function wa(e){if(0==e)return new Function("fn","x","out","\nout.data[out.offset] = fn(x.data[x.offset]);\n");let t=(t,r=", ")=>[...Array(e).keys()].map((e=>t.replaceAll("$",e))).join(r);return new Function("fn","x","out",`\nlet { data, strides, offset, shape } = out;\nlet [${t("d_$")}] = shape;\nlet [${t("s_$")}] = strides;\nlet { data: x_data, strides: x_strides, offset: x_offset } = x;\nlet [${t("x_$")}] = x_strides;\n${t("for (let i_$ = 0; i_$ < d_$; i_$++)"," ")} {\n\tdata[offset + ${t("i_$ * s_$"," + ")}] = fn(x_data[x_offset + ${t("i_$ * x_$"," + ")}]);\n}\n`)}function ba(e){if(0==e)return new Function("fn","x1","x2","out","\nout.data[out.offset] = fn(x1.data[x1.offset], x2.data[x2.offset]);\n");let t=(t,r=", ")=>[...Array(e).keys()].map((e=>t.replaceAll("$",e))).join(r);return new Function("fn","x1","x2","out",`\nlet { data, strides, offset, shape } = out;\nlet [${t("d_$")}] = shape;\nlet [${t("s_$")}] = strides;\nlet { data: x1_data, strides: x1_strides, offset: x1_offset } = x1;\nlet { data: x2_data, strides: x2_strides, offset: x2_offset } = x2;\nlet [${t("x1_$")}] = x1_strides;\nlet [${t("x2_$")}] = x2_strides;\n${t("for (let i_$ = 0; i_$ < d_$; i_$++)"," ")} {\n\tdata[offset + ${t("i_$ * s_$"," + ")}] = fn(\n\t\tx1_data[x1_offset + ${t("i_$ * x1_$"," + ")}],\n\t\tx2_data[x2_offset + ${t("i_$ * x2_$"," + ")}]\n\t);\n}\n`)}function xa(e,t){if(0==e)return new Function("fn","x","out","initial","\nout.data[out.offset] = initial != undefined ? fn(initial, x.data[x.offset]) : x.data[x.offset];\n");let r=(t,r=", ",n=[...Array(e).keys()])=>n.map((e=>t.replaceAll("$",e))).join(r),n=[...Array(e).keys()].filter((e=>!t[e])),a=[...Array(e).keys()].filter((e=>t[e]));return new Function("fn","x","out","initial",`\nlet { data, strides, offset } = out;\nlet [${r("s_$")}] = strides;\nlet { data: x_data, strides: x_strides, offset: x_offset, shape } = x;\nlet [${r("d_$")}] = shape;\nlet [${r("x_$")}] = x_strides;\n\nlet use_initial = initial != undefined;\n${r("for (let i_$ = 0; i_$ < d_$; i_$++)"," ",n)} {\n\tlet startOffset = x_offset${n.length?" + ":""}${r("i_$ * x_$"," + ",n)};\n\tlet first = !use_initial;\n\tlet accum = initial;\n\t${r("for (let i_$ = 0; i_$ < d_$; i_$++)"," ",a)} {\n\t\tif (first) {\n\t\t\tfirst = false;\n\t\t\taccum = x_data[startOffset];\n\t\t} else {\n\t\t\taccum = fn(accum, x_data[startOffset + ${r("i_$ * x_$"," + ",a)}]);\n\t\t}\n\t}\n\tdata[offset${n.length?" + ":""}${r("i_$ * s_$"," + ",n)}] = accum;\n}\n`)}function _a(e,t){if(0==e)return new Function("fn","x","out","initial","\nout.data[out.offset] = initial != undefined ? fn(initial, x.data[x.offset]) : x.data[x.offset];\n");let r=(t,r=", ",n=[...Array(e).keys()])=>n.map((e=>t.replaceAll("$",e))).join(r),n=[...Array(e).keys()].filter((e=>!t[e])),a=[...Array(e).keys()].filter((e=>t[e]));return new Function("fn","x","out","initial",`\nlet { data, strides, offset } = out;\nlet [${r("s_$")}] = strides;\nlet { data: x_data, strides: x_strides, offset: x_offset, shape } = x;\nlet [${r("d_$")}] = shape;\nlet [${r("x_$")}] = x_strides;\n\n${r("for (let i_$ = 0; i_$ < d_$; i_$++)"," ",n)} {\n\tlet first = true;\n\tlet accum = x_data[x_offset${n.length?" + ":""}${r("i_$ * x_$"," + ",n)}];\n\t${r("for (let i_$ = 0; i_$ < d_$; i_$++)"," ",a)} {\n\t\tif (first) {\n\t\t\tfirst = false;\n\t\t} else {\n\t\t\taccum = fn(accum, x_data[x_offset + ${r("i_$ * x_$"," + ")}]);\n\t\t}\n\t\tdata[offset + ${r("i_$ * s_$"," + ")}] = accum;\n\t}\n}\n`)}function $a(e,t,r=!1){if(null==e)return Array(t).fill(!0);"object"!=typeof e&&(e=[+e]);let n=Array(t).fill(!1);for(let a of e){if(a=va(a,t),!r&&n[a])throw new Error("repeated axis");n[a]=!0}return n}function va(e,t){let r=e;if(e=+e,!Number.isInteger(e))throw new Error(`${r} cannot be cast to integer`);if(e<0&&(e+=t),e<0||t<=e)throw new Error(`axis ${r} is out of bounds for array of dimension ${t}`);return e}function Aa(e,t,r=null){e=V(e),t=V(t),za(e.ndim>0,"x1 does not have enough dimensions"),za(t.ndim>0,"x2 does not have enough dimensions");let n=1==e.ndim,a=1==t.ndim,l=n||a;if(n&&(e=e.at(null,_(":"))),a&&(t=t.at(_(":"),null)),2==e.ndim&&2==t.ndim){za(e.shape[1]==t.shape[0],"input shape mismatch");let s=[e.shape[0],t.shape[1]],i=l?s.slice(n?1:0,a?-1:void 0):s;null==r?r=B(i):za(Fe(i,r.shape),"out shape mismatch");let d=l?r.reshape(s):r,o=t.T;for(let[t,r]of L(s))d.set([t,r],Ma(e.at(t),o.at(r)));return r}let s=J(e.shape.slice(0,-2),t.shape.slice(0,-2));e=T(e,[...s,...e.shape.slice(-2)]),t=T(t,[...s,...t.shape.slice(-2)]),za(e.shape.at(-1)==t.shape.at(-2),"input shape mismatch");let i=e.shape.at(-2),d=t.shape.at(-1),o=[...s,i,d];null==r?r=B(o):za(Fe(o,r.shape),"out shape mismatch");for(let n of L(s))Aa(e.get(n),t.get(n),r.get(n));return r}function za(e,t){if(!e)throw new Error(t)}function Ma(e,t,r=null){if(e=V(e),t=V(t),1==e.ndim&&1==t.ndim)return Jt(Be(e,t),0,r);if(2==e.ndim&&2==t.ndim)return Aa(e,t,r);if(0==e.ndim||0==t.ndim)return Be(e,t,r);if(1==t.ndim){za(e.shape.at(-1)==t.shape[0],`shapes ${e.shape} and ${t.shape} not aligned`);let n=e.shape.slice(0,-1);null==r?r=B(n):za(Fe(n,r.shape),"out shape mismatch");for(let a of L(n))Ma(e.get(a),t,r.at(_("..."),...a));return r}}function Na(e,t=null){t=null!=t?Object.assign(Object.create(ja),t):ja;let{separator:r,prefix:n}=t;return 0==e.size?"[]":function(e,t=ja,r=" ",n=""){let a,l=V(e);0==e.ndim&&(e=l),e.size>t.threshold?(a="...",l=Sa(l,t.edgeitems)):a="";let s=function(e,t){let r=function(e,t){let r={int:()=>new qa(e).__call__,float:()=>new Ta(e,t.precision).__call__,object:()=>Pa},{formatter:n}=t;if(null!=n)for(let e of Object.keys(n))r[e]=Da(n[e]);return r}(e,t),n=e.flat.copy().data,a=S(n),l=c(a)==c("number")?function(e){for(let t of e)if(!Number.isInteger(t))return!1;return!0}(n)?"int":"float":"object";return r[l](t)}(l,t),i=" "+" ".repeat(n.length),d=function(e,t,r,n,a,l,s,i){function d(r,n,o){let u=r.length,h=e.ndim-u;if(0===h)return t(e.item(r));let f,p=n+" ";f=i<=113?o:o-"]".length;let c,m,y=e.shape[u],g=s&&2*l<y;g?(c=l,m=l):(c=0,m=y);let w="";if(1===h){let e,t=a.trimEnd().length;e=i<=113?o-t:o-Math.max(t,"]".length);let l=n;for(let t=0;t<c;t++){let s=d([...r,t],p,f);[w,l]=Ua(w,l,s,e,n,i),l+=a}g&&([w,l]=La(w,l,s,e,n,i),l+=i<=113?", ":a);for(let t=m;t>1;t--){let s=d([...r,-t],p,f);[w,l]=Ua(w,l,s,e,n,i),l+=a}i<=113&&(e=o);let u=d([...r,-1],p,f);[w,l]=Ua(w,l,u,e,n,i),w+=l}else{w="";let e=a.trimEnd()+"\n".repeat(h-1);for(let t=0;t<c;t++)w+=n+d([...r,t],p,f)+e;g&&(w+=n+s,w+=i<=113?", \n":e);let t=m;for(;t>1;t--)w+=n+d([...r,-t],p,f)+e;w+=n+d([...r,-t],p,f)}return w="["+w.slice(n.length)+"]",w}try{return d([],n,r)}finally{d=null}}(e,s,t.linewidth,i,r,t.edgeitems,a,t.legacy);return d}(e,t,r,n)}function ka(e,t=null,r=null){return t??=ja.linewidth,r??=ja.precision,0==e.ndim?`${e.item()}`:Na(e,{linewidth:t,precision:r})}function Ea(e,t=null,r=null){if(t??=ja.linewidth,r??=ja.precision,0==e.ndim)return`${e.item()}`;let n,a=e instanceof A?"array":typeof e,l=function(e){return["number","boolean"].includes(e.name)}(e.dtype)&&e.size>0,s=a+"(",i=l?")":",";n=e.size>0||Fe(e.shape,[0])?Na(e,{linewidth:t,precision:r,separator:", ",prefix:s}):`[], shape=[${e.shape.join(", ")}]`;let d=s+n+i;if(l)return d;let o=`dtype=${e.dtype.name})`,u=" ";return d.length-(d.lastIndexOf("\n")+1)+o.length+1>t&&(u="\n"+" ".repeat((a+"(").length)),d+u+o}s.add(aa,(()=>[...function*(){let e=K(10);yield aa(e,2),yield aa(e,-2);let t=e.reshape([2,5]);yield t,yield aa(t,1),yield aa(t,-1),yield aa(t,1,0),yield aa(t,-1,0),yield aa(t,1,1),yield aa(t,-1,1),yield aa(t,[1,1],[1,0]),yield aa(t,[2,1],[1,0])}()]),(()=>[...function*(){yield E([8,9,0,1,2,3,4,5,6,7]),yield E([2,3,4,5,6,7,8,9,0,1]),yield E([[0,1,2,3,4],[5,6,7,8,9]]),yield E([[9,0,1,2,3],[4,5,6,7,8]]),yield E([[1,2,3,4,5],[6,7,8,9,0]]),yield E([[5,6,7,8,9],[0,1,2,3,4]]),yield E([[5,6,7,8,9],[0,1,2,3,4]]),yield E([[4,0,1,2,3],[9,5,6,7,8]]),yield E([[1,2,3,4,0],[6,7,8,9,5]]),yield E([[9,5,6,7,8],[4,0,1,2,3]]),yield E([[8,9,5,6,7],[3,4,0,1,2]])}()])),wa=da(wa),ba=da(ba),xa=da(xa),_a=da(_a),s.onload((()=>{B(100).reshape(10,10)})),s.add(sa,(()=>sa(K(10).reshape(-1,2),(e=>e**2))),(()=>Ce(K(10).reshape(-1,2),2))),s.add(ia,(()=>ya(((e,t)=>e*t),K(120).reshape(2,3,4,5),[1,3],null,!1)),(()=>Ht(K(120).reshape(2,3,4,5),[1,3]))),s.add(ia,(()=>ga(((e,t)=>e*t),K(120).reshape(2,3,4,5),[1,3],null)),(()=>Ka(K(120).reshape(2,3,4,5),[1,3]))),s.add(Aa,(()=>Aa(E([[1,0],[0,1]]),E([[4,1],[2,2]]))),(()=>E([[4,1],[2,2]]))).add(Aa,(()=>{let e=E([[1,0],[0,1]]),t=E([1,2]);return[Aa(e,t),Aa(t,e)]}),(()=>[E([1,2]),E([1,2])])).add(Aa,(()=>Aa(K(16).reshape([2,2,4]),K(16).reshape([2,4,2]))),(()=>E([[[28,34],[76,98]],[[428,466],[604,658]]]))),s.add(Ma,(()=>Ma(3,4)),(()=>12)).add(Ma,(()=>Ma([[1,2],[3,4]],[4,1])),(()=>E([6,16]))).add(Ma,(()=>Ma([[1,0],[0,1]],[[4,1],[2,2]])),(()=>E([[4,1],[2,2]])));let ja={edgeitems:3,threshold:1e3,linewidth:75,precision:void 0,formatter:null,separator:" ",prefix:""};function Sa(e,t,r=[]){let n=r.length;if(n==e.ndim)return e.get(r);if(e.shape[n]>2*t){let a=r.concat(Rn([,t])),l=r.concat(Rn([-t]));return Te([Sa(e,t,a),Sa(e,t,l)],n)}return Sa(e,t,r.concat(Rn(":")))}class Oa{get __call__(){return this.call.bind(null,this)}}class qa extends Oa{constructor(e){super(),this.padLeft=e.size>0?Math.max(String(e.max()).length,String(e.min()).length):0}call({padLeft:e}=this,t){let r=String(t);return" ".repeat(e-r.length)+r}}function Fa(e,t){return e.toExponential(t)}function Ia(e,t){return null!=t?e.toFixed(t):String(e)}class Ta extends Oa{constructor(e,t=undefined){super(),this.precision=t;let r=!1;{let t=e.item(0),n=t,a=!1;for(let r of e.flat)Number.isFinite(r)&&0!=r&&(r=Math.abs(r),t=Math.min(t,r),n=Math.max(n,r),a=!0);a&&(n>=1e8||t<1e-4||n/t>1e3)&&(r=!0)}this.exp_format=r;let n=0;if(this.exp_format)for(let r of e.flat)n=Math.max(n,Fa(r,t).length);else for(let r of e.flat)n=Math.max(n,Ia(r,t).length);this.padLeft=n}call({padLeft:e,exp_format:t,precision:r}=this,n){let a=t?Fa(n,r):Ia(n,r);return" ".repeat(e-a.length)+a}}function Pa(e){return"string"==typeof e?`'${e}'`:`${e}`}let Da=e=>()=>e;function La(e,t,r,n,a,l){let s=t.length+r.length>n;return l>113&&t.length<=a.length&&(s=!1),s&&(e+=t.trimEnd()+"\n",t=a),[e,t+=r]}function Ua(e,t,r,n,a,l){let s=r.split(/\r?\n/);if(1===s.length||l<=113)return La(e,t,r,n,a,l);let i,d=Math.max(...s.map((e=>e.length)));t.length+d>n&&t.length>a.length?(e+=t.trimEnd()+"\n",t=a+s[0],i=a):(i=" ".repeat(t.length),t+=s[0]);for(let r=1;r<s.length;r++)e+=t.trimEnd()+"\n",t=i+s[r];let o=d-s.at(-1).length;return[e,t+=" ".repeat(o)]}s.add(Na,(()=>Na(K(2520).reshape(3,4,210))),(()=>"[[[   0    1    2 ...  207  208  209]\n  [ 210  211  212 ...  417  418  419]\n  [ 420  421  422 ...  627  628  629]\n  [ 630  631  632 ...  837  838  839]]\n\n [[ 840  841  842 ... 1047 1048 1049]\n  [1050 1051 1052 ... 1257 1258 1259]\n  [1260 1261 1262 ... 1467 1468 1469]\n  [1470 1471 1472 ... 1677 1678 1679]]\n\n [[1680 1681 1682 ... 1887 1888 1889]\n  [1890 1891 1892 ... 2097 2098 2099]\n  [2100 2101 2102 ... 2307 2308 2309]\n  [2310 2311 2312 ... 2517 2518 2519]]]")).add(Na,(()=>Na(E([.1,100,50,-9e3]))),(()=>"[ 1e-1  1e+2  5e+1 -9e+3]")).add(Na,(()=>Na(E([1.1,100.2,50.6]))),(()=>"[  1.1 100.2  50.6]")),s.add(Ea,(()=>Ea(E([1.1,100.2,50.6]))),(()=>"array([  1.1, 100.2,  50.6])")).add(Ea,(()=>""+E([1.1,100.2,50.6])),(()=>"array([  1.1, 100.2,  50.6])"));class Va{constructor(e,t,r){this.ndim=e.length,this.size=M(e),this.shape=e,this.strides=t;let n=Array(this.ndim);for(let r=0;r<this.ndim;r++)n[r]=e[r]*t[r];this.dim_strides=n,this.initial=r,this.offset,this.coords=Array(this.ndim),this.index,this.done,this[Symbol.iterator]()}[Symbol.iterator](){return this.index=0,this.done=0==this.size,this.coords.fill(0),this.offset=this.initial,this}next(){if(this.done)return{done:!0};let{offset:e,coords:t,size:r,index:n}=this;if(0!=n){let{shape:r,strides:n,ndim:a,dim_strides:l}=this,s=a-1,i=!0;for(;s>=0;){let a=r[s];if(1==a)s--;else if(a==t[s])e-=l[s],t[s--]=0,i=!0;else{if(!i)break;e+=n[s],t[s]++,i=!1}}this.offset=e}return this.done=++this.index>=r,{value:e,done:!1}}}function Ba(e,t,r=0){return new Va(e,t,r)}s.add(Ba,(()=>{let e=K(100);e=e.at(_(20,-20)).reshape([2,1,-1,2]).at(_("..."),_("::-1"));let t=[];for(let r of Ba(e.shape,e.strides))t.push(e.data[e.offset+r]);return t}),(()=>[21,20,23,22,25,24,27,26,29,28,31,30,33,32,35,34,37,36,39,38,41,40,43,42,45,44,47,46,49,48,51,50,53,52,55,54,57,56,59,58,61,60,63,62,65,64,67,66,69,68,71,70,73,72,75,74,77,76,79,78]));class Xa extends Va{constructor(e){let{shape:t,strides:r,offset:n}=e;super(t,r,n),this.base=e}next(){return this.done?{done:!0}:{value:this.base.data[super.next().value],done:!1}}at(e){return this.get(e)}get(e){let t,r,{base:n}=this;if("number"==typeof e)return E(n.item(e),n.dtype);"string"==typeof e&&(e=_(e)),e instanceof y?(t=e.indices(n.size),r=B([t.slicelength],n.dtype)):(t=V(e).flat,r=X(e));let a=0;for(let e of t)r.data[a++]=n.item(e);return r}set(e,t){let{base:r}=this;if("number"==typeof e)return r.itemset(e,t),this;"string"==typeof e&&(e=_(e)),t=t instanceof Xa?[...t]:V(t).flatten().data;let n=e instanceof y?e.indices(r.size):V(e).flat,a=0;for(let e of n)r.itemset(e,t[a++%t.length]);return this}copy(){return this.base.flatten()}}function Ca(e){return e=V(e),new Ga(e)}s.add("Flatiter",(()=>{let e=E([0,1,2,3,4,5]).reshape(2,3),t=new Xa(e),r=[];for(let e of t)r.push(e);return r}),(()=>[0,1,2,3,4,5])),s.add("Flatiter.get",(()=>new Xa(E([[1,2,3],[4,5,6]])).at(3)),(()=>4)).add("Flatiter.get",(()=>new Xa(E([[1,2,3],[4,5,6]])).at(_(2,-2))),(()=>E([3,4]))).add("Flatiter.get",(()=>new Xa(E([[1,2,3],[4,5,6]])).get([3,4,-1])),(()=>[4,5,6])),s.add("Flatiter.set",(()=>{let e=E([[3,3,3],[3,3,3]]);return new Xa(e).set([1,-1],[[1],[2]]),e}),(()=>[[3,1,3],[3,3,2]])).add("Flatiter.set",(()=>{let e=E([[1,2,3],[4,5,6]]);return e.flat.set([1,0,1],[[1,2,3],[5,6,7]]),e}),(()=>E([[2,3,3],[4,5,6]]))).add("Flatiter.set",(()=>{let e=E([[1,2,3],[4,5,6]]);return e.flat.set(_(1,-1),[[1,2,3],[5,6,7]]),e}),(()=>E([[1,1,2],[3,5,6]]))).add("Flatiter.set",(()=>{let e=E([[1,2,3],[4,5,6]]);return e.flat.set(":",[[1,2]]),e}),(()=>E([[1,2,1],[2,1,2]]))),s.add("Flatiter.copy",(()=>new Xa(E([0,1,2,3,4,5]).reshape(2,3).at(_([,,-1]))).copy()),(()=>[3,4,5,0,1,2]));class Ga extends Xa{constructor(e){super(e)}next(){if(this.done)return{done:!0};let e=super.next().value;return{value:[this.coords,e],done:!1}}}function Wa(e,t){e=V(e);let r=t.length,n=M(t),a=B([].concat(e.shape,r)),l=0;for(let s of e.flat){if(s<0||s>=n)throw new Error(`index ${s} is out of bounds for array with size ${n}`);for(let e=r;e--;)a.data[l+e]=s%t[e],s=s/t[e]|0;l+=r}let s=Array(r).fill().map(((e,t)=>t)).map((e=>a.at("...",e)));return s}function Ha(e,t,r="raise"){let n=V(e).T;if(n=de(n),"raise"==r){if(ht(Fr(n,0))||ht(Tr(n,t)))throw new Error(`index is out of bounds for array with shape ${t}`)}else if("wrap"==r)n=Qe(De(Qe(n,t),t),t);else{if("clip"!=r)throw new Error(`unsupported mode '${r}'`);n=Jr(n,te(t.length),Ge(t,1))}let a=B(I(e).slice(1)),l=Te([Ka(t.slice(1).reverse()).at("::-1"),[1]]),s=0;for(let e of n)a.itemset(s++,Jt(Be(e,l)));return a}function Ja(e,t={}){console.log(e.toString())}s.add(Ca,(()=>{{let e;e=E([[1,2],[3,4]]);let t=[];for(let[r,n]of Ca(e))t.push(r.slice(),n);return t}}),(()=>[[0,0],1,[0,1],2,[1,0],3,[1,1],4])),s.add(Wa,(()=>Wa([22,41,37],[7,6])),(()=>[E([3,6,6]),E([4,5,1])])).add(Wa,(()=>Wa(1621,[6,7,8,9])),(()=>[3,1,4,1])),s.add(Ha,(()=>Ha(E([[3,6,6],[4,5,1]]),[7,6])),(()=>E([22,41,37]))).add(Ha,(()=>Ha([[3,6,6],[4,5,1]],[4,6],"clip")),(()=>E([22,23,19]))).add(Ha,(()=>Ha(E([[3,6,6],[4,5,1]]),[4,4],"wrap")),(()=>E([12,9,9]))).add(Ha,(()=>Ha([3,1,4,1],[6,7,8,9])),(()=>1621));const Ka=pa("cumprod",((e,t)=>e*t)),Qa=pa("cumsum",((e,t)=>e+t));let Ra=e=>Number.isNaN(e)?1:e;const Ya=pa("nancumprod",((e,t)=>Ra(e)*Ra(t)));let Za=e=>Number.isNaN(e)?0:e;const el=pa("nancumsum",((e,t)=>Za(e)+Za(t)));function tl(e,t,r=1e-5,n=1e-8,a=!1){e=V(e),t=V(t);let l=ft(e),s=ft(t);if(ut(l)&&ut(s))return rl(e,t,n,r);[e,t]=P(e,t);let i=rt(l,s),d=it(i),o=re(i);if(o.set([i],rl(e.at(i),t.at(i),n,r)),o.set([d],Or(e.at(d),t.at(d))),a){let r=rt(ct(e),ct(t));o.set([r],r.at(r))}return o}function rl(e,t,r,n){return Ir(_r(Ge(e,t)),De(r,Be(n,_r(t))))}function nl(e,t,r=1e-5,n=1e-8,a=!1){return ut(tl(e,t,r,n,a))}function al(e,t){return dl(sl(e),t)}function ll(e){let t=e.length,r=Array(t).fill().map((()=>Array(t).fill(0)));for(let e=0;e<t;e++)r[e][e]=1;for(let n=0;n<t;n++){let a=0,l=-1;for(let r=n;r<t;r++){let t=Math.abs(e[r][n]);t>a&&(l=r,a=t)}if(l!=n){for(let e=0;e<t;e++)[r[e][n],r[e][l]]=[r[e][l],r[e][n]];[e[n],e[l]]=[e[l],e[n]]}for(let r=n+1;r<t;r++){let a=e[r][n]/=e[n][n];for(let l=n+1;l<t;l++)e[r][l]-=a*e[n][l]}}let n=Array(t).fill().map((()=>Array(t).fill(0))),a=Array(t).fill().map((()=>Array(t).fill(0)));for(let r=0;r<t;r++){n[r][r]=1;for(let l=0;l<t;l++)l<r?n[r][l]=e[r][l]:a[r][l]=e[r][l]}return[r,n,a]}function sl(e){let[t,r]=[e.length,e[0].length],[n,a]=il(e.flat(),t,r);return n=G(n,[t,r]).array(),[n,a]}function il(e,t,r){let n=e.slice(),a=Array(r);for(let e=0;e<r;e++){let l=-1,s=-1;for(let a=e;a<t;a++){let t=Math.abs(n[a*r+e]);t>l&&(s=a,l=t)}if(-1!=s){if(a[e]=s,s!=e)for(let t=0;t<r;t++){let a=e*r+t,l=s*r+t,i=n[a];n[a]=n[l],n[l]=i}for(let a=e+1;a<t;a++){let t=n[a*r+e]/=n[e*r+e];for(let l=e+1;l<r;l++)n[a*r+l]-=t*n[e*r+l]}}else a[e]=e}return[n,a]}function dl(e,t){let[r,n]=e,a=r.length,l=t.slice();for(let e=0;e<a;e++)n[e]!==e&&([l[e],l[n[e]]]=[l[n[e]],l[e]]);for(let e=0;e<a;e++)for(let t=0;t<e;t++)l[e]-=r[e][t]*l[t];for(let e=a-1;e>=0;e--){for(let t=e+1;t<a;t++)l[e]-=r[e][t]*l[t];l[e]/=r[e][e]}return l}function ol(e,t,r=0){e=V(e);let n=[],a=[],l=[];for(let e of t)if(null==e)l.push(null),n.push(!1);else if("string"==typeof e)l.push(_(e)),n.push(!1);else if(e instanceof y)l.push(e),n.push(!1);else if(e=V(e),e.dtype==p("boolean"))for(let t of e.nonzero())a.push(t.shape),l.push(t),n.push(!0);else a.push(e.shape),l.push(e),n.push(!0);let s=n.length,i=J(...a);for(let e=0;e<s;e++)n[e]&&(l[e]=T(l[e],i));let d=!0,o=-1;for(let e=0;e<s;e++)if(n[e]){if(-1===o)o=e;else if(e!==o+1){d=!1;break}o=e}let u=[],h=[];if(d)for(let t=0;t<s;)if(n[t])r+=t,h.push(...i),t=o+1;else{let r=l[t].indices(e.shape[t]).slicelength;u.push(r),h.push(r),t++}else{h.push(...i);for(let t=0;t<s;t++)if(!n[t])if(null==l[t])u.push(1),h.push(1);else{let r=l[t].indices(e.shape[t]).slicelength;u.push(r),h.push(r)}}for(let t=s;t<e.ndim;t++){let r=e.shape[t];h.push(r),u.push(r)}return new ul(e,i,l,r,h)}s.add(Ka,(()=>Ka(0)),(()=>E([0]))).add(Ka,(()=>Ka([])),(()=>E([]))).add(Ka,(()=>Ka(E([1,2,3]))),(()=>E([1,2,6]))).add(Ka,(()=>Ka(E([[1,2,3],[4,5,6]]))),(()=>E([1,2,6,24,120,720]))).add(Ka,(()=>Ka(E([[1,2,3],[4,5,6]]),0)),(()=>E([[1,2,3],[4,10,18]]))).add(Ka,(()=>Ka(E([[1,2,3],[4,5,6]]),1)),(()=>E([[1,2,6],[4,20,120]]))),s.add(Qa,(()=>Qa(E([[1,2,3],[4,5,6]]))),(()=>E([1,3,6,10,15,21]))).add(Qa,(()=>Qa(E([[1,2,3],[4,5,6]]),0)),(()=>E([[1,2,3],[5,7,9]]))).add(Qa,(()=>Qa(E([[1,2,3],[4,5,6]]),1)),(()=>E([[1,3,6],[4,9,15]]))),s.add(Ya,(()=>Ya(1)),(()=>E([1]))).add(Ya,(()=>Ya([1])),(()=>E([1]))).add(Ya,(()=>Ya([1,NaN])),(()=>E([1,1]))).add(Ya,(()=>Ya(E([[1,2],[3,NaN]]))),(()=>E([1,2,6,6]))).add(Ya,(()=>Ya(E([[1,2],[3,NaN]]),0)),(()=>E([[1,2],[3,2]]))).add(Ya,(()=>Ya(E([[1,2],[3,NaN]]),1)),(()=>E([[1,2],[3,3]]))),s.add(el,(()=>el(1)),(()=>E([1]))).add(el,(()=>el([1])),(()=>E([1]))).add(el,(()=>el([1,NaN])),(()=>E([1,1]))).add(el,(()=>el(E([[1,2],[3,NaN]]))),(()=>E([1,3,6,6]))).add(el,(()=>el(E([[1,2],[3,NaN]]),0)),(()=>E([[1,2],[4,2]]))).add(el,(()=>el(E([[1,2],[3,NaN]]),1)),(()=>E([[1,3],[3,3]]))),s.add(tl,(()=>tl([1e10,1e-7],[100001e5,1e-8])),(()=>[!0,!1])).add(tl,(()=>tl([1e10,1e-8],[100001e5,1e-9])),(()=>[!0,!0])).add(tl,(()=>tl([1e10,1e-8],[10001e6,1e-9])),(()=>[!1,!0])).add(tl,(()=>tl([1,NaN],[1,NaN])),(()=>[!0,!1])).add(tl,(()=>tl([1,NaN],[1,NaN],void 0,void 0,!0)),(()=>[!0,!0])).add(tl,(()=>tl([1e-8,1e-7],[0,0])),(()=>[!0,!1])).add(tl,(()=>tl([1e-100,1e-7],[0,0],void 0,0)),(()=>[!1,!1])).add(tl,(()=>tl([1e-10,1e-10],[1e-20,0])),(()=>[!0,!0])).add(tl,(()=>tl([1e-10,1e-10],[1e-20,999999e-16],void 0,0)),(()=>[!1,!0])),s.add(sl,(()=>{let[e,t]=sl([[2,5,8,7],[5,2,2,8],[7,5,6,6],[5,4,4,8]]);return[nl(e,[[7,5,6,6],[.28571429,3.57142857,6.28571429,5.28571429],[.71428571,.12,-1.04,3.08],[.71428571,-.44,-.46153846,7.46153846]]),nl(t,[2,2,3,3])]}),(()=>[!0,!0])),s.add(al,(()=>nl(al([[3,2,0],[1,-1,0],[0,5,1]],[2,4,-1]),[2,-2,9])),(()=>!0)).add(al,(()=>nl(al([[1,2],[3,5]],[1,2]),[-1,1])),(()=>!0)),s.add(dl,(()=>{let[e,t]=sl([[2,5,8,7],[5,2,2,8],[7,5,6,6],[5,4,4,8]]);return nl(dl([e,t],[1,1,1,1]),[.05154639,-.08247423,.08247423,.09278351])}),(()=>!0)),s.add(ll,(()=>nl(ll([[2,5,8,7],[5,2,2,8],[7,5,6,6],[5,4,4,8]]),[E([[0,1,0,0],[0,0,0,1],[1,0,0,0],[0,0,1,0]]),E([[1,0,0,0],[.28571429,1,0,0],[.71428571,.12,1,0],[.71428571,-.44,-.46153846,1]]),E([[7,5,6,6],[0,3.57142857,6.28571429,5.28571429],[0,0,-1.04,3.08],[0,0,0,7.46153846]])])),(()=>!0));class ul extends U{constructor(e,t,r,n,a){super(t),this.base=V(e),this.indices=r,this.axis=n,this.outShape=a,this._indices=[...r]}next(){if(this.done)return{done:!0};let{base:e,indices:t,index:r,_indices:n}=this;for(let e=0;e<t.length;e++)t[e]instanceof A&&(n[e]=t[e].item(r));let a=e.get(n);return super.next(),{value:a,done:!1}}get(){let{axis:e,coords:t,outShape:r,base:n}=this,a=B(r,n.dtype);for(let r of this)D(a.get(t,e),r);return a}set(e){let{axis:t,coords:r,outShape:n}=this;e=T(e,n);for(let n of this)D(n,e.get(r,t))}}function hl(e,t){return ol(e,t).get()}function fl(e,t,r){return ol(e,t).set(r)}function pl(e,t=null,r=null,n=!1){if(0==(e=V(e)).size)throw new Error("attempt to get argmax of an empty sequence");if(null==t){let t,a=Number.MIN_VALUE,l=0;for(let r of e.flat)r>a&&(t=l,a=r),l++;let s=n?Array(e.ndim).fill(1):[];if(null==r)r=B(s,"number");else if(!Fe(r.shape,s))throw new Error("out shape does not match");return r.itemset(0,t),r}if(t=va(t,e.ndim),0==e.ndim)return 0;if(1==e.ndim)return pl(e,null,r,n);let a=[...e.shape];if(n?a.splice(t,1,1):a.splice(t,1),null==r)r=B(a,"number");else if(!Fe(r.shape,a))throw new Error("out shape does not match");let l=r,s=[...e.shape];s.splice(t,1),r=r.reshape(s);for(let n of L(s)){let a=[...n];a.splice(t,0,":"),pl(e.get(a),null,r.get(n))}return l}function cl(e,t=null,r=null,n=!1){if(0==(e=V(e)).size)throw new Error("attempt to get argmax of an empty sequence");if(null==t){let t,a=Number.MAX_VALUE,l=0;for(let r of e.flat)r<a&&(t=l,a=r),l++;let s=n?Array(e.ndim).fill(1):[];if(null==r)r=B(s,"number");else if(!Fe(r.shape,s))throw new Error("out shape does not match");return r.itemset(0,t),r}if(t=va(t,e.ndim),0==e.ndim)return 0;if(1==e.ndim)return cl(e,null,r,n);let a=[...e.shape];if(n?a.splice(t,1,1):a.splice(t,1),null==r)r=B(a,"number");else if(!Fe(r.shape,a))throw new Error("out shape does not match");let l=r,s=[...e.shape];s.splice(t,1),r=r.reshape(s);for(let n of L(s)){let a=[...n];a.splice(t,0,":"),cl(e.get(a),null,r.get(n))}return l}function ml(e){return e=V(e),E([...new Set(e.flat)].sort())}s.add(hl,(()=>hl(K(120).reshape(2,3,4,5),[[0,0],":1",[0,0],":"])),(()=>E([[[0,1,2,3,4]],[[0,1,2,3,4]]]))).add(hl,(()=>hl(K(24).reshape(2,3,4),[[[1],[1]],[!0,!1,!0]])),(()=>E([[[12,13,14,15],[20,21,22,23]],[[12,13,14,15],[20,21,22,23]]]))).add(hl,(()=>hl(K(24).reshape(2,3,4),[":",[[!0,!1,!0,!0],[!0,!1,!0,!0],[!0,!1,!0,!0]]])),(()=>E([[0,2,3,4,6,7,8,10,11],[12,14,15,16,18,19,20,22,23]]))).add(hl,(()=>hl(K(24).reshape(2,3,4),[[0,0,0,1,1,1,1,1,0],":",[0,2,3,0,2,3,0,2,3]])),(()=>E([[0,4,8],[2,6,10],[3,7,11],[12,16,20],[14,18,22],[15,19,23],[12,16,20],[14,18,22],[3,7,11]]))).add(hl,(()=>hl(K(24).reshape(2,3,4),[[1,0],0])),(()=>E([[12,13,14,15],[0,1,2,3]]))).add(hl,(()=>hl(K(24).reshape(2,3,4),[":",[!1,!1,!0],":-1"])),(()=>E([[[8,9,10]],[[20,21,22]]]))).add(hl,(()=>hl(K(24).reshape(2,3,4),[":",[[0],[1]],[2]])),(()=>E([[[2],[6]],[[14],[18]]]))),s.add(pl,(()=>pl(K(6).reshape(2,3))),(()=>5)).add(pl,(()=>pl(K(6).reshape(2,3),0)),(()=>E([1,1,1]))).add(pl,(()=>pl(K(6).reshape(2,3),1)),(()=>E([2,2]))).add(pl,(()=>pl(E([0,5,2,3,4,5]))),(()=>1)).add(pl,(()=>pl(K(24).reshape(2,3,4),1,null,!0)),(()=>E([[[2,2,2,2]],[[2,2,2,2]]]))),s.add(cl,(()=>cl(K(6).reshape(2,3))),(()=>0)).add(cl,(()=>cl(K(6).reshape(2,3),0)),(()=>E([0,0,0]))).add(cl,(()=>cl(K(6).reshape(2,3),1)),(()=>E([0,0]))).add(cl,(()=>cl(E([0,5,2,3,4,5]))),(()=>0)).add(cl,(()=>cl(K(24).reshape(2,3,4),1,null,!0)),(()=>E([[[0,0,0,0]],[[0,0,0,0]]]))),s.add(ml,(()=>ml([1,1,2,2,3,3])),(()=>E([1,2,3]))).add(ml,(()=>ml(E([[1,1],[2,3]]))),(()=>E([1,2,3]))).add(ml,(()=>ml(E([1,2,6,4,2,3,2]))),(()=>E([1,2,3,4,6])))})(),nj=n})();